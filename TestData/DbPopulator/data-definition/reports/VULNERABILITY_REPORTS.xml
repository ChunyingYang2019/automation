
<Reports>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_1" group="PH_SYS_REPORT_Vulnerabilities,PH_SYS_REPORT_Freq">
    <Name>Virus found and remediated</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description> Captures events that indicate the viruses found and remediated. This report is applicable for host antivirus, security gateways, proxies and firewalls that do content inspection e.g. Palo Alto Firewall, Untangle etc. </Description>
    <SelectClause numEntries="All">
      <AttrList>phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,virusName,virusType,fileName,virusAction,virusQuarantStatus</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_1" name="Filter_Vuln_1">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Worm_Remedy_Success) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,hostIpAddr</RelevantFilterAttr>
  </Report>
 
  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_2" group="PH_SYS_REPORT_Vulnerabilities,PH_SYS_REPORT_Freq">
   <Name>Virus found but not remediated</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Captures events that indicate viruses found but failed to remedy - the events could be from Host Anti-virus or Network Security Gateways. This report is applicable for host antivirus, security gateways, proxies and firewalls that do content inspection e.g. Palo Alto Firewall, Untangle etc. </Description>
    <SelectClause numEntries="All">
        <AttrList>phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,virusName,virusType,fileName,virusAction,virusQuarantStatus</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_2" name="Filter_Vuln_2">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Worm_Remedy_Failed) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
           <GroupByAttr>reptDevIpAddr,hostIpAddr</GroupByAttr>
      </SubPattern>
    </PatternClause>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_3" group="PH_SYS_REPORT_Vulnerabilities">
   <Name>Spyware found and remediated</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Captures events that indicate spyware was found and remediated on a host. This report is applicable for host antivirus, security gateways, proxies and firewalls that do content inspection e.g. Palo Alto Firewall, Untangle etc. </Description>
    <SelectClause numEntries="All">
        <AttrList>phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,fileName</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_3" name="Filter_Vuln_3">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Spyware_Remedy_Success) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,hostIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_4" group="PH_SYS_REPORT_Vulnerabilities">
   <Name>Spyware found but not remediated </Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Captures events that indicate spyware was found but the detecting software failed to remediated the vulnerability. This report is applicable for host antivirus, security gateways, proxies and firewalls that do content inspection e.g. Palo Alto Firewall, Untangle etc. </Description>
    <SelectClause numEntries="All">
        <AttrList>phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,fileName</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_4" name="Filter_Vuln_4">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Spyware_Remedy_Failed) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,hostIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_5" group="PH_SYS_REPORT_Vulnerabilities,PH_SYS_REPORT_WebProxy">
   <Name>Spam/Malicious Mail Attachment found and remediated </Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Captures events that indicate spam or mailicious mail attachments were found and remediated on a host. This report is applicable for host antivirus, security gateways, proxies and firewalls that do content inspection e.g. Palo Alto Firewall, Untangle, Websense Mail gateway, Ironport Mail Gateway etc. </Description>
    <SelectClause numEntries="All">
        <AttrList>phRecvTime,reptDevIpAddr,eventType,srcIpAddr,senderMailAddr,receiverMailAddr,mailSubject,vendor,spamScore </AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_5" name="Filter_Vuln_5">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_MailMalware_Remedy_Success) </SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,srcIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_6" group="PH_SYS_REPORT_Vulnerabilities,PH_SYS_REPORT_WebProxy">
   <Name>Spam/Malicious Mail Attachment found but not remediated </Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Captures events that indicate spyware was found but the detecting software did not remediated the vulnerability. This report is applicable for host antivirus, security gateways, proxies and firewalls that do content inspection e.g. Palo Alto Firewall, Untangle, Websense Mail gateway, Ironport Mail Gateway etc. </Description>
    <SelectClause numEntries="All">
        <AttrList>phRecvTime,reptDevIpAddr,eventType,srcIpAddr,senderMailAddr,receiverMailAddr,mailSubject,vendor,spamScore</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_6" name="Filter_Vuln_6">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_MailMalware_Found)</SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,srcIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_7" group="PH_SYS_REPORT_Vulnerabilities,PH_SYS_REPORT_WebProxy">
   <Name>Phishing attempt found and remediated </Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Captures events that indicate phishing attempt </Description>
    <SelectClause numEntries="All">
        <AttrList>phRecvTime,reptDevIpAddr,eventType,srcIpAddr,destIpAddr</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_7" name="Filter_Vuln_7">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Phish_Remedy_Success) </SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,srcIpAddr,destIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_8" group="PH_SYS_REPORT_Vulnerabilities">
   <Name>Top IPs with Malware Found By Antivirus and Security Gateways</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Tracks IP addresses with Malware as found by Host Anti-virus and Security Gateways</Description>
    <SelectClause numEntries="All">
        <AttrList>reptDevIpAddr,eventType,srcIpAddr,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_8" name="Filter_Vuln_8">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Malware) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
	   <GroupByAttr>reptDevIpAddr,eventType,srcIpAddr</GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,srcIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_9" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Top Computers with Malware Found By Antivirus and Security Gateways</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Tracks computers with Malware as found by Host Anti-virus and Security Gateways</Description>
    <SelectClause numEntries="All">
      <AttrList>reptDevIpAddr,eventType,computer,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_9" name="Filter_Vuln_9">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Malware) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
	<GroupByAttr>reptDevIpAddr,eventType,computer</GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr</RelevantFilterAttr>
  </Report>
  
   <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_10" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Top IPs with Malware Found By IPS and Firewalls</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description> Tracks IP addresses with Malware as found by IPS - these are somewhat less reliable than Host Anti-virus and Security Gateways </Description>
    <SelectClause numEntries="All">
      <AttrList>reptDevIpAddr,eventType,srcIpAddr,COUNT(*)</AttrList>    
    </SelectClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_10" name="Filter_Vuln_10">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Malware) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS,Group@PH_SYS_APP_NETWORK_IPS,Group@PH_SYS_DEVICE_FIREWALL) </SingleEvtConstr>
	<GroupByAttr>reptDevIpAddr,eventType,srcIpAddr</GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,srcIpAddr</RelevantFilterAttr>
  </Report>
  
  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_11" group="PH_SYS_REPORT_Vulnerabilities">
   <Name>Top IPs with Malware Found By Security Gateways</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Tracks IP addresses with Malware as found by Security Gateways</Description>
    <SelectClause numEntries="All">
        <AttrList>reptDevIpAddr,eventType,srcIpAddr,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
       <SubPattern displayName="Filter_Vuln_11" name="Filter_Vuln_11">
           <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Malware) AND reptDevIpAddr NOT IN (Group@PH_SYS_DEVICE_NETWORK_IPS,Group@PH_SYS_APP_NETWORK_IPS,Group@PH_SYS_APP_SEC_MGMT) </SingleEvtConstr>
	   <GroupByAttr>reptDevIpAddr,eventType,srcIpAddr</GroupByAttr>
       </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,srcIpAddr</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_12" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Non-compliant Hosts and Security Software License Expirations</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Tracks non-compliant hosts and license expiry events from Security Management Gateways and Firewalls. Non-compliant hosts may not have proper security software running and therefore may pose a security threat. License expiration of security software may expose exploitable security vulnerabilities.</Description>
    <SelectClause numEntries="All">
      <AttrList>reptDevIpAddr,eventType,hostIpAddr,rawEventMsg</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_12" name="Filter_Vuln_12">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_LicenseExpired,Group@PH_SYS_EVENT_NoncompliantHost) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS,Group@PH_SYS_APP_NETWORK_IPS,Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_SEC_GW) </SingleEvtConstr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>reptDevIpAddr,hostIpAddr</RelevantFilterAttr>
  </Report>
  
 <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_13" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Host vulnerabilities found by scanners</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>This report details the host vulnerabilties found by scanners like Qyalys, Nessus, nCircle etc </Description>
    <SelectClause numEntries="All">
      <AttrList>hostName,osType,vulnName,eventSeverity,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_13" name="Filter_Vuln_13">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Vulnerability) </SingleEvtConstr>
	<GroupByAttr>hostName,osType,vulnName,eventSeverity</GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>hostName</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_14" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Top Hosts with Vulnerabilities found by scanners</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Ranks the hosts by vulnerabilities found by scanners</Description>
    <SelectClause numEntries="All">
      <AttrList>hostName,eventSeverity,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_13" name="Filter_Vuln_13">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Vulnerability) </SingleEvtConstr>
	<GroupByAttr>hostName,eventSeverity</GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>hostName</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_15" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Host vulnerability found by scanners with details </Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Details the vulnerabilities discovered on hosts </Description>
    <SelectClause numEntries="All">
      <AttrList>scanEnd,hostName,osType,vulnName,eventSeverity,vulnType,vulnCVEId,vulnBugTraqID,vulnScore,vulnConseq,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_13" name="Filter_Vuln_13">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Vulnerability) </SingleEvtConstr>
	<GroupByAttr></GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>hostName</RelevantFilterAttr>
  </Report>

  <!-- ********************************************************************* -->
  <Report id="PH_Report_Vuln_16" group="PH_SYS_REPORT_Vulnerabilities">
    <Name>Top OS types with vulnerabilities</Name>
    <CustomerScope groupByEachCustomer="true"> <Include all="true"/> <Exclude/> </CustomerScope>
    <Description>Ranks OS types by vulnerabilities found</Description>
    <SelectClause numEntries="All">
      <AttrList>osType,eventSeverity,COUNT(*)</AttrList>    
    </SelectClause>
    <OrderByClause><AttrList>COUNT (*) DESC </AttrList></OrderByClause>
    <ReportInterval><Window unit="Hourly" val="1"/></ReportInterval>
    <PatternClause window="3600">
      <SubPattern displayName="Filter_Vuln_13" name="Filter_Vuln_13">
        <SingleEvtConstr> eventType IN (Group@PH_SYS_EVENT_Vulnerability) </SingleEvtConstr>
	<GroupByAttr>osType,eventSeverity</GroupByAttr>
      </SubPattern>
    </PatternClause>
    <RelevantFilterAttr>hostName</RelevantFilterAttr>
  </Report>

</Reports>
