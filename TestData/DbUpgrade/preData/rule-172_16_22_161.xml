<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<response timestamp="1350344676466" requestId="0">
    <result>
        <eventForwardingRules></eventForwardingRules>
        <rules>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_201" entityVersion="1" xmlId="Rule$PH_Rule_Perf_201" ownerId="500150" lastModified="1350152313983" id="973300" custId="0" creationTime="1350152313983">
                <activatedTime>1350152313983</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server CPU has reached a warning level (between 75% and 85% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973274" ownerId="500150" lastModified="1350152313983" id="973274" custId="0" creationTime="1350152313983">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt;= 75 AND AVG(cpuUtil) &lt;= 85 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServCPUWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_CPU_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server CPU Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973274</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServCPUWarn.hostIpAddr, hostName = ServCPUWarn.hostName, cpuUtil = ServCPUWarn.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_CPU_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_202" entityVersion="1" xmlId="Rule$PH_Rule_Perf_202" ownerId="500150" lastModified="1350152314062" id="973301" custId="0" creationTime="1350152314061">
                <activatedTime>1350152314062</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server CPU has reached a critical level (greater than 85% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973275" ownerId="500150" lastModified="1350152314061" id="973275" custId="0" creationTime="1350152314061">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt; 85 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServCPUCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_CPU_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server CPU Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973275</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServCPUCrit.hostIpAddr, hostName = ServCPUCrit.hostName, cpuUtil = ServCPUCrit.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_CPU_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_203" entityVersion="1" xmlId="Rule$PH_Rule_Perf_203" ownerId="500150" lastModified="1350152314133" id="973302" custId="0" creationTime="1350152314133">
                <activatedTime>1350152314133</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network device CPU has reached a warning level (between 75% and 90% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973276" ownerId="500150" lastModified="1350152314133" id="973276" custId="0" creationTime="1350152314133">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt;= 75 AND AVG(cpuUtil) &lt;= 90 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>NetCPUWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_CPU_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network CPU Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973276</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = NetCPUWarn.hostIpAddr, hostName = NetCPUWarn.hostName, cpuUtil = NetCPUWarn.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_CPU_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_204" entityVersion="1" xmlId="Rule$PH_Rule_Perf_204" ownerId="500150" lastModified="1350152314205" id="973303" custId="0" creationTime="1350152314205">
                <activatedTime>1350152314205</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network device CPU has reached a critical level (greater than 90% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973277" ownerId="500150" lastModified="1350152314205" id="973277" custId="0" creationTime="1350152314205">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt; 90 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>NetCPUCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_CPU_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network CPU Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973277</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = NetCPUCrit.hostIpAddr, hostName = NetCPUCrit.hostName, cpuUtil = NetCPUCrit.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_CPU_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_205" entityVersion="1" xmlId="Rule$PH_Rule_Perf_205" ownerId="500150" lastModified="1350152314277" id="973304" custId="0" creationTime="1350152314277">
                <activatedTime>1350152314277</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server Memory has reached a warning level (between 75% and 85% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973278" ownerId="500150" lastModified="1350152314277" id="973278" custId="0" creationTime="1350152314277">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(memUtil) &gt;= 75 AND AVG(memUtil) &lt;= 85 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServMemWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND memName = "Physical Memory" AND hostIpAddr NOT IN (Group@PH_SYS_APP_DATABASE_SERVER, Group@PH_SYS_APP_MAIL_SERVER)</singleConstraint>
                </eventFilters>
                <name>Server Memory Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973278</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServMemWarn.hostIpAddr, hostName = ServMemWarn.hostName, memUtil = ServMemWarn.AVG(memUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_MEM_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,memUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_206" entityVersion="1" xmlId="Rule$PH_Rule_Perf_206" ownerId="500150" lastModified="1350152314349" id="973305" custId="0" creationTime="1350152314349">
                <activatedTime>1350152314349</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server memory has reached a critical level (greater than 85% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973279" ownerId="500150" lastModified="1350152314349" id="973279" custId="0" creationTime="1350152314349">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(memUtil) &gt; 85 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServMemCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND memName = "Physical Memory" AND hostIpAddr NOT IN (Group@PH_SYS_APP_DATABASE_SERVER, Group@PH_SYS_APP_MAIL_SERVER)</singleConstraint>
                </eventFilters>
                <name>Server Memory Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973279</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServMemCrit.hostIpAddr, hostName = ServMemCrit.hostName, memUtil = ServMemCrit.AVG(memUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_MEM_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,memUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_206B" entityVersion="1" xmlId="Rule$PH_Rule_Perf_206B" ownerId="500150" lastModified="1350152314421" id="973306" custId="0" creationTime="1350152314420">
                <activatedTime>1350152314420</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server swap memory has reached a critical level (free swap less than minimum swap)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973280" ownerId="500150" lastModified="1350152314420" id="973280" custId="0" creationTime="1350152314420">
                    <groupBy>hostIpAddr, hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt; 2 AND AVG(swapMemUtil) &gt; 90</groupConstraint>
                    <index>0</index>
                    <name>ServSwapMemCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Swap Memory Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973280</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>hostIpAddr = ServSwapMemCrit.hostIpAddr, hostName = ServSwapMemCrit.hostName, swapMemUtil = ServSwapMemCrit.AVG(swapMemUtil)</incidentAttrs>
                <incidentFireFreq>3600</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SWAP_MEM_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,memName,hostName,hostIpAddr,swapMemUtil,freeSwapMemKB,memMinimumSwap,swapMemErrorString,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_207" entityVersion="1" xmlId="Rule$PH_Rule_Perf_207" ownerId="500150" lastModified="1350152314494" id="973307" custId="0" creationTime="1350152314493">
                <activatedTime>1350152314494</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network device memory usage has reached a warning level (between 50% and 85% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973281" ownerId="500150" lastModified="1350152314494" id="973281" custId="0" creationTime="1350152314494">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(memUtil) &gt;= 65 AND AVG(memUtil) &lt;= 85 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>NetMemWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND memName = "Physical Memory"</singleConstraint>
                </eventFilters>
                <name>Network Memory Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973281</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = NetMemWarn.hostIpAddr, hostName = NetMemWarn.hostName, memUtil = NetMemWarn.AVG(memUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_MEM_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,memUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_208" entityVersion="1" xmlId="Rule$PH_Rule_Perf_208" ownerId="500150" lastModified="1350152314566" id="973308" custId="0" creationTime="1350152314566">
                <activatedTime>1350152314566</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network device memory has reached a critical level (greater than 85% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973282" ownerId="500150" lastModified="1350152314566" id="973282" custId="0" creationTime="1350152314566">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(memUtil) &gt; 85 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>NetMemCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND memName = "Physical Memory"</singleConstraint>
                </eventFilters>
                <name>Network Memory Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973282</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = NetMemCrit.hostIpAddr, hostName = NetMemCrit.hostName, memUtil = NetMemCrit.AVG(memUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_MEM_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,memUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_209" entityVersion="1" xmlId="Rule$PH_Rule_Perf_209" ownerId="500150" lastModified="1350152314641" id="973309" custId="0" creationTime="1350152314641">
                <activatedTime>1350152314641</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server disk space usage has reached a warning level (utilization between 80% and 95% and free disk still greater than 100 MB) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973283" ownerId="500150" lastModified="1350152314641" id="973283" custId="0" creationTime="1350152314641">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>((AVG(diskUtil) &gt;= 80 AND AVG(diskUtil) &lt;= 95) OR (AVG(diskUtil) &gt;= 95 AND AVG(freeDiskMB) &gt; 100)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServDiskWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_DISK_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN ("/boot")</singleConstraint>
                </eventFilters>
                <name>Server Disk space Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973283</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServDiskWarn.hostIpAddr, hostName = ServDiskWarn.hostName, diskName = ServDiskWarn.diskName, diskUtil = ServDiskWarn.AVG(diskUtil), freeDiskMB =  ServDiskWarn.AVG(freeDiskMB) 
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_DISK_SPACE_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,diskUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_210" entityVersion="1" xmlId="Rule$PH_Rule_Perf_210" ownerId="500150" lastModified="1350152314714" id="973310" custId="0" creationTime="1350152314714">
                <activatedTime>1350152314714</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server disk space usage has reached a critical level (greater than 95% and free disk less than 100 MB) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973284" ownerId="500150" lastModified="1350152314714" id="973284" custId="0" creationTime="1350152314714">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>AVG(diskUtil) &gt; 95 AND AVG(freeDiskMB) &lt; 100 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServDiskCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_DISK_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN ("/boot")</singleConstraint>
                </eventFilters>
                <name>Server Disk Space Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973284</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServDiskCrit.hostIpAddr, hostName = ServDiskCrit.hostName, diskName = ServDiskCrit.diskName, diskUtil = ServDiskCrit.AVG(diskUtil), freeDiskMB =  ServDiskCrit.AVG(freeDiskMB)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_DISK_SPACE_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,diskUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_209B" entityVersion="1" xmlId="Rule$PH_Rule_Perf_209B" ownerId="500150" lastModified="1350152314788" id="973311" custId="0" creationTime="1350152314788">
                <activatedTime>1350152314788</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server disk I/O latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973285" ownerId="500150" lastModified="1350152314788" id="973285" custId="0" creationTime="1350152314788">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>((AVG(devDiskRdLatency) &gt;= 20 AND AVG(devDiskRdLatency) &lt; 50) OR (AVG(devDiskWrLatency) &gt;= 20 AND AVG(devDiskWrLatency) &lt; 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServDiskLatencyWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_DISK_IO_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN ("/boot")</singleConstraint>
                </eventFilters>
                <name>Server Disk Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973285</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServDiskLatencyWarn.hostIpAddr, hostName = ServDiskLatencyWarn.hostName, diskName = ServDiskLatencyWarn.diskName, devDiskRdLatency = ServDiskLatencyWarn.AVG(devDiskRdLatency), devDiskWrLatency = ServDiskLatencyWarn.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_DISK_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,devDiskRdLatency,devDiskWrLatency,diskQLen,diskIOUtil,diskReadReqPerSec,diskWriteReqPerSec,diskReadKBytesPerSec,diskWriteKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_209C" entityVersion="1" xmlId="Rule$PH_Rule_Perf_209C" ownerId="500150" lastModified="1350152314865" id="973312" custId="0" creationTime="1350152314865">
                <activatedTime>1350152314865</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server disk I/O latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973286" ownerId="500150" lastModified="1350152314865" id="973286" custId="0" creationTime="1350152314865">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>(AVG(devDiskRdLatency) &gt;= 50 OR AVG(devDiskWrLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServDiskLatencyCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_DISK_IO_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN ("/boot")</singleConstraint>
                </eventFilters>
                <name>Server Disk Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973286</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServDiskLatencyCrit.hostIpAddr, hostName = ServDiskLatencyCrit.hostName, diskName = ServDiskLatencyCrit.diskName,devDiskRdLatency = ServDiskLatencyCrit.AVG(devDiskRdLatency), devDiskWrLatency = ServDiskLatencyCrit.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_DISK_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,devDiskRdLatency,devDiskWrLatency,diskQLen,diskIOUtil,diskReadReqPerSec,diskWriteReqPerSec,diskReadKBytesPerSec,diskWriteKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_211" entityVersion="1" xmlId="Rule$PH_Rule_Perf_211" ownerId="500150" lastModified="1350152314941" id="973313" custId="0" creationTime="1350152314941">
                <activatedTime>1350152314941</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that interface utilization of a network device has reached a warning level (utilization between 30% and 50% based on 2 successive readings in a 10 minute interval. IPS devices are excluded since being a sniffing interface, they have high utilization under normal circumstances.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973287" ownerId="500150" lastModified="1350152314941" id="973287" custId="0" creationTime="1350152314941">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>((AVG(inIntfUtil) &gt;= 30 AND AVG(inIntfUtil) &lt;= 50) OR
          (AVG(outIntfUtil) &gt;= 30 AND AVG(outIntfUtil) &lt;= 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfUtilWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_NETWORK_IPS)</singleConstraint>
                </eventFilters>
                <name>Network Intf Util Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973287</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfUtilWarn.hostIpAddr, hostName = IntfUtilWarn.hostName, intfName = IntfUtilWarn.intfName, inIntfUtil = IntfUtilWarn.AVG(inIntfUtil),outIntfUtil = IntfUtilWarn.AVG(outIntfUtil) 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_INTF_UTIL_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfUtil,outIntfUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_212" entityVersion="1" xmlId="Rule$PH_Rule_Perf_212" ownerId="500150" lastModified="1350152315018" id="973314" custId="0" creationTime="1350152315017">
                <activatedTime>1350152315017</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that interface utilization of a network device has reached a critical level (utilization greater than 50% based on 2 successive readings in a 10 minute interval. IPS devices are excluded since being a sniffing interface, they have high utilization under normal circumstances.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973288" ownerId="500150" lastModified="1350152315017" id="973288" custId="0" creationTime="1350152315017">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>(AVG(inIntfUtil) &gt; 50 OR AVG(outIntfUtil) &gt; 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfUtilCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr NOT IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND intfName NOT IN ("lo","Null0")</singleConstraint>
                </eventFilters>
                <name>Network Intf Util Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973288</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfUtilCrit.hostIpAddr, hostName = IntfUtilCrit.hostName, intfName = IntfUtilCrit.intfName, inIntfUtil = IntfUtilCrit.AVG(inIntfUtil),outIntfUtil = IntfUtilCrit.AVG(outIntfUtil) 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_INTF_UTIL_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfUtil,outIntfUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_211_B" entityVersion="1" xmlId="Rule$PH_Rule_Perf_211_B" ownerId="500150" lastModified="1350152315094" id="973315" custId="0" creationTime="1350152315093">
                <activatedTime>1350152315093</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that interface utilization of a network IPS device has reached a warning level (utilization between 60% and 80% based on 2 successive readings in a 10 minute interval.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973289" ownerId="500150" lastModified="1350152315093" id="973289" custId="0" creationTime="1350152315093">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>((AVG(inIntfUtil) &gt;= 60 AND AVG(inIntfUtil) &lt;= 80) OR
          (AVG(outIntfUtil) &gt;= 60 AND AVG(outIntfUtil) &lt;= 80)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfUtilWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND intfName NOT IN ("lo","Null0")</singleConstraint>
                </eventFilters>
                <name>Network IPS Intf Util Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973289</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfUtilWarn.hostIpAddr, hostName = IntfUtilWarn.hostName, intfName = IntfUtilWarn.intfName, inIntfUtil = IntfUtilWarn.AVG(inIntfUtil),outIntfUtil = IntfUtilWarn.AVG(outIntfUtil) 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_IPS_NET_INTF_UTIL_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfUtil,outIntfUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_212_B" entityVersion="1" xmlId="Rule$PH_Rule_Perf_212_B" ownerId="500150" lastModified="1350152315168" id="973316" custId="0" creationTime="1350152315168">
                <activatedTime>1350152315168</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that interface utilization of a network IPS device has reached a critical level (utilization greater than 80% based on 2 successive readings in a 10 minute interval.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973290" ownerId="500150" lastModified="1350152315168" id="973290" custId="0" creationTime="1350152315168">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>(AVG(inIntfUtil) &gt; 80 OR AVG(outIntfUtil) &gt; 80) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfUtilCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND hostIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND intfName NOT CONTAIN "Loopback" AND intfName NOT IN ("lo","Null0")</singleConstraint>
                </eventFilters>
                <name>Network IPS Intf Util Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973290</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfUtilCrit.hostIpAddr, hostName = IntfUtilCrit.hostName, intfName = IntfUtilCrit.intfName, inIntfUtil = IntfUtilCrit.AVG(inIntfUtil),outIntfUtil = IntfUtilCrit.AVG(outIntfUtil) 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_IPS_NET_INTF_UTIL_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfUtil,outIntfUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_213" entityVersion="1" xmlId="Rule$PH_Rule_Perf_213" ownerId="500150" lastModified="1350152315246" id="973317" custId="0" creationTime="1350152315245">
                <activatedTime>1350152315245</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that interface utilization of a server has reached a warning level (utilization between 30% and 50% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973291" ownerId="500150" lastModified="1350152315245" id="973291" custId="0" creationTime="1350152315245">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>((AVG(inIntfUtil) &gt;= 30 AND AVG(inIntfUtil) &lt;= 50) OR
          (AVG(outIntfUtil) &gt;= 30 AND AVG(outIntfUtil) &lt;= 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfUtilWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND hostIpAddr NOT IN (Group@PH_SYS_APP_NETWORK_IPS) AND intfName NOT CONTAIN "Loopback" AND intfName NOT IN ("lo","Null0")</singleConstraint>
                </eventFilters>
                <name>Server Intf Util Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973291</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfUtilWarn.hostIpAddr, hostName = IntfUtilWarn.hostName, intfName = IntfUtilWarn.intfName, inIntfUtil = IntfUtilWarn.AVG(inIntfUtil),outIntfUtil = IntfUtilWarn.AVG(outIntfUtil) 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_INTF_UTIL_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfUtil,outIntfUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_214" entityVersion="1" xmlId="Rule$PH_Rule_Perf_214" ownerId="500150" lastModified="1350152315320" id="973318" custId="0" creationTime="1350152315319">
                <activatedTime>1350152315320</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that interface utilization of a network device has reached a critical level (utilization greater than 50% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973292" ownerId="500150" lastModified="1350152315320" id="973292" custId="0" creationTime="1350152315320">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>(AVG(inIntfUtil) &gt; 50 OR AVG(outIntfUtil) &gt; 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfUtilCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND hostIpAddr NOT IN (Group@PH_SYS_APP_NETWORK_IPS) AND intfName NOT CONTAIN "Loopback" AND intfName NOT IN ("lo","Null0")</singleConstraint>
                </eventFilters>
                <name>Server Intf Util Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973292</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfUtilCrit.hostIpAddr, hostName = IntfUtilCrit.hostName, intfName = IntfUtilCrit.intfName, inIntfUtil = IntfUtilCrit.AVG(inIntfUtil),outIntfUtil = IntfUtilCrit.AVG(outIntfUtil) 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_INTF_UTIL_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfUtil,outIntfUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_215" entityVersion="1" xmlId="Rule$PH_Rule_Perf_215" ownerId="500150" lastModified="1350152315398" id="973319" custId="0" creationTime="1350152315397">
                <activatedTime>1350152315397</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network device interface error has reached a warning level (utilization between 1% and 5% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973293" ownerId="500150" lastModified="1350152315397" id="973293" custId="0" creationTime="1350152315397">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>AVG(inIntfPktErrPct) &gt;= 1 AND AVG(inIntfPktErrPct) &lt;= 5 OR
          AVG(outIntfPktErrPct) &gt;= 1 AND AVG(outIntfPktErrPct) &lt;= 5 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfErrorWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Intf Error Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973293</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfErrorWarn.hostIpAddr, hostName = IntfErrorWarn.hostName, intfName = IntfErrorWarn.intfName,inIntfPktErrPct = IntfErrorWarn.AVG(inIntfPktErrPct), outIntfPktErrPct = IntfErrorWarn.AVG(outIntfPktErrPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NET_INTF_ERR_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfPktErrPct,outIntfPktErrPct,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_216" entityVersion="1" xmlId="Rule$PH_Rule_Perf_216" ownerId="500150" lastModified="1350152315473" id="973320" custId="0" creationTime="1350152315473">
                <activatedTime>1350152315473</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network device interface errors has reached a critical level (greater than 5% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973294" ownerId="500150" lastModified="1350152315473" id="973294" custId="0" creationTime="1350152315473">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>AVG(inIntfPktErrPct) &gt; 5 OR AVG(outIntfPktErrPct) &gt; 5) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfErrorCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Intf Error Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973294</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfErrorCrit.hostIpAddr, hostName = IntfErrorCrit.hostName, intfName = IntfErrorCrit.intfName, inIntfPktErrPct = IntfErrorCrit.AVG(inIntfPktErrPct), outIntfPktErrPct = IntfErrorCrit.AVG(outIntfPktErrPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_INTF_ERR_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfPktErrPct,outIntfPktErrPct,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_217" entityVersion="1" xmlId="Rule$PH_Rule_Perf_217" ownerId="500150" lastModified="1350152315548" id="973321" custId="0" creationTime="1350152315548">
                <activatedTime>1350152315548</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a server interface error has reached a warning level (utilization between 1% and 5% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973295" ownerId="500150" lastModified="1350152315548" id="973295" custId="0" creationTime="1350152315548">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>AVG(inIntfPktErrPct) &gt;= 1 AND AVG(inIntfPktErrPct) &lt;= 5 OR
          AVG(outIntfPktErrPct) &gt;= 1 AND AVG(outIntfPktErrPct) &lt;= 5 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfErrorWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Intf Error Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973295</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfErrorWarn.hostIpAddr, hostName = IntfErrorWarn.hostName, intfName = IntfErrorWarn.intfName,inIntfPktErrPct = IntfErrorWarn.AVG(inIntfPktErrPct), outIntfPktErrPct = IntfErrorWarn.AVG(outIntfPktErrPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_INTF_ERR_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfPktErrPct,outIntfPktErrPct,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_218" entityVersion="1" xmlId="Rule$PH_Rule_Perf_218" ownerId="500150" lastModified="1350152315624" id="973322" custId="0" creationTime="1350152315623">
                <activatedTime>1350152315624</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a server interface errors has reached a critical level (greater than 5% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973296" ownerId="500150" lastModified="1350152315624" id="973296" custId="0" creationTime="1350152315624">
                    <groupBy>hostIpAddr,hostName,intfName</groupBy>
                    <groupConstraint>AVG(inIntfPktErrPct) &gt; 5 OR AVG(outIntfPktErrPct) &gt; 5) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IntfErrorCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Intf Error Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973296</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IntfErrorCrit.hostIpAddr, hostName = IntfErrorCrit.hostName, intfName = IntfErrorCrit.intfName, inIntfPktErrPct = IntfErrorCrit.AVG(inIntfPktErrPct), outIntfPktErrPct = IntfErrorCrit.AVG(outIntfPktErrPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_INTF_ERR_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,intfName,inIntfPktErrPct,outIntfPktErrPct,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_219" entityVersion="1" xmlId="Rule$PH_Rule_Perf_219" ownerId="500150" lastModified="1350152315700" id="973323" custId="0" creationTime="1350152315699">
                <activatedTime>1350152315699</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that virtual server CPU ready percent has reached a warning level (between 20% and 25% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973297" ownerId="500150" lastModified="1350152315699" id="973297" custId="0" creationTime="1350152315699">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName</groupBy>
                    <groupConstraint>AVG(cpuReadyPct) &gt;= 20 AND AVG(cpuReadyPct) &lt; 25 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>VMCPUMedium</name>
                    <singleConstraint>eventType = "PH_DEV_MON_VM_CPU_UTIL"</singleConstraint>
                </eventFilters>
                <name>Virtual Machine CPU Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973297</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = VMCPUMedium.hostIpAddr,hostName = VMCPUMedium.hostName,phyMachIpAddr = VMCPUMedium.phyMachIpAddr,phyMachName = VMCPUMedium.phyMachName,cpuReadyPct = VMCPUMedium.AVG(cpuReadyPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VM_CPU_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,cpuUtil,cpuSysPct,cpuReadyPct,phyCpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_220" entityVersion="1" xmlId="Rule$PH_Rule_Perf_220" ownerId="500150" lastModified="1350152315776" id="973324" custId="0" creationTime="1350152315775">
                <activatedTime>1350152315775</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that virtual server CPU ready percent has reached a critical level (greater than 25% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973298" ownerId="500150" lastModified="1350152315775" id="973298" custId="0" creationTime="1350152315775">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName</groupBy>
                    <groupConstraint>AVG(cpuReadyPct) &gt;= 25 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>VMCPUHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_VM_CPU_UTIL"</singleConstraint>
                </eventFilters>
                <name>Virtual Machine CPU Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973298</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = VMCPUHigh.hostIpAddr,hostName = VMCPUHigh.hostName,phyMachIpAddr = VMCPUHigh.phyMachIpAddr,phyMachName = VMCPUHigh.phyMachName,cpuReadyPct = VMCPUHigh.AVG(cpuReadyPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VM_CPU_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,cpuUtil,cpuSysPct,cpuReadyPct,phyCpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_221" entityVersion="1" xmlId="Rule$PH_Rule_Perf_221" ownerId="500150" lastModified="1350152315852" id="973325" custId="0" creationTime="1350152315851">
                <activatedTime>1350152315851</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that virtual machine memory has reached a warning level based on swapping rate between 1MBps and 1.5MBps based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973299" ownerId="500150" lastModified="1350152315851" id="973299" custId="0" creationTime="1350152315851">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName</groupBy>
                    <groupConstraint>AVG(swapReadKBytesPerSec) &gt;= 1000 AND AVG(swapReadKBytesPerSec) &lt; 1500 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>VMMemMedium</name>
                    <singleConstraint>eventType = "PH_DEV_MON_VM_MEM_UTIL"</singleConstraint>
                </eventFilters>
                <name>Virtual Machine Memory Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973299</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = VMMemMedium.hostIpAddr,hostName = VMMemMedium.hostName,phyMachIpAddr = VMMemMedium.phyMachIpAddr,phyMachName = VMMemMedium.phyMachName,swapReadKBytesPerSec  = VMMemMedium.AVG(swapReadKBytesPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VM_MEM_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,memUtil,swapReadKBytesPerSec,swapWriteKBytesPerSec,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_222" entityVersion="1" xmlId="Rule$PH_Rule_Perf_222" ownerId="500150" lastModified="1350152315929" id="973326" custId="0" creationTime="1350152315928">
                <activatedTime>1350152315928</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that virtual machine memory has reached a warning level based on swapping rate greater than 1.5MBps based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973450" ownerId="500150" lastModified="1350152315928" id="973450" custId="0" creationTime="1350152315928">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName</groupBy>
                    <groupConstraint>AVG(swapReadKBytesPerSec) &gt; 1500 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>VMMemHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_VM_MEM_UTIL"</singleConstraint>
                </eventFilters>
                <name>Virtual Machine Memory Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973450</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = VMMemHigh.hostIpAddr,hostName = VMMemHigh.hostName,phyMachIpAddr = VMMemHigh.phyMachIpAddr,phyMachName = VMMemHigh.phyMachName,swapReadKBytesPerSec  = VMMemHigh.AVG(swapReadKBytesPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VM_MEM_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,cpuUtil,cpuSysPct,cpuReadyPct,phyCpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_224" entityVersion="1" xmlId="Rule$PH_Rule_Perf_224" ownerId="500150" lastModified="1350152316006" id="973327" custId="0" creationTime="1350152316005">
                <activatedTime>1350152316005</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that virtual machine SCSI bus reset indicating that a read or write failed to complete within an acceptable amount of time. Storage could be a bottleneck.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973451" ownerId="500150" lastModified="1350152316005" id="973451" custId="0" creationTime="1350152316005">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName,diskAdapter</groupBy>
                    <groupConstraint>AVG(diskBusResets) &gt;= 1 AND COUNT(*) &gt; 0</groupConstraint>
                    <index>0</index>
                    <name>VMDiskReset</name>
                    <singleConstraint>eventType = "PH_DEV_MON_VM_DISK_IO"</singleConstraint>
                </eventFilters>
                <name>Virtual Machine SCSI Bus Reset</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973451</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = VMDiskReset.hostIpAddr,hostName = VMDiskReset.hostName,phyMachIpAddr = VMDiskReset.phyMachIpAddr,phyMachName = VMDiskReset.phyMachName,diskAdapter = VMDiskReset.diskAdapter
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VM_DISKIO_SCSI_BUS_RESET</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,diskAdapter,diskBusResets,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_225" entityVersion="1" xmlId="Rule$PH_Rule_Perf_225" ownerId="500150" lastModified="1350152316083" id="973328" custId="0" creationTime="1350152316082">
                <activatedTime>1350152316082</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX CPU utilization has reached a warning level (between 75% and 95% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973452" ownerId="500150" lastModified="1350152316082" id="973452" custId="0" creationTime="1350152316082">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt;= 75 AND AVG(cpuUtil) &lt;= 95 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXCPUWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_CPU_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER)</singleConstraint>
                </eventFilters>
                <name>ESX CPU Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973452</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXCPUWarn.hostIpAddr,hostName = ESXCPUWarn.hostName,cpuUtil = ESXCPUWarn.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_CPU_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_226" entityVersion="1" xmlId="Rule$PH_Rule_Perf_226" ownerId="500150" lastModified="1350152316162" id="973329" custId="0" creationTime="1350152316161">
                <activatedTime>1350152316162</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX CPU utilization has reached a critical level (greater than 95% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973453" ownerId="500150" lastModified="1350152316161" id="973453" custId="0" creationTime="1350152316161">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt; 95 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXCPUCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_CPU_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER)</singleConstraint>
                </eventFilters>
                <name>ESX CPU Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973453</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXCPUCrit.hostIpAddr,hostName = ESXCPUCrit.hostName,cpuUtil = ESXCPUCrit.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_CPU_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_227" entityVersion="1" xmlId="Rule$PH_Rule_Perf_227" ownerId="500150" lastModified="1350152316240" id="973330" custId="0" creationTime="1350152316239">
                <activatedTime>1350152316239</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX memory utilization has reached a warning level (greater than 85% and swap rate between 1MBps and 1.5 MBps) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973454" ownerId="500150" lastModified="1350152316239" id="973454" custId="0" creationTime="1350152316239">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>AVG(memUtil) &gt;= 85 AND AVG(swapReadKBytesPerSec) &gt;= 1000 AND AVG(swapReadKBytesPerSec) &lt;= 1500 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXMemWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER)</singleConstraint>
                </eventFilters>
                <name>ESX Memory Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973454</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXMemWarn.hostIpAddr, hostName = ESXMemWarn.hostName, memUtil = ESXMemWarn.AVG(memUtil), swapReadKBytesPerSec = ESXMemWarn.AVG(swapReadKBytesPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_MEM_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,memUtil,swapReadKBytesPerSec,swapWriteKBytesPerSec,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_228" entityVersion="1" xmlId="Rule$PH_Rule_Perf_228" ownerId="500150" lastModified="1350152316319" id="973331" custId="0" creationTime="1350152316318">
                <activatedTime>1350152316318</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX CPU utilization has reached a critical level (greater than 95% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973455" ownerId="500150" lastModified="1350152316318" id="973455" custId="0" creationTime="1350152316318">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>AVG(memUtil) &gt; 95 AND AVG(swapReadKBytesPerSec) &gt; 1500 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXMemCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_MEM_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER)</singleConstraint>
                </eventFilters>
                <name>ESX Memory Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973455</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXMemCrit.hostIpAddr,hostName = ESXMemCrit.hostName, memUtil = ESXMemCrit.AVG(memUtil), swapReadKBytesPerSec = ESXMemCrit.AVG(swapReadKBytesPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_MEM_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,memUtil,swapReadKBytesPerSec,swapWriteKBytesPerSec,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_229" entityVersion="1" xmlId="Rule$PH_Rule_Perf_229" ownerId="500150" lastModified="1350152316397" id="973332" custId="0" creationTime="1350152316396">
                <activatedTime>1350152316396</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX disk I/O utilization has reached a warning level - average Disk IO Latency between 20ms and 50ms based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973456" ownerId="500150" lastModified="1350152316396" id="973456" custId="0" creationTime="1350152316396">
                    <groupBy>hostName,hostIpAddr,diskName,datastore</groupBy>
                    <groupConstraint>AVG(devDiskRdLatency) &gt;= 20 AND AVG(devDiskRdLatency) &lt;= 50 AND AVG(devDiskWrLatency) &gt;= 20 AND AVG(devDiskWrLatency) &lt; 50 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXDiskWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_ESX_DISK_IO"</singleConstraint>
                </eventFilters>
                <name>ESX Disk I/O Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973456</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXDiskWarn.hostIpAddr, hostName = ESXDiskWarn.hostName, diskName = ESXDiskWarn.diskName, datastore = ESXDiskWarn.datastore,
        devDiskRdLatency = ESXDiskWarn.AVG(devDiskRdLatency), devDiskWrLatency = ESXDiskWarn.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_DISKIO_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,diskName,datastore,devDiskRdLatency,devDiskWrLatency,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_230" entityVersion="1" xmlId="Rule$PH_Rule_Perf_230" ownerId="500150" lastModified="1350152316475" id="973333" custId="0" creationTime="1350152316474">
                <activatedTime>1350152316474</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX disk I/O utilization has reached a critical level - average Disk IO Latency greater than 50ms based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973457" ownerId="500150" lastModified="1350152316474" id="973457" custId="0" creationTime="1350152316474">
                    <groupBy>hostName,hostIpAddr,diskName,datastore</groupBy>
                    <groupConstraint>(AVG(devDiskRdLatency) &gt;= 50 OR AVG(devDiskWrLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXDiskCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_ESX_DISK_IO"</singleConstraint>
                </eventFilters>
                <name>ESX Disk I/O Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973457</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXDiskCrit.hostIpAddr, hostName = ESXDiskCrit.hostName, diskName = ESXDiskCrit.diskName,
        datastore = ESXDiskCrit.datastore,
        devDiskRdLatency = ESXDiskCrit.AVG(devDiskRdLatency), devDiskWrLatency = ESXDiskCrit.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_DISKIO_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,diskName,datastore,devDiskRdLatency,devDiskWrLatency,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_231" entityVersion="1" xmlId="Rule$PH_Rule_Perf_231" ownerId="500150" lastModified="1350152316553" id="973334" custId="0" creationTime="1350152316552">
                <activatedTime>1350152316552</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX network I/O utilization has reached a warning level - average network interface utilization between 35% and 50% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973458" ownerId="500150" lastModified="1350152316552" id="973458" custId="0" creationTime="1350152316552">
                    <groupBy>hostName,hostIpAddr,vSwitch</groupBy>
                    <groupConstraint>((AVG(inIntfUtil) &gt;= 35 AND AVG(inIntfUtil) &lt;= 50) OR (AVG(outIntfUtil) &gt;= 35 AND AVG(outIntfUtil) &lt;= 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXIntfWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER)</singleConstraint>
                </eventFilters>
                <name>ESX Network I/O Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973458</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXIntfWarn.hostIpAddr, hostName = ESXIntfWarn.hostName, vSwitch = ESXIntfWarn.vSwitch,
        inIntfUtil = ESXIntfWarn.AVG(inIntfUtil), outIntfUtil = ESXIntfWarn.AVG(outIntfUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_INTF_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,vSwitch, inIntfUtil, outIntfUtil, rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_232" entityVersion="1" xmlId="Rule$PH_Rule_Perf_232" ownerId="500150" lastModified="1350152316632" id="973335" custId="0" creationTime="1350152316631">
                <activatedTime>1350152316631</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ESX network I/O utilization has reached a critical level - average network interface utilization greater than 50% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973459" ownerId="500150" lastModified="1350152316631" id="973459" custId="0" creationTime="1350152316631">
                    <groupBy>hostName,hostIpAddr,vSwitch</groupBy>
                    <groupConstraint>(AVG(inIntfUtil) &gt; 50 OR AVG(outIntfUtil) &gt; 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ESXIntfCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_NET_INTF_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_VM_SERVER)</singleConstraint>
                </eventFilters>
                <name>ESX Network I/O Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973459</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ESXIntfCrit.hostIpAddr, hostName = ESXIntfCrit.hostName, vSwitch = ESXIntfCrit.vSwitch,
        inIntfUtil = ESXIntfCrit.AVG(inIntfUtil), outIntfUtil = ESXIntfCrit.AVG(outIntfUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ESX_INTF_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,vSwitch, inIntfUtil, outIntfUtil, rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_233" entityVersion="1" xmlId="Rule$PH_Rule_Perf_233" ownerId="500150" lastModified="1350152316712" id="973336" custId="0" creationTime="1350152316711">
                <activatedTime>1350152316711</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that storage CPU has reached a warning level (between 85% and 95% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973460" ownerId="500150" lastModified="1350152316711" id="973460" custId="0" creationTime="1350152316711">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt;= 85 AND AVG(cpuUtil) &lt;= 95 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorCPUWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_SYS_CPU_UTIL","PH_DEV_MON_CLARION_SP_UTIL") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage)</singleConstraint>
                </eventFilters>
                <name>Storage CPU Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973460</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorCPUWarn.hostIpAddr, hostName = StorCPUWarn.hostName, cpuUtil = StorCPUWarn.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STORAGE_CPU_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_234" entityVersion="1" xmlId="Rule$PH_Rule_Perf_234" ownerId="500150" lastModified="1350152316792" id="973337" custId="0" creationTime="1350152316790">
                <activatedTime>1350152316791</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that storage CPU has reached a critical level (greater than 95% based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973461" ownerId="500150" lastModified="1350152316790" id="973461" custId="0" creationTime="1350152316790">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt; 95 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorCPUCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_SYS_CPU_UTIL","PH_DEV_MON_CLARION_SP_UTIL") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage)</singleConstraint>
                </eventFilters>
                <name>Storage CPU Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973461</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorCPUCrit.hostIpAddr, hostName = StorCPUCrit.hostName, cpuUtil = StorCPUCrit.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STORAGE_CPU_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,cpuUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_235" entityVersion="1" xmlId="Rule$PH_Rule_Perf_235" ownerId="500150" lastModified="1350152316871" id="973338" custId="0" creationTime="1350152316870">
                <activatedTime>1350152316870</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NFS disk space usage has reached a warning level (utilization between 80% and 95% and free disk still greater than 100 MB) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973462" ownerId="500150" lastModified="1350152316870" id="973462" custId="0" creationTime="1350152316870">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>((AVG(diskUtil) &gt;= 80 AND AVG(diskUtil) &lt;= 95) OR (AVG(diskUtil) &gt;= 95 AND AVG(freeDiskMB) &gt; 100)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>NFSDiskWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_DISK_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage)</singleConstraint>
                </eventFilters>
                <name>NFS Disk space Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973462</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = NFSDiskWarn.hostIpAddr, hostName = NFSDiskWarn.hostName, diskName = NFSDiskWarn.diskName, diskUtil = NFSDiskWarn.AVG(diskUtil)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NFS_DISK_SPACE_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,diskUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_236" entityVersion="1" xmlId="Rule$PH_Rule_Perf_236" ownerId="500150" lastModified="1350152316951" id="973339" custId="0" creationTime="1350152316950">
                <activatedTime>1350152316950</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NFS disk space usage has reached a critical level (greater than 95% and free disk less than 100 MB) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973463" ownerId="500150" lastModified="1350152316950" id="973463" custId="0" creationTime="1350152316950">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>AVG(diskUtil) &gt; 95 AND AVG(freeDiskMB) &lt; 100 AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>NFSDiskCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_DISK_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage)</singleConstraint>
                </eventFilters>
                <name>NFS Disk Space Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973463</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = NFSDiskCrit.hostIpAddr, hostName = NFSDiskCrit.hostName, diskName = NFSDiskCrit.diskName, diskUtil = NFSDiskCrit.AVG(diskUtil)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NFS_DISK_SPACE_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,diskUtil,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_237" entityVersion="1" xmlId="Rule$PH_Rule_Perf_237" ownerId="500150" lastModified="1350152317030" id="973340" custId="0" creationTime="1350152317029">
                <activatedTime>1350152317029</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the NFS Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973464" ownerId="500150" lastModified="1350152317029" id="973464" custId="0" creationTime="1350152317029">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>((AVG(nfsReadLatency) &gt;= 20 AND AVG(nfsReadLatency) &lt; 50) OR (AVG(nfsWriteLatency) &gt;= 20 AND AVG(nfsWriteLatency) &lt; 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_NFS3_MET", "PH_DEV_MON_NETAPP_NFS4_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp NFS Read/Write Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973464</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyWarn.hostIpAddr, hostName = StorageDiskLatencyWarn.hostName, nfsReadLatency = StorageDiskLatencyWarn.AVG(nfsReadLatency), nfsWriteLatency = StorageDiskLatencyWarn.AVG(nfsWriteLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_NFS_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,nfsReadOpsPerSec,nfsWriteOpsPerSec,nfsOpsPerSec,nfsReadLatency,nfsWriteLatency,nfsReadKBytesPerSec,nfsWriteKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_238" entityVersion="1" xmlId="Rule$PH_Rule_Perf_238" ownerId="500150" lastModified="1350152317110" id="973341" custId="0" creationTime="1350152317109">
                <activatedTime>1350152317109</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NetApp NFS Read/Write latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973465" ownerId="500150" lastModified="1350152317109" id="973465" custId="0" creationTime="1350152317109">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>(AVG(nfsReadLatency) &gt;= 50 OR AVG(nfsWriteLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_NFS3_MET", "PH_DEV_MON_NETAPP_NFS4_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp NFS Read/Write Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973465</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyCrit.hostIpAddr, hostName = StorageDiskLatencyCrit.hostName, nfsReadLatency = StorageDiskLatencyCrit.AVG(nfsReadLatency), nfsWriteLatency = StorageDiskLatencyCrit.AVG(nfsWriteLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_NFS_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,nfsReadOpsPerSec,nfsWriteOpsPerSec,nfsOpsPerSec,nfsReadLatency,nfsWriteLatency,nfsReadKBytesPerSec,nfsWriteKBytesPerSec </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_239" entityVersion="1" xmlId="Rule$PH_Rule_Perf_239" ownerId="500150" lastModified="1350152317191" id="973342" custId="0" creationTime="1350152317190">
                <activatedTime>1350152317190</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the CIFS Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973466" ownerId="500150" lastModified="1350152317190" id="973466" custId="0" creationTime="1350152317190">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>(AVG(cifsLatency) &gt;= 20 AND AVG(cifsLatency) &lt; 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_CIFS_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp CIFS Read/Write Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973466</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyWarn.hostIpAddr, hostName = StorageDiskLatencyWarn.hostName, cifsLatency = StorageDiskLatencyWarn.AVG(cifsLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_CIFS_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,cifsOpsPerSec,cifsLatency</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_240" entityVersion="1" xmlId="Rule$PH_Rule_Perf_240" ownerId="500150" lastModified="1350152317272" id="973343" custId="0" creationTime="1350152317270">
                <activatedTime>1350152317270</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NetApp CIFS latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973467" ownerId="500150" lastModified="1350152317270" id="973467" custId="0" creationTime="1350152317270">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(cifsLatency) &gt;= 50  AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_CIFS_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp CIFS Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973467</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyCrit.hostIpAddr, hostName = StorageDiskLatencyCrit.hostName, cifsLatency = StorageDiskLatencyCrit.AVG(cifsLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_CIFS_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,cifsOpsPerSec,cifsLatency </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_241" entityVersion="1" xmlId="Rule$PH_Rule_Perf_241" ownerId="500150" lastModified="1350152317353" id="973344" custId="0" creationTime="1350152317352">
                <activatedTime>1350152317352</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the ISCSI Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973468" ownerId="500150" lastModified="1350152317352" id="973468" custId="0" creationTime="1350152317352">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>((AVG(iscsiReadLatency) &gt;= 20 AND AVG(iscsiReadLatency) &lt; 50) OR (AVG(iscsiWriteLatency) &gt;= 20 AND AVG(iscsiWriteLatency) &lt; 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_ISCSI_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp ISCSI Read/Write Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973468</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyWarn.hostIpAddr, hostName = StorageDiskLatencyWarn.hostName, iscsiReadLatency = StorageDiskLatencyWarn.AVG(iscsiReadLatency), iscsiWriteLatency = StorageDiskLatencyWarn.AVG(iscsiWriteLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_ISCSI_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,iscsiReadOpsPerSec,iscsiWriteOpsPerSec,iscsiOpsPerSec,iscsiReadLatency,iscsiWriteLatency,iscsiReadKBytesPerSec,iscsiWriteKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_242" entityVersion="1" xmlId="Rule$PH_Rule_Perf_242" ownerId="500150" lastModified="1350152317434" id="973345" custId="0" creationTime="1350152317433">
                <activatedTime>1350152317433</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NetApp ISCSI Read/Write latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973469" ownerId="500150" lastModified="1350152317433" id="973469" custId="0" creationTime="1350152317433">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>(AVG(iscsiReadLatency) &gt;= 50 OR AVG(iscsiWriteLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_ISCSI_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp ISCSI Read/Write Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973469</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyCrit.hostIpAddr, hostName = StorageDiskLatencyCrit.hostName, iscsiReadLatency = StorageDiskLatencyCrit.AVG(iscsiReadLatency), iscsiWriteLatency = StorageDiskLatencyCrit.AVG(iscsiWriteLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_ISCSI_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,iscsiReadOpsPerSec,iscsiWriteOpsPerSec,iscsiOpsPerSec,iscsiReadLatency,iscsiWriteLatency,iscsiReadKBytesPerSec,iscsiWriteKBytesPerSec </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_243" entityVersion="1" xmlId="Rule$PH_Rule_Perf_243" ownerId="500150" lastModified="1350152317515" id="973346" custId="0" creationTime="1350152317514">
                <activatedTime>1350152317514</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the FCP Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973470" ownerId="500150" lastModified="1350152317514" id="973470" custId="0" creationTime="1350152317514">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>((AVG(fcpReadLatency) &gt;= 20 AND AVG(fcpReadLatency) &lt; 50) OR (AVG(fcpWriteLatency) &gt;= 20 AND AVG(fcpWriteLatency) &lt; 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_FCP_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp FCP Read/Write Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973470</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyWarn.hostIpAddr, hostName = StorageDiskLatencyWarn.hostName, fcpReadLatency = StorageDiskLatencyWarn.AVG(fcpReadLatency), fcpWriteLatency = StorageDiskLatencyWarn.AVG(fcpWriteLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_FCP_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,fcpReadOpsPerSec,fcpWriteOpsPerSec,fcpOpsPerSec,fcpReadLatency,fcpWriteLatency,fcpReadKBytesPerSec,fcpWriteKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_244" entityVersion="1" xmlId="Rule$PH_Rule_Perf_244" ownerId="500150" lastModified="1350152317597" id="973347" custId="0" creationTime="1350152317595">
                <activatedTime>1350152317595</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NetApp FCP Read/Write latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973471" ownerId="500150" lastModified="1350152317595" id="973471" custId="0" creationTime="1350152317595">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>(AVG(fcpReadLatency) &gt;= 50 OR AVG(fcpWriteLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_FCP_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp FCP Read/Write Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973471</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyCrit.hostIpAddr, hostName = StorageDiskLatencyCrit.hostName, fcpReadLatency = StorageDiskLatencyCrit.AVG(fcpReadLatency), fcpWriteLatency = StorageDiskLatencyCrit.AVG(fcpWriteLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_FCP_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,fcpReadOpsPerSec,fcpWriteOpsPerSec,fcpOpsPerSec,fcpReadLatency,fcpWriteLatency,fcpReadKBytesPerSec,fcpWriteKBytesPerSec </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_245" entityVersion="1" xmlId="Rule$PH_Rule_Perf_245" ownerId="500150" lastModified="1350152317678" id="973348" custId="0" creationTime="1350152317677">
                <activatedTime>1350152317677</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the FCP Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973472" ownerId="500150" lastModified="1350152317677" id="973472" custId="0" creationTime="1350152317677">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>((AVG(devDiskRdLatency) &gt;= 20 AND AVG(devDiskRdLatency) &lt; 50) OR (AVG(devDiskWrLatency) &gt;= 20 AND AVG(devDiskWrLatency) &lt; 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_VOL_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp Volume Read/Write Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973472</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyWarn.hostIpAddr, hostName = StorageDiskLatencyWarn.hostName, devDiskRdLatency = StorageDiskLatencyWarn.AVG(devDiskRdLatency), devDiskWrLatency = StorageDiskLatencyWarn.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_VOLUME_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName, devDiskRdLatency, devDiskWrLatency,diskReadReqPerSec,diskWriteReqPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_246" entityVersion="1" xmlId="Rule$PH_Rule_Perf_246" ownerId="500150" lastModified="1350152317761" id="973349" custId="0" creationTime="1350152317759">
                <activatedTime>1350152317759</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that NetApp Volume Read/Write latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973473" ownerId="500150" lastModified="1350152317759" id="973473" custId="0" creationTime="1350152317759">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>(AVG(devDiskRdLatency) &gt;= 50 OR AVG(devDiskWrLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_NETAPP_VOL_MET")</singleConstraint>
                </eventFilters>
                <name>NetApp Volume Read/Write Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973473</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyCrit.hostIpAddr, hostName = StorageDiskLatencyCrit.hostName, devDiskRdLatency = StorageDiskLatencyCrit.AVG(devDiskRdLatency), devDiskWrLatency = StorageDiskLatencyCrit.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETAPP_VOLUME_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,devDiskRdLatency, devDiskWrLatency,diskReadReqPerSec,diskWriteReqPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_247" entityVersion="1" xmlId="Rule$PH_Rule_Perf_247" ownerId="500150" lastModified="1350152317844" id="973550" custId="0" creationTime="1350152317842">
                <activatedTime>1350152317843</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the EqualLogic connection Read or Write latency has reached a warning level (between 20 and 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973474" ownerId="500150" lastModified="1350152317843" id="973474" custId="0" creationTime="1350152317843">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>((AVG(devDiskRdLatency) &gt;= 20 AND AVG(devDiskRdLatency) &lt; 50) OR (AVG(devDiskWrLatency) &gt;= 20 AND AVG(devDiskWrLatency) &lt; 50)) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyWarn</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_EQL_CONN_MET")</singleConstraint>
                </eventFilters>
                <name>EqualLogic Connection Read/Write Latency Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973474</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyWarn.hostIpAddr, hostName = StorageDiskLatencyWarn.hostName, devDiskRdLatency = StorageDiskLatencyWarn.AVG(devDiskRdLatency), devDiskWrLatency = StorageDiskLatencyWarn.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EQLOGIC_CONN_LATENCY_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName, devDiskRdLatency, devDiskWrLatency,diskReadReqPerSec,diskWriteReqPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_248" entityVersion="1" xmlId="Rule$PH_Rule_Perf_248" ownerId="500150" lastModified="1350152317926" id="973551" custId="0" creationTime="1350152317925">
                <activatedTime>1350152317925</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that EqualLogic Connection Read/Write latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973475" ownerId="500150" lastModified="1350152317925" id="973475" custId="0" creationTime="1350152317925">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>(AVG(devDiskRdLatency) &gt;= 50 OR AVG(devDiskWrLatency) &gt;= 50) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>StorageDiskLatencyCrit</name>
                    <singleConstraint>eventType IN ("PH_DEV_MON_EQL_CONN_MET")</singleConstraint>
                </eventFilters>
                <name>EqualLogic Connection Read/Write Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973475</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = StorageDiskLatencyCrit.hostIpAddr, hostName = StorageDiskLatencyCrit.hostName, devDiskRdLatency = StorageDiskLatencyCrit.AVG(devDiskRdLatency), devDiskWrLatency = StorageDiskLatencyCrit.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EQLOGIC_CONN_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,devDiskRdLatency, devDiskWrLatency,diskReadReqPerSec,diskWriteReqPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_249" entityVersion="1" xmlId="Rule$PH_Rule_Perf_249" ownerId="500150" lastModified="1350152318009" id="973552" custId="0" creationTime="1350152318007">
                <activatedTime>1350152318008</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that server paging file usage has reached a critical level (greater than 98% based on 5 successive readings in a 1 hour interval. The paging file is a reserved space on disk that backes up committed physical memory on a computer</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973476" ownerId="500150" lastModified="1350152318007" id="973476" custId="0" creationTime="1350152318007">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(pageFileUsage) &gt;= 98 AND COUNT(*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ServPagingCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_PAGEFILE_USAGE" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Windows Server Paging File Usage Critical</name>
                <triggerWindow>3600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973476</eventFilters>
                <fireInternalIncident>true</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = ServPagingCrit.hostIpAddr, hostName = ServPagingCrit.hostName, pageFileUsage = ServPagingCrit.AVG(pageFileUsage)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_PAGING_FILE_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,pageFileUsage, pageFilePeakUsage </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_1" entityVersion="1" xmlId="Rule$PH_Rule_IPS_1" ownerId="500150" lastModified="1350152318961" id="973553" custId="0" creationTime="1350152318960">
                <activatedTime>1350152318961</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple IPS events from the same source IP in a short period of time - the source IP may have been infected</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973477" ownerId="500150" lastModified="1350152318961" id="973477" custId="0" creationTime="1350152318961">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT eventType) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>DistinctIPSEvents</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND eventSeverity &gt;= 7</singleConstraint>
                </eventFilters>
                <name>Multiple Distinct IPS Events From Same Src</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973477</eventFilters>
                <incidentAttrs>
        srcIpAddr = DistinctIPSEvents.srcIpAddr, incidentCount = DistinctIPSEvents.COUNT (DISTINCT eventType)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_MULTIPLE_IPS_SAME_SRC</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_2" entityVersion="1" xmlId="Rule$PH_Rule_IPS_2" ownerId="500150" lastModified="1350152319032" id="973554" custId="0" creationTime="1350152319032">
                <activatedTime>1350152319032</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple IPS scans from the same source IP in a short period of time.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973478" ownerId="500150" lastModified="1350152319032" id="973478" custId="0" creationTime="1350152319032">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IPSScan</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND eventType IN (Group@PH_SYS_EVENT_Reconn)</singleConstraint>
                </eventFilters>
                <name>Multiple IPS Scans From Same Src</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973478</eventFilters>
                <incidentAttrs>
        srcIpAddr = IPSScan.srcIpAddr, incidentCount = IPSScan.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SCAN_IPS_SAME_SRC</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_3" entityVersion="1" xmlId="Rule$PH_Rule_IPS_3" ownerId="500150" lastModified="1350152319102" id="973555" custId="0" creationTime="1350152319102">
                <activatedTime>1350152319102</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a high risk rating IPS exploit event. This is applicable for Cisco IPS.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973479" ownerId="500150" lastModified="1350152319102" id="973479" custId="0" creationTime="1350152319102">
                    <groupBy>srcIpAddr,eventType,eventName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>IPSHighRR</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) AND eventType NOT IN (Group@PH_SYS_EVENT_Logon,Group@PH_SYS_EVENT_Reconn) AND ipsEvRR &gt;= 85</singleConstraint>
                </eventFilters>
                <name>High Risk Rating Cisco IPS Exploit</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973479</eventFilters>
                <incidentAttrs>
        srcIpAddr = IPSHighRR.srcIpAddr, compEventType = IPSHighRR.eventType, compEventName = IPSHighRR.eventName, incidentCount = IPSHighRR.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_RR_IPS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_4" entityVersion="1" xmlId="Rule$PH_Rule_IPS_4" ownerId="500150" lastModified="1350152319174" id="973556" custId="0" creationTime="1350152319174">
                <activatedTime>1350152319174</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a high severity IPS exploit detected by non-Cisco IPS</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973480" ownerId="500150" lastModified="1350152319174" id="973480" custId="0" creationTime="1350152319174">
                    <groupBy>srcIpAddr,eventType</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>NonCiscoIPSHighSev</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND reptVendor != "Cisco" AND eventType NOT IN (Group@PH_SYS_EVENT_Logon,Group@PH_SYS_EVENT_Reconn) AND eventSeverity &gt;= 8</singleConstraint>
                </eventFilters>
                <name>High Severity Non-Cisco IPS Exploit</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973480</eventFilters>
                <incidentAttrs>
        srcIpAddr = NonCiscoIPSHighSev.srcIpAddr, compEventType = NonCiscoIPSHighSev.eventType, incidentCount = NonCiscoIPSHighSev.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_SEV_IPS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_5" entityVersion="1" xmlId="Rule$PH_Rule_IPS_5" ownerId="500150" lastModified="1350152319245" id="973557" custId="0" creationTime="1350152319244">
                <activatedTime>1350152319244</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a high severity IPS security exploit from outside that is permitted. This rule makes sense only from an IPS positioned inside the firewall. Since this attack went through the firewall, its consequence must be monitored.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973481" ownerId="500150" lastModified="1350152319244" id="973481" custId="0" creationTime="1350152319244">
                    <groupBy>srcIpAddr,eventType</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>NonIPSHighSev</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS,Group@PH_SYS_APP_NETWORK_IPS) AND (eventSeverity &gt;= 8 OR ipsEvRR &gt;= 85) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 0</singleConstraint>
                </eventFilters>
                <name>High Severity Inbound Permitted IPS Exploit</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973481</eventFilters>
                <incidentAttrs>
        srcIpAddr = NonIPSHighSev.srcIpAddr, compEventType = NonIPSHighSev.eventType, incidentCount = NonIPSHighSev.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_SEV_SEC_IPS_IN_PERMIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_6" entityVersion="1" xmlId="Rule$PH_Rule_IPS_6" ownerId="500150" lastModified="1350152319315" id="973558" custId="0" creationTime="1350152319315">
                <activatedTime>1350152319315</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a high severity IPS security exploit from outside that is denied by IPS. This rule makes sense only from an IPS positioned inside the firewall.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973482" ownerId="500150" lastModified="1350152319315" id="973482" custId="0" creationTime="1350152319315">
                    <groupBy>srcIpAddr,eventType</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>NonIPSHighSev</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS,Group@PH_SYS_APP_NETWORK_IPS) AND (eventSeverity &gt;= 8 OR ipsEvRR &gt;= 85) AND srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND eventAction = 1</singleConstraint>
                </eventFilters>
                <name>High Severity Inbound Denied Security Exploit</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973482</eventFilters>
                <incidentAttrs>
        srcIpAddr = NonIPSHighSev.srcIpAddr, compEventType = NonIPSHighSev.eventType, incidentCount = NonIPSHighSev.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_SEV_SEC_IPS_IN_DENY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_IPS_7" entityVersion="1" xmlId="Rule$PH_Rule_IPS_7" ownerId="500150" lastModified="1350152319391" id="973559" custId="0" creationTime="1350152319391">
                <activatedTime>1350152319391</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high severity SQL Injection Attacks</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973483" ownerId="500150" lastModified="1350152319391" id="973483" custId="0" creationTime="1350152319391">
                    <groupBy>srcIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>SQLInjection</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND eventType IN (Group@PH_SYS_EVENT_CodeInjectionExploit) AND eventSeverity &gt;= 7</singleConstraint>
                </eventFilters>
                <name>SQL Injection Attack</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973483</eventFilters>
                <incidentAttrs>
        srcIpAddr = SQLInjection.srcIpAddr, destIpAddr = SQLInjection.destIpAddr 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_IPS_SQL_INJECTION</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_1" entityVersion="1" xmlId="Rule$PH_Rule_Access_1" ownerId="500150" lastModified="1350152319965" id="973560" custId="0" creationTime="1350152319965">
                <activatedTime>1350152319965</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple logon failures at a network device - 5 consecutive failures in a 10 minute period. This rule triggers for network devices that do not report a source IP address.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973484" ownerId="500150" lastModified="1350152319965" id="973484" custId="0" creationTime="1350152319965">
                    <groupBy>reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessNetLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) AND srcIpAddr IS NULL</singleConstraint>
                </eventFilters>
                <name>Multiple Admin Login Failures: Net Device (no Source IP)</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973484</eventFilters>
                <incidentAttrs>
        destIpAddr = ExcessNetLoginFailure.reptDevIpAddr, user = ExcessNetLoginFailure.user, incidentCount = ExcessNetLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,user,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_2" entityVersion="1" xmlId="Rule$PH_Rule_Access_2" ownerId="500150" lastModified="1350152320037" id="973561" custId="0" creationTime="1350152320037">
                <activatedTime>1350152320037</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive logon failures at a network device - 5 consecutive failures in a 10 minute period. This rule triggers for network devices that report a source IP address.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973485" ownerId="500150" lastModified="1350152320037" id="973485" custId="0" creationTime="1350152320037">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessNetLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network) AND srcIpAddr IS NOT NULL</singleConstraint>
                </eventFilters>
                <name>Multiple Admin Login Failures: Net Device</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973485</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessNetLoginFailure.srcIpAddr, destIpAddr = ExcessNetLoginFailure.reptDevIpAddr, user = ExcessNetLoginFailure.user, incidentCount = ExcessNetLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_2_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_3" entityVersion="0" xmlId="Rule$PH_Rule_Access_3" ownerId="500150" lastModified="1350152320107" id="973562" custId="0" creationTime="1350152320107">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of multiple logon failures at a network device</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973486" ownerId="500150" lastModified="1350152320107" id="973486" custId="0" creationTime="1350152320107">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>RepeatExcessNetLoginFailure</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_2_NET_DEV"</singleConstraint>
                </eventFilters>
                <name>Repeated Admin Multiple Login Failures: Net Device</name>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973486</eventFilters>
                <incidentAttrs>
        srcIpAddr = RepeatExcessNetLoginFailure.srcIpAddr, destIpAddr = RepeatExcessNetLoginFailure.destIpAddr, incidentCount =RepeatExcessNetLoginFailure.COUNT(*)  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_2_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_5" entityVersion="1" xmlId="Rule$PH_Rule_Access_5" ownerId="500150" lastModified="1350152320178" id="973563" custId="0" creationTime="1350152320178">
                <activatedTime>1350152320178</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive logon failures at a server - 5 consecutive failures in a 10 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973487" ownerId="500150" lastModified="1350152320178" id="973487" custId="0" creationTime="1350152320178">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessServerLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: Server</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973487</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessServerLoginFailure.srcIpAddr, destIpAddr = ExcessServerLoginFailure.reptDevIpAddr, user = ExcessServerLoginFailure.user, incidentCount = ExcessServerLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_6" entityVersion="0" xmlId="Rule$PH_Rule_Access_6" ownerId="500150" lastModified="1350152320249" id="973564" custId="0" creationTime="1350152320249">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of multiple logon failures at a server from the same user.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973488" ownerId="500150" lastModified="1350152320249" id="973488" custId="0" creationTime="1350152320249">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>RepeatExcessServerLoginFailure</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_SERVER"</singleConstraint>
                </eventFilters>
                <name>Repeated Multiple Logon Failures: Server</name>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973488</eventFilters>
                <incidentAttrs>
        srcIpAddr = RepeatExcessServerLoginFailure.srcIpAddr, destIpAddr = RepeatExcessServerLoginFailure.destIpAddr, incidentCount = RepeatExcessServerLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_10" entityVersion="1" xmlId="Rule$PH_Rule_Access_10" ownerId="500150" lastModified="1350152320321" id="973565" custId="0" creationTime="1350152320320">
                <activatedTime>1350152320320</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive privileged logon failures at a server - 3 consecutive failures in a 10 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973489" ownerId="500150" lastModified="1350152320320" id="973489" custId="0" creationTime="1350152320320">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>ExcessPrivLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostPrivLogonFailure) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Multiple Privileged Logon Failures: Server</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973489</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessPrivLoginFailure.srcIpAddr, destIpAddr = ExcessPrivLoginFailure.reptDevIpAddr, user = ExcessPrivLoginFailure.user, incidentCount = ExcessPrivLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_PRIV_LOGON_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_15A" entityVersion="1" xmlId="Rule$PH_Rule_Access_15A" ownerId="500150" lastModified="1350152320390" id="973566" custId="0" creationTime="1350152320390">
                <activatedTime>1350152320390</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive application logon failures - 5 consecutive failures in a 10 minute period. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973490" ownerId="500150" lastModified="1350152320390" id="973490" custId="0" creationTime="1350152320390">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessWebLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_WebLogonFailure)</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: Web Server</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973490</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessWebLoginFailure.srcIpAddr, destIpAddr = ExcessWebLoginFailure.reptDevIpAddr, user = ExcessWebLoginFailure.user, incidentCount = ExcessWebLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_WEB</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_16A" entityVersion="0" xmlId="Rule$PH_Rule_Access_16A" ownerId="500150" lastModified="1350152320461" id="973567" custId="0" creationTime="1350152320461">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of multiple application logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973491" ownerId="500150" lastModified="1350152320461" id="973491" custId="0" creationTime="1350152320461">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>Filter_Rule_Access_16_1</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_APPL"</singleConstraint>
                </eventFilters>
                <name>Repeated Multiple Logon Failures: Web Server</name>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973491</eventFilters>
                <incidentAttrs>
        srcIpAddr = Filter_Rule_Access_16_1.srcIpAddr, destIpAddr = Filter_Rule_Access_16_1.destIpAddr, incidentCount = Filter_Rule_Access_16_1.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_WEB</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_15B" entityVersion="1" xmlId="Rule$PH_Rule_Access_15B" ownerId="500150" lastModified="1350152320533" id="973568" custId="0" creationTime="1350152320532">
                <activatedTime>1350152320532</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive application logon failures - 5 consecutive failures in a 10 minute period. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973492" ownerId="500150" lastModified="1350152320532" id="973492" custId="0" creationTime="1350152320532">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessDBLoginFailure1</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DBLogonFailure)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973493" ownerId="500150" lastModified="1350152320532" id="973493" custId="0" creationTime="1350152320532">
                    <groupBy>srcName, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>1</index>
                    <name>ExcessDBLoginFailure2</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DBLogonFailure)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>OR</type>
                </filterOperators>
                <name>Multiple Logon Failures: Database</name>
                <rawFOString>OR:0</rawFOString>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973492</eventFilters>
                <eventFilters>EventFilter@973493</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessDBLoginFailure1.srcIpAddr, srcName = ExcessDBLoginFailure2.srcName, destIpAddr = ExcessDBLoginFailure1.reptDevIpAddr, user = ExcessDBLoginFailure1.user, incidentCount = ExcessDBLoginFailure1.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_DB</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,srcName,user,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_16B" entityVersion="0" xmlId="Rule$PH_Rule_Access_16B" ownerId="500150" lastModified="1350152320602" id="973569" custId="0" creationTime="1350152320602">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of multiple application logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973494" ownerId="500150" lastModified="1350152320602" id="973494" custId="0" creationTime="1350152320602">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>Filter_Rule_Access_16_1</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_DB"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973495" ownerId="500150" lastModified="1350152320603" id="973495" custId="0" creationTime="1350152320603">
                    <groupBy>srcName,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>1</index>
                    <name>Filter_Rule_Access_16_2</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_DB"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>OR</type>
                </filterOperators>
                <name>Repeated Multiple Logon Failures: Database</name>
                <rawFOString>OR:0</rawFOString>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973494</eventFilters>
                <eventFilters>EventFilter@973495</eventFilters>
                <incidentAttrs>
        srcIpAddr = Filter_Rule_Access_16_1.srcIpAddr, srcName = Filter_Rule_Access_16_2.srcName, destIpAddr = Filter_Rule_Access_16_1.destIpAddr, incidentCount = Filter_Rule_Access_16_1.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_DB</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,srcName,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_15C" entityVersion="1" xmlId="Rule$PH_Rule_Access_15C" ownerId="500150" lastModified="1350152320674" id="973570" custId="0" creationTime="1350152320673">
                <activatedTime>1350152320673</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive application logon failures - 5 consecutive failures in a 10 minute period. Application logsons include the one that may require authentication for accessing the authentication, such as HTTP, SNMP, FTP, POP3, IMAP etc.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973496" ownerId="500150" lastModified="1350152320673" id="973496" custId="0" creationTime="1350152320673">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessMiscAppLoginFailure1</name>
                    <singleConstraint>srcIpAddr IS NOT NULL AND eventType IN (Group@PH_SYS_EVENT_AppLogonFailure) AND eventType NOT IN (Group@PH_SYS_EVENT_AAALogonFailure)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973497" ownerId="500150" lastModified="1350152320673" id="973497" custId="0" creationTime="1350152320673">
                    <groupBy>reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>1</index>
                    <name>ExcessMiscAppLoginFailure2</name>
                    <singleConstraint>srcIpAddr IS NULL AND eventType IN (Group@PH_SYS_EVENT_AppLogonFailure) AND eventType NOT IN (Group@PH_SYS_EVENT_AAALogonFailure)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>OR</type>
                </filterOperators>
                <name>Multiple Logon Failures: Misc App</name>
                <rawFOString>OR:0</rawFOString>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973496</eventFilters>
                <eventFilters>EventFilter@973497</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessMiscAppLoginFailure1.srcIpAddr, destIpAddr = ExcessMiscAppLoginFailure1.reptDevIpAddr, user = ExcessMiscAppLoginFailure1.user, incidentCount = ExcessMiscAppLoginFailure1.COUNT(*), destIpAddr = ExcessMiscAppLoginFailure2.reptDevIpAddr, user = ExcessMiscAppLoginFailure2.user, incidentCount = ExcessMiscAppLoginFailure2.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_APPL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_16C" entityVersion="0" xmlId="Rule$PH_Rule_Access_16C" ownerId="500150" lastModified="1350152320745" id="973571" custId="0" creationTime="1350152320745">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of multiple application logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973498" ownerId="500150" lastModified="1350152320745" id="973498" custId="0" creationTime="1350152320745">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>RepeatExcessMiscAppLoginFailure1</name>
                    <singleConstraint>srcIpAddr IS NOT NULL AND eventType = "PH_RULE_EXCESS_FAILED_LOGON_APPL"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973499" ownerId="500150" lastModified="1350152320745" id="973499" custId="0" creationTime="1350152320745">
                    <groupBy>eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>1</index>
                    <name>RepeatExcessMiscAppLoginFailure2</name>
                    <singleConstraint>srcIpAddr IS NULL AND eventType = "PH_RULE_EXCESS_FAILED_LOGON_APPL"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>OR</type>
                </filterOperators>
                <name>Repeated Multiple Logon Failures: Misc App</name>
                <rawFOString>OR:0</rawFOString>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973498</eventFilters>
                <eventFilters>EventFilter@973499</eventFilters>
                <incidentAttrs>
        srcIpAddr = RepeatExcessMiscAppLoginFailure1.srcIpAddr, destIpAddr = RepeatExcessMiscAppLoginFailure1.destIpAddr, incidentCount = RepeatExcessMiscAppLoginFailure1.COUNT(*), destIpAddr = RepeatExcessMiscAppLoginFailure2.destIpAddr, incidentCount = RepeatExcessMiscAppLoginFailure2.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_APPL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_20" entityVersion="1" xmlId="Rule$PH_Rule_Access_20" ownerId="500150" lastModified="1350152320818" id="973572" custId="0" creationTime="1350152320818">
                <activatedTime>1350152320818</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple domain logon failures - 5 consecutive failures in a 10 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973700" ownerId="500150" lastModified="1350152320818" id="973700" custId="0" creationTime="1350152320818">
                    <groupBy>srcIpAddr, reptDevIpAddr, user, domain</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessDomainLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DomainLogonFailure)</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: Domain</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973700</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessDomainLoginFailure.srcIpAddr, destIpAddr = ExcessDomainLoginFailure.reptDevIpAddr, domain = ExcessDomainLoginFailure.domain, user = ExcessDomainLoginFailure.user, incidentCount = ExcessDomainLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_DOMAIN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,winLogonFailCode,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_21" entityVersion="0" xmlId="Rule$PH_Rule_Access_21" ownerId="500150" lastModified="1350152320889" id="973573" custId="0" creationTime="1350152320889">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of multiple domain logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973701" ownerId="500150" lastModified="1350152320889" id="973701" custId="0" creationTime="1350152320889">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>RepeatExcessDomainLoginFailure</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_DOMAIN"</singleConstraint>
                </eventFilters>
                <name>Repeated Multiple Logon Failures: Domain</name>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973701</eventFilters>
                <incidentAttrs>
        srcIpAddr = RepeatExcessDomainLoginFailure.srcIpAddr, destIpAddr = RepeatExcessDomainLoginFailure.destIpAddr, incidentCount = RepeatExcessDomainLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_DOMAIN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_25" entityVersion="1" xmlId="Rule$PH_Rule_Access_25" ownerId="500150" lastModified="1350152320962" id="973574" custId="0" creationTime="1350152320962">
                <activatedTime>1350152320962</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple VPN logon failures - 5 consecutive failures in a 10 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973702" ownerId="500150" lastModified="1350152320962" id="973702" custId="0" creationTime="1350152320962">
                    <groupBy>srcIpAddr, reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessVPNLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_VPNLogonFailure)</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: VPN</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973702</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessVPNLoginFailure.srcIpAddr, destIpAddr = ExcessVPNLoginFailure.reptDevIpAddr, user = ExcessVPNLoginFailure.user, incidentCount = ExcessVPNLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_VPN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_26" entityVersion="0" xmlId="Rule$PH_Rule_Access_26" ownerId="500150" lastModified="1350152321033" id="973575" custId="0" creationTime="1350152321033">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of excessive VPN logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973703" ownerId="500150" lastModified="1350152321033" id="973703" custId="0" creationTime="1350152321033">
                    <groupBy>srcIpAddr,eventType,destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>RepeatExcessVPNLoginFailure</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_VPN"</singleConstraint>
                </eventFilters>
                <name>Repeated Multiple Logon Failures: VPN</name>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973703</eventFilters>
                <incidentAttrs>
        srcIpAddr = RepeatExcessVPNLoginFailure.srcIpAddr, destIpAddr = RepeatExcessVPNLoginFailure.destIpAddr, incidentCount = RepeatExcessVPNLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_VPN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_30" entityVersion="1" xmlId="Rule$PH_Rule_Access_30" ownerId="500150" lastModified="1350152321112" id="973576" custId="0" creationTime="1350152321112">
                <activatedTime>1350152321112</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple Wireless logon failures - 5 consecutive failures in a 10 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973704" ownerId="500150" lastModified="1350152321112" id="973704" custId="0" creationTime="1350152321112">
                    <groupBy>srcMACAddr,reptDevIpAddr,user,eventType</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessWLANLoginFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_WirelessLogonFailure)</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: WLAN</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973704</eventFilters>
                <incidentAttrs>
        srcMACAddr = ExcessWLANLoginFailure.srcMACAddr, destIpAddr = ExcessWLANLoginFailure.reptDevIpAddr, user = ExcessWLANLoginFailure.user, incidentCount = ExcessWLANLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FAILED_LOGON_WIRELESS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcMACAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_31" entityVersion="0" xmlId="Rule$PH_Rule_Access_31" ownerId="500150" lastModified="1350152321184" id="973577" custId="0" creationTime="1350152321184">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects repeating occurrences of excessive wireless LAN logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973705" ownerId="500150" lastModified="1350152321184" id="973705" custId="0" creationTime="1350152321184">
                    <groupBy>srcMACAddr,user,destIpAddr,eventType</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>RepeatExcessWLANLoginFailure</name>
                    <singleConstraint>eventType = "PH_RULE_EXCESS_FAILED_LOGON_WIRELESS"</singleConstraint>
                </eventFilters>
                <name>Repeated Multiple Logon Failures: WLAN</name>
                <triggerWindow>86400</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973705</eventFilters>
                <incidentAttrs>
        srcMACAddr = RepeatExcessWLANLoginFailure.srcMACAddr, destIpAddr = RepeatExcessWLANLoginFailure.destIpAddr, incidentCount = RepeatExcessWLANLoginFailure.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_EXCESS_FAILED_LOGON_WIRELESS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_51A" entityVersion="1" xmlId="Rule$PH_Rule_Access_51A" ownerId="500150" lastModified="1350152321256" id="973578" custId="0" creationTime="1350152321256">
                <activatedTime>1350152321256</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects account lockout caused by excessive logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973706" ownerId="500150" lastModified="1350152321256" id="973706" custId="0" creationTime="1350152321256">
                    <groupBy>reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DomainAcctLockout</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DomainAccountLocked) AND reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)</singleConstraint>
                </eventFilters>
                <name>Domain Account Lockout</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973706</eventFilters>
                <incidentAttrs>
        destIpAddr = DomainAcctLockout.reptDevIpAddr, user = DomainAcctLockout.user, incidentCount = DomainAcctLockout.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCOUNT_LOCKOUT_DOMAIN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_51B" entityVersion="1" xmlId="Rule$PH_Rule_Access_51B" ownerId="500150" lastModified="1350152321329" id="973579" custId="0" creationTime="1350152321328">
                <activatedTime>1350152321328</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects account lockout caused by excessive logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973707" ownerId="500150" lastModified="1350152321328" id="973707" custId="0" creationTime="1350152321328">
                    <groupBy>srcIpAddr,reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>NetDevAcctLockout</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostAccountLocked) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Account Lockout</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973707</eventFilters>
                <incidentAttrs>
        srcIpAddr = NetDevAcctLockout.srcIpAddr, destIpAddr = NetDevAcctLockout.reptDevIpAddr, user = NetDevAcctLockout.user, incidentCount = NetDevAcctLockout.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCOUNT_LOCKOUT_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_51C" entityVersion="1" xmlId="Rule$PH_Rule_Access_51C" ownerId="500150" lastModified="1350152321408" id="973580" custId="0" creationTime="1350152321408">
                <activatedTime>1350152321408</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects account lockout caused by excessive logon failures</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973708" ownerId="500150" lastModified="1350152321408" id="973708" custId="0" creationTime="1350152321408">
                    <groupBy>reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>ServerAcctLockout</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostAccountLocked) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server) AND reptDevIpAddr NOT IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)</singleConstraint>
                </eventFilters>
                <name>Server Account Lockout</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973708</eventFilters>
                <incidentAttrs>
        destIpAddr = ServerAcctLockout.reptDevIpAddr, user = ServerAcctLockout.user, incidentCount = ServerAcctLockout.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCOUNT_LOCKOUT_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_52" entityVersion="1" xmlId="Rule$PH_Rule_Access_52" ownerId="500150" lastModified="1350152321482" id="973581" custId="0" creationTime="1350152321481">
                <activatedTime>1350152321481</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects logon attempts to disabled accounts</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973709" ownerId="500150" lastModified="1350152321481" id="973709" custId="0" creationTime="1350152321481">
                    <groupBy>reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>DisabledAcctLogin</name>
                    <singleConstraint>eventType = "Win-Security-531"</singleConstraint>
                </eventFilters>
                <name>Disabled Account Logon Attempt</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973709</eventFilters>
                <incidentAttrs>
        destIpAddr = DisabledAcctLogin.reptDevIpAddr, user = DisabledAcctLogin.user, incidentCount = DisabledAcctLogin.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DISABLED_ACCOUNT_ACCESS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_53" entityVersion="1" xmlId="Rule$PH_Rule_Access_53" ownerId="500150" lastModified="1350152321554" id="973582" custId="0" creationTime="1350152321554">
                <activatedTime>1350152321554</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects logon attempts at times which are not permitted by policy</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973710" ownerId="500150" lastModified="1350152321554" id="973710" custId="0" creationTime="1350152321554">
                    <groupBy>reptDevIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>LoginTimeViolation</name>
                    <singleConstraint>eventType = "Win-Security-530"</singleConstraint>
                </eventFilters>
                <name>Logon Time Restriction Violation</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973710</eventFilters>
                <incidentAttrs>
        destIpAddr = LoginTimeViolation.reptDevIpAddr, user = LoginTimeViolation.user, incidentCount = LoginTimeViolation.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_LOGON_TIME_VIOLATION</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_54" entityVersion="1" xmlId="Rule$PH_Rule_Access_54" ownerId="500150" lastModified="1350152321628" id="973583" custId="0" creationTime="1350152321628">
                <activatedTime>1350152321628</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects the same source having excessive logon failures at distinct hosts</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973711" ownerId="500150" lastModified="1350152321628" id="973711" custId="0" creationTime="1350152321628">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 10</groupConstraint>
                    <index>0</index>
                    <name>PasswordScan_ManyDest</name>
                    <singleConstraint>eventType IN ("PH_RULE_EXCESS_FAILED_LOGON_2_NET_DEVICE","PH_RULE_EXCESS_FAILED_LOGON_SERVER","PH_RULE_EXCESS_FAILED_PRIV_LOGON_SERVER","PH_RULE_EXCESS_FAILED_LOGON_DB", "PH_RULE_REPEAT_EXCESS_FAILED_LOGON_WEB", "PH_RULE_EXCESS_FAILED_LOGON_APPL","PH_RULE_EXCESS_FAILED_LOGON_DOMAIN", "PH_RULE_EXCESS_FAILED_LOGON_VPN", "PH_RULE_EXCESS_FAILED_LOGON_WIRELESS")</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: Same Src, Multiple Hosts</name>
                <triggerWindow>3600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973711</eventFilters>
                <incidentAttrs>
        srcIpAddr = PasswordScan_ManyDest.srcIpAddr, incidentCount = PasswordScan_ManyDest.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_FAILED_LOGON_MULTIPLE_HOSTS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_55" entityVersion="1" xmlId="Rule$PH_Rule_Access_55" ownerId="500150" lastModified="1350152321704" id="973584" custId="0" creationTime="1350152321703">
                <activatedTime>1350152321703</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects same source having excessive login failures at the same destination host but multiple distinct accounts are used during the logon failure</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973712" ownerId="500150" lastModified="1350152321703" id="973712" custId="0" creationTime="1350152321703">
                    <groupBy>srcIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT user) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>PasswordScan_SameDest_ManyAcct</name>
                    <singleConstraint>eventType IN ("PH_RULE_EXCESS_FAILED_LOGON_2_NET_DEVICE","PH_RULE_EXCESS_FAILED_LOGON_SERVER","PH_RULE_EXCESS_FAILED_PRIV_LOGON_SERVER","PH_RULE_EXCESS_FAILED_LOGON_DB", "PH_RULE_REPEAT_EXCESS_FAILED_LOGON_WEB", "PH_RULE_EXCESS_FAILED_LOGON_APPL","PH_RULE_EXCESS_FAILED_LOGON_DOMAIN", "PH_RULE_EXCESS_FAILED_LOGON_VPN","PH_RULE_EXCESS_FAILED_LOGON_WIRELESS")</singleConstraint>
                </eventFilters>
                <name>Multiple Logon Failures: Same Src and Dest, Multiple Accounts</name>
                <triggerWindow>3600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973712</eventFilters>
                <incidentAttrs>
        srcIpAddr = PasswordScan_SameDest_ManyAcct.srcIpAddr, destIpAddr = PasswordScan_SameDest_ManyAcct.destIpAddr, incidentCount = PasswordScan_SameDest_ManyAcct.COUNT (DISTINCT user)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_FAILED_LOGON_MULTIPLE_ACCOUNTS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_56" entityVersion="1" xmlId="Rule$PH_Rule_Access_56" ownerId="500150" lastModified="1350152321776" id="973585" custId="0" creationTime="1350152321775">
                <activatedTime>1350152321775</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects an unusual condition where a source has authentication failures at a host but that is not followed by a successful authentication at the same host within 2 hours</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973713" ownerId="500150" lastModified="1350152321775" id="973713" custId="0" creationTime="1350152321775">
                    <groupBy>srcIpAddr,destIpAddr,user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>FailedLogin</name>
                    <singleConstraint>eventType IN ("PH_RULE_EXCESS_FAILED_LOGON_NET_DEVICE","PH_RULE_EXCESS_FAILED_LOGON_SERVER","PH_RULE_EXCESS_FAILED_PRIV_LOGON_SERVER","PH_RULE_EXCESS_FAILED_LOGON_DB", "PH_RULE_REPEAT_EXCESS_FAILED_LOGON_WEB", "PH_RULE_EXCESS_FAILED_LOGON_APPL","PH_RULE_EXCESS_FAILED_LOGON_DOMAIN", "PH_RULE_EXCESS_FAILED_LOGON_VPN","PH_RULE_EXCESS_FAILED_LOGON_WIRELESS")</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973714" ownerId="500150" lastModified="1350152321775" id="973714" custId="0" creationTime="1350152321775">
                    <groupBy>srcIpAddr,reptDevIpAddr,user</groupBy>
                    <index>1</index>
                    <name>SuccessLogin</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HostLogonSuccess, Group@PH_SYS_EVENT_HostPrivLogonSuccess, Group@PH_SYS_EVENT_DomainLogonSuccess, Group@PH_SYS_EVENT_VPNLogonSuccess, Group@PH_SYS_EVENT_WirelessLogonSuccess, Group@PH_SYS_EVENT_AppLogonSuccess)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>FailedLogin.destIpAddr = SuccessLogin.reptDevIpAddr, FailedLogin.srcIpAddr = SuccessLogin.srcIpAddr, FailedLogin.user = SuccessLogin.user   </globalConstraint>
                <name>Suspicious Logon Failure: no following successful login</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>7200</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973713</eventFilters>
                <eventFilters>EventFilter@973714</eventFilters>
                <incidentAttrs>
        srcIpAddr = FailedLogin.srcIpAddr, destIpAddr = FailedLogin.destIpAddr, user = FailedLogin.user
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SUSPICIOUS_FAILED_LOGON_NO_SUCCESS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,destIpAddr,user,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_57" entityVersion="1" xmlId="Rule$PH_Rule_Access_57" ownerId="500150" lastModified="1350152321852" id="973586" custId="0" creationTime="1350152321851">
                <activatedTime>1350152321852</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects VPN logon from outside my country. My Country is set to "United States" and may need to be changed for outside United States deployments</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973715" ownerId="500150" lastModified="1350152321852" id="973715" custId="0" creationTime="1350152321852">
                    <groupBy>srcIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>VPNLoginOutside</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_VPNLogonSuccess, Group@PH_SYS_EVENT_VPNLogoff) AND srcGeoCountry != "United States" AND eventType NOT IN ("ASA-713049-SiteToSite-VPN-Logon-success")</singleConstraint>
                </eventFilters>
                <name>Successful VPN Logon from outside my country</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973715</eventFilters>
                <incidentAttrs>
        srcIpAddr = VPNLoginOutside.srcIpAddr, user = VPNLoginOutside.user
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VPN_LOGON_SUCCESS_OUTSIDE_COUNTRY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Access_58" entityVersion="1" xmlId="Rule$PH_Rule_Access_58" ownerId="500150" lastModified="1350152321927" id="973587" custId="0" creationTime="1350152321926">
                <activatedTime>1350152321926</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects VPN logon from outside my country. My Country is set to "United States" and may need to be changed for outside United States deployments</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973716" ownerId="500150" lastModified="1350152321926" id="973716" custId="0" creationTime="1350152321926">
                    <groupBy>srcIpAddr, user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>VPNLoginOutside</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_VPNLogonFailure) AND srcGeoCountry != "United States"</singleConstraint>
                </eventFilters>
                <name>Failed VPN Logon from outside my country</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973716</eventFilters>
                <incidentAttrs>
        srcIpAddr = VPNLoginOutside.srcIpAddr, user = VPNLoginOutside.user
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VPN_FAILED_LOGON_OUTSIDE_COUNTRY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,srcIpAddr,user,computer,winLogonType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_1" entityVersion="1" xmlId="Rule$PH_Rule_Change_1" ownerId="500150" lastModified="1350152322984" id="973588" custId="0" creationTime="1350152322984">
                <activatedTime>1350152322984</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the startup and running configurations of a network device (router or firewall) are different. This is achieved via logging in.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973717" ownerId="500150" lastModified="1350152322984" id="973717" custId="0" creationTime="1350152322984">
                    <groupBy>hostIpAddr, hostName, addedItem, deletedItem</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>StartupRunDelta</name>
                    <singleConstraint>hostIpAddr IN (Group@PH_SYS_DEVICE_ROUTER_SWITCH,Group@PH_SYS_DEVICE_FIREWALL) AND eventType = "PH_DEV_MON_DELTA_CONFIG"</singleConstraint>
                </eventFilters>
                <name>Difference in Running and Startup Config</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973717</eventFilters>
                <incidentAttrs>
        hostIpAddr = StartupRunDelta.hostIpAddr, hostName = StartupRunDelta.hostName, addedItem = StartupRunDelta.addedItem, deletedItem = StartupRunDelta.deletedItem
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_DIFF_STARTUP_RUNNING_CONFIG</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,eventType,startUpConfVer,runningConfVer,addedItem, deletedItem </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_2" entityVersion="1" xmlId="Rule$PH_Rule_Change_2" ownerId="500150" lastModified="1350152323055" id="973589" custId="0" creationTime="1350152323054">
                <activatedTime>1350152323055</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last change and requires the network devices to forward syslog to the monitoring system.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973718" ownerId="500150" lastModified="1350152323054" id="973718" custId="0" creationTime="1350152323054">
                    <groupBy>reptDevIpAddr ,srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>login</name>
                    <singleConstraint>eventType = "IOS-SYS-CONFIG_I"  OR  eventType = "ASA-605005" OR eventType = "Foundry-Ironware-Startup-Config-Change"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973719" ownerId="500150" lastModified="1350152323054" id="973719" custId="0" creationTime="1350152323054">
                    <groupBy>hostIpAddr ,hostName ,addedItem ,deletedItem</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "PH_DEV_MON_CHANGE_STARTUP_CONFIG"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>login.reptDevIpAddr = delta.hostIpAddr</globalConstraint>
                <name>Startup Config Change (with login info)</name>
                <rawFOString>FOLLOWED_BY:0</rawFOString>
                <triggerWindow>1800</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973718</eventFilters>
                <eventFilters>EventFilter@973719</eventFilters>
                <incidentAttrs>srcIpAddr = login.srcIpAddr, hostIpAddr = delta.hostIpAddr, hostName = delta.hostName, addedItem = delta.addedItem, deletedItem = delta.deletedItem</incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHANGE_STARTUP_CONFIG_LOGIN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,eventType,srcIpAddr,oldSVNVersion,newSVNVersion,addedItem, deletedItem </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3" entityVersion="1" xmlId="Rule$PH_Rule_Change_3" ownerId="500150" lastModified="1350152323126" id="973590" custId="0" creationTime="1350152323125">
                <activatedTime>1350152323126</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects user/group configuration in a domain controller. This rule would trigger on all changes made by any person. To prevent false positives, a restriction on the user attribute should be made by excluding the domain administrators.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973720" ownerId="500150" lastModified="1350152323125" id="973720" custId="0" creationTime="1350152323125">
                    <groupBy>reptDevIpAddr,user,computer,domain,targetUser,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)  AND  eventType IN ( Group@PH_SYS_EVENT_AccountChanged)</singleConstraint>
                </eventFilters>
                <name>Domain Controller User/Group Modification</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973720</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHANGE_DC_USER_GRP</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3B" entityVersion="1" xmlId="Rule$PH_Rule_Change_3B" ownerId="500150" lastModified="1350152323197" id="973591" custId="0" creationTime="1350152323196">
                <activatedTime>1350152323197</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users added to domain admin group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973721" ownerId="500150" lastModified="1350152323196" id="973721" custId="0" creationTime="1350152323196">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = "Domain Admins"</singleConstraint>
                </eventFilters>
                <name>User added to Domain Admin Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973721</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ADD_DOMAIN_ADMIN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3C" entityVersion="1" xmlId="Rule$PH_Rule_Change_3C" ownerId="500150" lastModified="1350152323267" id="973592" custId="0" creationTime="1350152323267">
                <activatedTime>1350152323267</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users deleted from domain admin group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973722" ownerId="500150" lastModified="1350152323267" id="973722" custId="0" creationTime="1350152323267">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = "Domain Admins"</singleConstraint>
                </eventFilters>
                <name>User deleted from Domain Admin Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973722</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DELETE_DOMAIN_ADMIN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3D" entityVersion="1" xmlId="Rule$PH_Rule_Change_3D" ownerId="500150" lastModified="1350152323338" id="973593" custId="0" creationTime="1350152323337">
                <activatedTime>1350152323337</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users added to remote desktop user group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973723" ownerId="500150" lastModified="1350152323337" id="973723" custId="0" creationTime="1350152323337">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = "Remote Desktop Users"</singleConstraint>
                </eventFilters>
                <name>User added to Remote Desktop User Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973723</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ADD_REMOTE_DESKTOP_USER</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3E" entityVersion="1" xmlId="Rule$PH_Rule_Change_3E" ownerId="500150" lastModified="1350152323411" id="973594" custId="0" creationTime="1350152323411">
                <activatedTime>1350152323411</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users deleted from remote desktop user group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973724" ownerId="500150" lastModified="1350152323411" id="973724" custId="0" creationTime="1350152323411">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = "Remote Desktop Users"</singleConstraint>
                </eventFilters>
                <name>User deleted from Remote Desktop User Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973724</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DELETE_REMOTE_DESKTOP_USER</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3F" entityVersion="1" xmlId="Rule$PH_Rule_Change_3F" ownerId="500150" lastModified="1350152323482" id="973595" custId="0" creationTime="1350152323482">
                <activatedTime>1350152323482</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users added to administrator group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973725" ownerId="500150" lastModified="1350152323482" id="973725" custId="0" creationTime="1350152323482">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = "Administrators"</singleConstraint>
                </eventFilters>
                <name>User added to Administrator Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973725</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ADD_WIN_ADMINISTRATOR</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3G" entityVersion="1" xmlId="Rule$PH_Rule_Change_3G" ownerId="500150" lastModified="1350152323554" id="973596" custId="0" creationTime="1350152323553">
                <activatedTime>1350152323553</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users deleted from administrator group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973726" ownerId="500150" lastModified="1350152323553" id="973726" custId="0" creationTime="1350152323553">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = "Administrator"</singleConstraint>
                </eventFilters>
                <name>User deleted from Administrator Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973726</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DELETE_WIN_ADMINISTRATOR</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3H" entityVersion="1" xmlId="Rule$PH_Rule_Change_3H" ownerId="500150" lastModified="1350152323625" id="973597" custId="0" creationTime="1350152323624">
                <activatedTime>1350152323624</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users added to backup operator group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973727" ownerId="500150" lastModified="1350152323624" id="973727" custId="0" creationTime="1350152323624">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = "Backup Operators"</singleConstraint>
                </eventFilters>
                <name>User added to Backup Operator Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973727</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ADD_BACKUP_OPERATOR</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3I" entityVersion="1" xmlId="Rule$PH_Rule_Change_3I" ownerId="500150" lastModified="1350152323697" id="973598" custId="0" creationTime="1350152323696">
                <activatedTime>1350152323697</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users deleted from backup operator group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973728" ownerId="500150" lastModified="1350152323697" id="973728" custId="0" creationTime="1350152323697">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = "Backup Operators"</singleConstraint>
                </eventFilters>
                <name>User deleted from Backup Operator Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973728</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DELETE_BACKUP_OPERATOR</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3J" entityVersion="1" xmlId="Rule$PH_Rule_Change_3J" ownerId="500150" lastModified="1350152323768" id="973599" custId="0" creationTime="1350152323768">
                <activatedTime>1350152323768</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users added to DNS Admin group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973729" ownerId="500150" lastModified="1350152323768" id="973729" custId="0" creationTime="1350152323768">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberAdded) AND targetUserGrp = "DnsAdmins"</singleConstraint>
                </eventFilters>
                <name>User added to DNS Admin Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973729</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ADD_DNS_ADMIN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_3K" entityVersion="1" xmlId="Rule$PH_Rule_Change_3K" ownerId="500150" lastModified="1350152323840" id="973750" custId="0" creationTime="1350152323840">
                <activatedTime>1350152323840</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects users deleted from backup operator group</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973730" ownerId="500150" lastModified="1350152323840" id="973730" custId="0" creationTime="1350152323840">
                    <groupBy>user,computer,domain,targetUser,targetUserGrp,targetDomain</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DCUserGrpChange</name>
                    <singleConstraint>reptDevIpAddr IN (Group@PH_SYS_APP_DOMAIN_CONTROLLER)  AND eventType IN (Group@PH_SYS_EVENT_GroupMemberRemoved) AND targetUserGrp = "DnsAdmins"</singleConstraint>
                </eventFilters>
                <name>User deleted from DNS Admins Group</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973730</eventFilters>
                <incidentAttrs>
        user = DCUserGrpChange.user, computer = DCUserGrpChange.computer, domain = DCUserGrpChange.domain, targetUser = DCUserGrpChange.targetUser, targetDomain = DCUserGrpChange.targetDomain,targetUserGrp = DCUserGrpChange.targetUserGrp
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DELETE_DNS_ADMIN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,user,computer,domain,targetUser,targetDomain,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_4" entityVersion="1" xmlId="Rule$PH_Rule_Change_4" ownerId="500150" lastModified="1350152323911" id="973751" custId="0" creationTime="1350152323910">
                <activatedTime>1350152323911</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last change and requires the network device to forward syslog messages to the monitoring system.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973731" ownerId="500150" lastModified="1350152323911" id="973731" custId="0" creationTime="1350152323911">
                    <groupBy>reptDevIpAddr ,srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>login</name>
                    <singleConstraint>eventType = "IOS-SYS-CONFIG_I"  OR  eventType = "ASA-605005" OR eventType = "Foundry-Ironware-Running-Config-Change"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973732" ownerId="500150" lastModified="1350152323911" id="973732" custId="0" creationTime="1350152323911">
                    <groupBy>hostIpAddr ,hostName ,addedItem ,deletedItem</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "PH_DEV_MON_CHANGE_RUN_CONFIG"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>login.reptDevIpAddr = delta.hostIpAddr</globalConstraint>
                <name>Running Config Change (with login info)</name>
                <rawFOString>FOLLOWED_BY:0</rawFOString>
                <triggerWindow>1800</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973731</eventFilters>
                <eventFilters>EventFilter@973732</eventFilters>
                <incidentAttrs>srcIpAddr = login.srcIpAddr, hostIpAddr = delta.hostIpAddr, hostName = delta.hostName, addedItem = delta.addedItem, deletedItem = delta.deletedItem</incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHANGE_RUN_CONFIG_LOGIN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,eventType,srcIpAddr,oldSVNVersion,newSVNVersion,addedItem, deletedItem </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_5" entityVersion="1" xmlId="Rule$PH_Rule_Change_5" ownerId="500150" lastModified="1350152323982" id="973752" custId="0" creationTime="1350152323982">
                <activatedTime>1350152323982</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the configuration of a network device (router or firewall) has changed. This is achieved via logging in and keeping track of the last change</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973733" ownerId="500150" lastModified="1350152323982" id="973733" custId="0" creationTime="1350152323982">
                    <groupBy>hostIpAddr ,hostName ,addedItem ,deletedItem</groupBy>
                    <groupConstraint>COUNT ( * )&gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "PH_DEV_MON_CHANGE_STARTUP_CONFIG"</singleConstraint>
                </eventFilters>
                <name>Startup Config Change</name>
                <triggerWindow>1800</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973733</eventFilters>
                <incidentAttrs>hostIpAddr = delta.hostIpAddr, hostName = delta.hostName, addedItem = delta.addedItem, deletedItem = delta.deletedItem</incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHANGE_STARTUP_CONFIG</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,eventType,oldSVNVersion,newSVNVersion,addedItem, deletedItem </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_6" entityVersion="1" xmlId="Rule$PH_Rule_Change_6" ownerId="500150" lastModified="1350152324054" id="973753" custId="0" creationTime="1350152324054">
                <activatedTime>1350152324054</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the configuration of a network device (router or firewall) has changed.  This is achieved via logging in and keeping track of the last change</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973734" ownerId="500150" lastModified="1350152324054" id="973734" custId="0" creationTime="1350152324054">
                    <groupBy>hostIpAddr ,hostName ,addedItem ,deletedItem</groupBy>
                    <groupConstraint>COUNT ( * )&gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "PH_DEV_MON_CHANGE_RUN_CONFIG"</singleConstraint>
                </eventFilters>
                <name>Running Config Change</name>
                <triggerWindow>1800</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973734</eventFilters>
                <incidentAttrs>hostIpAddr = delta.hostIpAddr, hostName = delta.hostName, addedItem = delta.addedItem, deletedItem = delta.deletedItem</incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHANGE_RUN_CONFIG</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,eventType,oldSVNVersion,newSVNVersion,addedItem, deletedItem </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_7" entityVersion="1" xmlId="Rule$PH_Rule_Change_7" ownerId="500150" lastModified="1350152324127" id="973754" custId="0" creationTime="1350152324126">
                <activatedTime>1350152324127</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a new software has been installed on a server or an existing software has been deleted.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973735" ownerId="500150" lastModified="1350152324126" id="973735" custId="0" creationTime="1350152324126">
                    <groupBy>hostIpAddr,hostName,addedItem ,deletedItem</groupBy>
                    <groupConstraint>COUNT ( * )&gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "PH_DEV_MON_CHANGE_INST_SW"</singleConstraint>
                </eventFilters>
                <name>Server Installed Software Change</name>
                <triggerWindow>1800</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973735</eventFilters>
                <incidentAttrs>hostIpAddr = delta.hostIpAddr, hostName = delta.hostName, addedItem = delta.addedItem, deletedItem = delta.deletedItem</incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_CHANGE_INST_SW</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,eventType,oldSVNVersion,newSVNVersion,addedItem, deletedItem </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_8" entityVersion="1" xmlId="Rule$PH_Rule_Change_8" ownerId="500150" lastModified="1350152324199" id="973755" custId="0" creationTime="1350152324198">
                <activatedTime>1350152324198</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a user modified either the content or the attributes of a file or directory</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973736" ownerId="500150" lastModified="1350152324198" id="973736" custId="0" creationTime="1350152324198">
                    <groupBy>reptDevIpAddr,user,osObjType,osObjAction,osObjName,targetOsObjType,targetOsObjName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>FileChange</name>
                    <singleConstraint>eventType = "LINUX_FILE_CHANGE"</singleConstraint>
                </eventFilters>
                <name>Linux file change</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973736</eventFilters>
                <incidentAttrs>
        hostIpAddr = FileChange.reptDevIpAddr, user = FileChange.user, osObjType = FileChange.osObjType, osObjAction = FileChange.osObjAction, osObjName = FileChange.osObjName, targetOsObjType =FileChange.targetOsObjType, targetOsObjName = FileChange.targetOsObjName 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_LINUX_FILE_CHANGE</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,user,osObjType,osObjAction,osObjName,targetOsObjType,targetOsObjName</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_9" entityVersion="1" xmlId="Rule$PH_Rule_Change_9" ownerId="500150" lastModified="1350152324271" id="973756" custId="0" creationTime="1350152324270">
                <activatedTime>1350152324270</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a user failed to modify either the content or the attributes of a file or directory</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973737" ownerId="500150" lastModified="1350152324270" id="973737" custId="0" creationTime="1350152324270">
                    <groupBy>user,domain,osObjName,reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>FileAccessFailure</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_FileChange)  AND  reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND  eventAction = 1 AND user NOT CONTAIN "$"</singleConstraint>
                </eventFilters>
                <name>Windows failed file access</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973737</eventFilters>
                <incidentAttrs>
        reptDevIpAddr = FileAccessFailure.reptDevIpAddr, user = FileAccessFailure.user, domain = FileAccessFailure.domain, osObjName = FileAccessFailure.osObjName 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_WINDOWS_FAILED_FILE_ACCESS</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,user,domain,osObjType,osObjAction,osObjName,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_10" entityVersion="1" xmlId="Rule$PH_Rule_Change_10" ownerId="500150" lastModified="1350152324343" id="973757" custId="0" creationTime="1350152324342">
                <activatedTime>1350152324342</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a user successfully modified either the content or the attributes of a file or directory</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973738" ownerId="500150" lastModified="1350152324342" id="973738" custId="0" creationTime="1350152324342">
                    <groupBy>user,domain,osObjName,reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>FileAccessSuccess</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_FileChange)  AND  reptDevIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER) AND  eventAction = 0 AND user NOT CONTAIN "$"</singleConstraint>
                </eventFilters>
                <name>Windows successful file access</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973738</eventFilters>
                <incidentAttrs>
        reptDevIpAddr = FileAccessSuccess.reptDevIpAddr, user = FileAccessSuccess.user, domain = FileAccessSuccess.domain, osObjName = FileAccessSuccess.osObjName 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_WINDOWS_SUCCESS_FILE_ACCESS</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,user,domain,osObjType,osObjAction,osObjName,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_11" entityVersion="1" xmlId="Rule$PH_Rule_Change_11" ownerId="500150" lastModified="1350152324415" id="973758" custId="0" creationTime="1350152324414">
                <activatedTime>1350152324414</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that an user successfully installed a policy on a Checkpoint Firewall</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973739" ownerId="500150" lastModified="1350152324414" id="973739" custId="0" creationTime="1350152324414">
                    <groupBy>reptDevIpAddr,user,srcName,policyName</groupBy>
                    <groupConstraint>COUNT ( * )&gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "CheckPoint-InstallPolicy-Success" AND eventAction = 0</singleConstraint>
                </eventFilters>
                <name>Successful Checkpoint Firewall Policy Install</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973739</eventFilters>
                <incidentAttrs>destIpAddr = delta.reptDevIpAddr, srcName = delta.srcName, user = delta.user, policyName = delta.policyName </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHKP_FW_INSTALL_SUCCESS</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventAction,user,srcName,policyName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Change_12" entityVersion="1" xmlId="Rule$PH_Rule_Change_12" ownerId="500150" lastModified="1350152324489" id="973759" custId="0" creationTime="1350152324488">
                <activatedTime>1350152324489</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that an user failed to install a policy on a Checkpoint Firewall</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973740" ownerId="500150" lastModified="1350152324489" id="973740" custId="0" creationTime="1350152324489">
                    <groupBy>reptDevIpAddr,user,srcName,policyName</groupBy>
                    <groupConstraint>COUNT ( * )&gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>delta</name>
                    <singleConstraint>eventType = "CheckPoint-InstallPolicy-Success" AND eventAction = 1</singleConstraint>
                </eventFilters>
                <name>Failed Checkpoint Firewall Policy Install</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973740</eventFilters>
                <incidentAttrs>destIpAddr = delta.reptDevIpAddr, srcName = delta.srcName, user = delta.user, policyName = delta.policyName </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CHKP_FW_INSTALL_FAILURE</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventAction,user,srcName,policyName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Excessive_ICMP_Unreachables" entityVersion="1" xmlId="Rule$PH_Rule_Excessive_ICMP_Unreachables" ownerId="500150" lastModified="1350152325012" id="973760" custId="0" creationTime="1350152325011">
                <activatedTime>1350152325011</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects an usually high frequency of ICMP destination unreachable packets between the same source and destination - this indicates routing error</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973741" ownerId="500150" lastModified="1350152325011" id="973741" custId="0" creationTime="1350152325011">
                    <groupBy>srcIpAddr, destIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 10</groupConstraint>
                    <index>0</index>
                    <name>ExcessICMPUnreach</name>
                    <singleConstraint>ipProto = 1 AND icmpType = 3 AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic,Group@PH_SYS_EVENT_DenyTraffic) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Excessive ICMP Unreachables</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973741</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessICMPUnreach.srcIpAddr, destIpAddr =ExcessICMPUnreach.destIpAddr   
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ICMP_UNREACH_SAME_HOSTS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,icmpType,icmpCode,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_No_Response_To_Ping_Net" entityVersion="1" xmlId="Rule$PH_Rule_No_Response_To_Ping_Net" ownerId="500150" lastModified="1350152325086" id="973761" custId="0" creationTime="1350152325086">
                <activatedTime>1350152325086</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a device does not respond to ping - 10 out of 10 ping packets are lost - either the host is down or there is a routing problem</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973742" ownerId="500150" lastModified="1350152325086" id="973742" custId="0" creationTime="1350152325086">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>AVG(pktLossPct) = 100 AND COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AllPingLossNet</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PING_STAT" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Down - no ping response</name>
                <triggerWindow>60</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973742</eventFilters>
                <incidentAttrs>
        hostIpAddr = AllPingLossNet.hostIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NON_RESPONSIVE_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,pktLossPct,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Degraded_Ping_Net" entityVersion="1" xmlId="Rule$PH_Rule_Degraded_Ping_Net" ownerId="500150" lastModified="1350152325158" id="973762" custId="0" creationTime="1350152325158">
                <activatedTime>1350152325158</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a host with degraded ping response - more than 50% packet loss and more than 100 ms avg response time</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973744" ownerId="500150" lastModified="1350152325158" id="973744" custId="0" creationTime="1350152325158">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>AVG(pktLossPct) &gt;= 50 AND AVG(pktLossPct) &lt; 100 AND COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>PartPingLossNet</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PING_STAT" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Degraded - Lossy Ping Response</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973744</eventFilters>
                <incidentAttrs>
        hostIpAddr = PartPingLossNet.hostIpAddr,pktLossPct=PartPingLossNet.AVG(pktLossPct))
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_DEGRADED_PING_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,avgDurationMSec,minDurationMSec,pktLossPct,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_No_Response_To_Ping_Server" entityVersion="1" xmlId="Rule$PH_Rule_No_Response_To_Ping_Server" ownerId="500150" lastModified="1350152325231" id="973763" custId="0" creationTime="1350152325230">
                <activatedTime>1350152325231</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a device does not respond to ping - 10 out of 10 ping packets are lost - either the host is down or there is a routing problem</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973746" ownerId="500150" lastModified="1350152325230" id="973746" custId="0" creationTime="1350152325230">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>AVG(pktLossPct) = 100 AND COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AllPingLossSrv</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PING_STAT" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Down - No Ping Response</name>
                <triggerWindow>60</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973746</eventFilters>
                <incidentAttrs>
        hostIpAddr = AllPingLossSrv.hostIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NON_RESPONSIVE_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,pktLossPct,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Degraded_Ping_Server" entityVersion="1" xmlId="Rule$PH_Rule_Degraded_Ping_Server" ownerId="500150" lastModified="1350152325303" id="973764" custId="0" creationTime="1350152325302">
                <activatedTime>1350152325303</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a host with degraded ping response - more than 50% packet loss and more than 100 ms avg response time</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973748" ownerId="500150" lastModified="1350152325302" id="973748" custId="0" creationTime="1350152325302">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>(AVG(pktLossPct) &gt;= 50) AND AVG(pktLossPct) &lt; 100 AND COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>PartPingLossSrv</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PING_STAT" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Degraded - Lossy Ping Response</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973748</eventFilters>
                <incidentAttrs>
        hostIpAddr = PartPingLossSrv.hostIpAddr,pktLossPct=PartPingLossSrv.AVG(pktLossPct)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_DEGRADED_PING_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,avgDurationMSec,minDurationMSec,pktLossPct,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_10" entityVersion="1" xmlId="Rule$PH_Rule_Avail_10" ownerId="500150" lastModified="1350152325377" id="973765" custId="0" creationTime="1350152325376">
                <activatedTime>1350152325377</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a non-critical interface of a network device is staying down - that is didn't come up within 5 minutes of going down</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973850" ownerId="500150" lastModified="1350152325377" id="973850" custId="0" creationTime="1350152325377">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>IntfDownNetDev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = "No"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973851" ownerId="500150" lastModified="1350152325377" id="973851" custId="0" creationTime="1350152325377">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>IntfUpNetDev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = "No"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>IntfDownNetDev.hostIpAddr = IntfUpNetDev.hostIpAddr, IntfDownNetDev.intfName = IntfUpNetDev.intfName 
       </globalConstraint>
                <name>Non-critical Network Device Interface Staying Down</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973850</eventFilters>
                <eventFilters>EventFilter@973851</eventFilters>
                <incidentAttrs>
        hostIpAddr = IntfDownNetDev.hostIpAddr,intfName = IntfDownNetDev.intfName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DOWN_INTF_NET_NONCRIT</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,intfName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_11" entityVersion="1" xmlId="Rule$PH_Rule_Avail_11" ownerId="500150" lastModified="1350152325451" id="973766" custId="0" creationTime="1350152325451">
                <activatedTime>1350152325451</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network interface of a server stays down - that is didn't come up within 5 minutes of going down</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973854" ownerId="500150" lastModified="1350152325451" id="973854" custId="0" creationTime="1350152325451">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <index>0</index>
                    <name>IntfDownSrv</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973855" ownerId="500150" lastModified="1350152325451" id="973855" custId="0" creationTime="1350152325451">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <index>1</index>
                    <name>IntfUpSrv</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>IntfDownSrv.hostIpAddr = IntfUpSrv.hostIpAddr, IntfDownSrv.intfName = IntfUpSrv.intfName 
       </globalConstraint>
                <name>Server Network Interface Staying Down</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973854</eventFilters>
                <eventFilters>EventFilter@973855</eventFilters>
                <incidentAttrs>
        hostIpAddr = IntfDownSrv.hostIpAddr, intfName = IntfDownSrv.intfName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DOWN_INTF_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,intfName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_12" entityVersion="1" xmlId="Rule$PH_Rule_Avail_12" ownerId="500150" lastModified="1350152325522" id="973767" custId="0" creationTime="1350152325521">
                <activatedTime>1350152325521</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network interface of a network device is flapping - that is, coming up and down more than 3 times in 15 minutes. This may indicate hardware issues.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973856" ownerId="500150" lastModified="1350152325521" id="973856" custId="0" creationTime="1350152325521">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>IntfDownNetDev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973857" ownerId="500150" lastModified="1350152325521" id="973857" custId="0" creationTime="1350152325521">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 3</groupConstraint>
                    <index>1</index>
                    <name>IntfUpNetDev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>AND</type>
                </filterOperators>
                <globalConstraint>IntfDownNetDev.hostIpAddr = IntfUpNetDev.hostIpAddr, IntfDownNetDev.intfName = IntfUpNetDev.intfName 
       </globalConstraint>
                <name>Network Device Interface Flapping</name>
                <rawFOString>AND:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973856</eventFilters>
                <eventFilters>EventFilter@973857</eventFilters>
                <incidentAttrs>
        hostIpAddr = IntfDownNetDev.hostIpAddr, intfName = IntfDownNetDev.intfName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INTF_FLAP_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,intfName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_13" entityVersion="1" xmlId="Rule$PH_Rule_Avail_13" ownerId="500150" lastModified="1350152325593" id="973768" custId="0" creationTime="1350152325592">
                <activatedTime>1350152325592</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a network interface of a server is flapping - that is, coming up and down more than 3 times in 15 minutes. This may indicate hardware issues.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973858" ownerId="500150" lastModified="1350152325592" id="973858" custId="0" creationTime="1350152325592">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>IntfDownSrv</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973859" ownerId="500150" lastModified="1350152325592" id="973859" custId="0" creationTime="1350152325592">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 3</groupConstraint>
                    <index>1</index>
                    <name>IntfUpSrv</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>AND</type>
                </filterOperators>
                <globalConstraint>IntfDownSrv.hostIpAddr = IntfUpSrv.hostIpAddr, IntfDownSrv.intfName = IntfUpSrv.intfName 
       </globalConstraint>
                <name>Server Network Interface Flapping</name>
                <rawFOString>AND:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973858</eventFilters>
                <eventFilters>EventFilter@973859</eventFilters>
                <incidentAttrs>
        hostIpAddr = IntfDownSrv.hostIpAddr, intfName = IntfDownSrv.intfName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INTF_FLAP_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,intfName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_14" entityVersion="1" xmlId="Rule$PH_Rule_Avail_14" ownerId="500150" lastModified="1350152325667" id="973769" custId="0" creationTime="1350152325667">
                <activatedTime>1350152325667</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects half/Full duplex mismatch on an network interface. This indicates configuration issues.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973860" ownerId="500150" lastModified="1350152325667" id="973860" custId="0" creationTime="1350152325667">
                    <groupBy>reptDevIpAddr,srcIntfName,destName,destIntfName</groupBy>
                    <groupConstraint>COUNT(*) &gt; 5</groupConstraint>
                    <index>0</index>
                    <name>IntfDuplexMismatch</name>
                    <singleConstraint>eventType = "IOS-CDP-DUPLEX_MISMATCH" AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Interface Duplex Mismatch</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973860</eventFilters>
                <incidentAttrs>
        srcIpAddr = IntfDuplexMismatch.reptDevIpAddr,srcIntfName = IntfDuplexMismatch.srcIntfName,destName = IntfDuplexMismatch.destName,destIntfName = IntfDuplexMismatch.destIntfName	
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INTF_DUPLEX_MISMATCH</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIntfName,destName,destIntfName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_No_Service_Response" entityVersion="1" xmlId="Rule$PH_Rule_No_Service_Response" ownerId="500150" lastModified="1350152325739" id="973770" custId="0" creationTime="1350152325738">
                <activatedTime>1350152325738</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a service suddenly went down from up state and is no longer responding to synthetic transaction monitoring probes.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973861" ownerId="500150" lastModified="1350152325738" id="973861" custId="0" creationTime="1350152325738">
                    <groupBy>hostName,hostIpAddr,appPort,endUserMonitorName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>AppDown</name>
                    <singleConstraint>eventType = "PH_DEV_MON_EUM_FAIL"</singleConstraint>
                </eventFilters>
                <name>Service Down - No Response to STM</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973861</eventFilters>
                <incidentAttrs>
        hostName=AppDown.hostName,hostIpAddr=AppDown.hostIpAddr,appPort=AppDown.appPort,endUserMonitorName=AppDown.endUserMonitorName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NON_RESPONSIVE_SERVICE</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostName,hostIpAddr,appGroupName,appPort,endUserMonitorName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_15" entityVersion="1" xmlId="Rule$PH_Rule_Avail_15" ownerId="500150" lastModified="1350152325814" id="973771" custId="0" creationTime="1350152325814">
                <activatedTime>1350152325814</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that an important server process staying down - that is didn't come up within 5 minutes of going down</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973863" ownerId="500150" lastModified="1350152325814" id="973863" custId="0" creationTime="1350152325814">
                    <groupBy>hostIpAddr,appName,swProcName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AppDownSrv</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_STOP" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973864" ownerId="500150" lastModified="1350152325814" id="973864" custId="0" creationTime="1350152325814">
                    <groupBy>hostIpAddr,appName,swProcName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>AppUpSrv</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_START" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>AppDownSrv.hostIpAddr = AppUpSrv.hostIpAddr, AppDownSrv.appName = AppUpSrv.appName 
       </globalConstraint>
                <name>Important Process Staying Down</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973863</eventFilters>
                <eventFilters>EventFilter@973864</eventFilters>
                <incidentAttrs>
        hostIpAddr = AppDownSrv.hostIpAddr, appName = AppDownSrv.appName, swProcName = AppDownSrv.swProcName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_IMPORTANT_APP_STAY_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,hostName,appName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_15B" entityVersion="1" xmlId="Rule$PH_Rule_Avail_15B" ownerId="500150" lastModified="1350152325887" id="973772" custId="0" creationTime="1350152325886">
                <activatedTime>1350152325886</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that an important server process stopped</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973865" ownerId="500150" lastModified="1350152325886" id="973865" custId="0" creationTime="1350152325886">
                    <groupBy>hostIpAddr,appName,swProcName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AppDownSrv</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_STOP" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Important Process Stopped</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973865</eventFilters>
                <incidentAttrs>
        hostIpAddr = AppDownSrv.hostIpAddr, appName = AppDownSrv.appName, swProcName = AppDownSrv.swProcName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_IMPORTANT_APP_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,hostName,appName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_15C" entityVersion="1" xmlId="Rule$PH_Rule_Avail_15C" ownerId="500150" lastModified="1350152325962" id="973773" custId="0" creationTime="1350152325961">
                <activatedTime>1350152325961</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that an automatically running service stopped. Currently this works for windows servers and is detected via WMI.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973867" ownerId="500150" lastModified="1350152325961" id="973867" custId="0" creationTime="1350152325961">
                    <groupBy>hostIpAddr,hostName,serviceName,servicePath</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>SrvcDown</name>
                    <singleConstraint>eventType = "PH_DEV_MON_AUTO_SVC_START_TO_STOP"</singleConstraint>
                </eventFilters>
                <name>Auto Service Stopped</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973867</eventFilters>
                <incidentAttrs>
        hostIpAddr = SrvcDown.hostIpAddr, hostName = SrvcDown.hostName, serviceName = SrvcDown.serviceName, servicePath = SrvcDown.servicePath
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_AUTO_SRVC_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,hostIpAddr,hostName,serviceName,servicePath,serviceDesc </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Cont_No_Service_Response" entityVersion="0" xmlId="Rule$PH_Rule_Cont_No_Service_Response" ownerId="500150" lastModified="1350152326090" id="973774" custId="0" creationTime="1350152326090">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects a service staying down - that is went from up to down and did not come up and is no longer responding to end user monitoring probes.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973869" ownerId="500150" lastModified="1350152326090" id="973869" custId="0" creationTime="1350152326090">
                    <groupBy>hostName,hostIpAddr,appPort,endUserMonitorName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AppDown</name>
                    <singleConstraint>eventType = "PH_DEV_MON_EUM_FAIL"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973870" ownerId="500150" lastModified="1350152326090" id="973870" custId="0" creationTime="1350152326090">
                    <groupBy>hostName,hostIpAddr,appPort,endUserMonitorName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>AppStillDown</name>
                    <singleConstraint>eventType = "PH_DEV_MON_EUM_SUCCESS"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>
	 AppStillDown.hostName = AppDown.hostName, AppStillDown.hostIpAddr = AppDown.hostIpAddr, AppStillDown.appPort = AppDown.appPort, AppStillDown.endUserMonitorName = AppDown.endUserMonitorName
       </globalConstraint>
                <name>Service Staying Down - No Response to STM</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973869</eventFilters>
                <eventFilters>EventFilter@973870</eventFilters>
                <incidentAttrs>
        hostName=AppDown.hostName,hostIpAddr=AppDown.hostIpAddr,appPort=AppDown.appPort,endUserMonitorName=AppDown.endUserMonitorName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NON_RESPONSIVE_SERVICE_CONTINUE</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostName,hostIpAddr,appGroupName,appPort,endUserMonitorName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Degraded_Service_Response" entityVersion="1" xmlId="Rule$PH_Rule_Degraded_Service_Response" ownerId="500150" lastModified="1350152326163" id="973775" custId="0" creationTime="1350152326163">
                <activatedTime>1350152326163</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the response time of a end user monitored service is greater than a defined threshold (average over 3 samples in 15 minutes is more than 5 seconds)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973871" ownerId="500150" lastModified="1350152326163" id="973871" custId="0" creationTime="1350152326163">
                    <groupBy>hostName,hostIpAddr,appPort,endUserMonitorName,endUserMonitorStep</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 3 AND (AVG(appResponseTimeMSec) &gt; 5000)</groupConstraint>
                    <index>0</index>
                    <name>ResponseHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_EUM_SUCCESS"</singleConstraint>
                </eventFilters>
                <name>Service Degraded - Slow Response to STM</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973871</eventFilters>
                <incidentAttrs>
        hostName=ResponseHigh.hostName,hostIpAddr=ResponseHigh.hostIpAddr,appPort=ResponseHigh.appPort,endUserMonitorName=ResponseHigh.endUserMonitorName,endUserMonitorStep=ResponseHigh.endUserMonitorStep,appResponseTimeMSec=ResponseHigh.AVG(appResponseTimeMSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DEGRADED_SERVICE</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostName,hostIpAddr,appGroupName,appName,endUserMonitorName,endUserMonitorStep,appResponseTimeMSec </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_21" entityVersion="1" xmlId="Rule$PH_Rule_Avail_21" ownerId="500150" lastModified="1350152326236" id="973776" custId="0" creationTime="1350152326235">
                <activatedTime>1350152326235</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a network device hardware issue that is of warning criticality.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973872" ownerId="500150" lastModified="1350152326235" id="973872" custId="0" creationTime="1350152326235">
                    <groupBy>hostName,hostIpAddr,hwComponentName,hwComponentStatus</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueWarn</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = "MEDIUM" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Hardware Warning</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973872</eventFilters>
                <incidentAttrs>
        hostName=HwIssueWarn.hostName,hostIpAddr=HwIssueWarn.hostIpAddr,hwComponentName=HwIssueWarn.hwComponentName,hwComponentStatus = HwIssueWarn.hwComponentStatus
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_NET_HW_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,hwComponentName,hwComponentStatus,hwFailReason,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_22" entityVersion="1" xmlId="Rule$PH_Rule_Avail_22" ownerId="500150" lastModified="1350152326308" id="973777" custId="0" creationTime="1350152326308">
                <activatedTime>1350152326308</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a critical network device hardware alert.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973873" ownerId="500150" lastModified="1350152326308" id="973873" custId="0" creationTime="1350152326308">
                    <groupBy>hostName,hostIpAddr,hwComponentName,hwComponentStatus</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueCrit</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = "HIGH" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Hardware Critical</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973873</eventFilters>
                <incidentAttrs>
        hostName=HwIssueCrit.hostName,hostIpAddr=HwIssueCrit.hostIpAddr,hwComponentName=HwIssueCrit.hwComponentName,hwComponentStatus = HwIssueCrit.hwComponentStatus
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NET_HW_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,hwComponentName,hwComponentStatus,hwFailReason,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_23" entityVersion="1" xmlId="Rule$PH_Rule_Avail_23" ownerId="500150" lastModified="1350152326381" id="973778" custId="0" creationTime="1350152326380">
                <activatedTime>1350152326380</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a server hardware issue that is of warning criticality.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973874" ownerId="500150" lastModified="1350152326380" id="973874" custId="0" creationTime="1350152326380">
                    <groupBy>hostName,hostIpAddr,hwComponentName,hwComponentStatus</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueWarn</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = "MEDIUM" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Hardware Warning</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973874</eventFilters>
                <incidentAttrs>
        hostName=HwIssueWarn.hostName,hostIpAddr=HwIssueWarn.hostIpAddr,hwComponentName=HwIssueWarn.hwComponentName,hwComponentStatus = HwIssueWarn.hwComponentStatus
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_HW_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,hwComponentName,hwComponentStatus,hwFailReason,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_24" entityVersion="1" xmlId="Rule$PH_Rule_Avail_24" ownerId="500150" lastModified="1350152326454" id="973779" custId="0" creationTime="1350152326453">
                <activatedTime>1350152326453</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a critical server hardware alert.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973875" ownerId="500150" lastModified="1350152326453" id="973875" custId="0" creationTime="1350152326453">
                    <groupBy>hostName,hostIpAddr,hwComponentName,hwComponentStatus</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueCrit</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = "HIGH" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Server Hardware Critical</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973875</eventFilters>
                <incidentAttrs>
        hostName=HwIssueCrit.hostName,hostIpAddr=HwIssueCrit.hostIpAddr,hwComponentName=HwIssueCrit.hwComponentName,hwComponentStatus = HwIssueCrit.hwComponentStatus
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SERVER_HW_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,hwComponentName,hwComponentStatus,hwFailReason,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_25" entityVersion="1" xmlId="Rule$PH_Rule_Avail_25" ownerId="500150" lastModified="1350152326532" id="973780" custId="0" creationTime="1350152326531">
                <activatedTime>1350152326532</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a low TCP/UDP port on a server staying down - that is, went from up to down and did not come up in 10 min</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973876" ownerId="500150" lastModified="1350152326532" id="973876" custId="0" creationTime="1350152326532">
                    <groupBy>hostName,hostIpAddr,serviceName,ipProto,ipPort</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>PortDown</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PORT_CLOSE" AND ipPort &lt;= 1024 AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973877" ownerId="500150" lastModified="1350152326532" id="973877" custId="0" creationTime="1350152326532">
                    <groupBy>hostName,hostIpAddr,serviceName,ipProto,ipPort</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>PortStillDown</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PORT_OPEN" AND ipPort &lt;= 1024 AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>
	 PortStillDown.hostName = PortDown.hostName, PortStillDown.hostIpAddr = PortDown.hostIpAddr, PortStillDown.serviceName = PortDown.serviceName, PortStillDown.ipPort = PortDown.ipPort, PortStillDown.ipProto = PortDown.ipProto
       </globalConstraint>
                <name>Server Network Low Port Staying Down</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973876</eventFilters>
                <eventFilters>EventFilter@973877</eventFilters>
                <incidentAttrs>
        hostName=PortDown.hostName,hostIpAddr=PortDown.hostIpAddr,serviceName=PortDown.serviceName,ipPort=PortDown.ipPort,ipProto=PortDown.ipProto
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETWORK_PORT_STAY_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostName,hostIpAddr,serviceName,ipProto,ipPort,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_31" entityVersion="1" xmlId="Rule$PH_Rule_Avail_31" ownerId="500150" lastModified="1350152326607" id="973781" custId="0" creationTime="1350152326606">
                <activatedTime>1350152326606</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a BGP neighbor is down</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973878" ownerId="500150" lastModified="1350152326606" id="973878" custId="0" creationTime="1350152326606">
                    <groupBy>reptDevIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>BGPDown</name>
                    <singleConstraint>eventType = "IOS-BGP-ADJCHANGE-TO-DOWN"</singleConstraint>
                </eventFilters>
                <name>BGP Neighbor Down</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973878</eventFilters>
                <incidentAttrs>
        srcIpAddr = BGPDown.reptDevIpAddr,destIpAddr = BGPDown.destIpAddr 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_BGP_NBR_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,srcASNum,destASNum,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_32" entityVersion="1" xmlId="Rule$PH_Rule_Avail_32" ownerId="500150" lastModified="1350152326687" id="973782" custId="0" creationTime="1350152326686">
                <activatedTime>1350152326686</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a OSPF neighbor is down</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973880" ownerId="500150" lastModified="1350152326686" id="973880" custId="0" creationTime="1350152326686">
                    <groupBy>reptDevIpAddr,destIpAddr,srcIntfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>OSPFDown</name>
                    <singleConstraint>eventType = "IOS-OSPF-ADJCHG-TO-DOWN"</singleConstraint>
                </eventFilters>
                <name>OSPF Neighbor Down</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973880</eventFilters>
                <incidentAttrs>
        srcIpAddr = OSPFDown.reptDevIpAddr,srcIntfName = OSPFDown.srcIntfName,destIpAddr = OSPFDown.destIpAddr 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_OSPF_NBR_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,ospfAreaId,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_33" entityVersion="1" xmlId="Rule$PH_Rule_Avail_33" ownerId="500150" lastModified="1350152326763" id="973783" custId="0" creationTime="1350152326762">
                <activatedTime>1350152326762</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a storage hardware issue that is of warning criticality.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973882" ownerId="500150" lastModified="1350152326762" id="973882" custId="0" creationTime="1350152326762">
                    <groupBy>hostName,hostIpAddr,hwComponentName,hwComponentStatus</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueWarn</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = "MEDIUM" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage)</singleConstraint>
                </eventFilters>
                <name>Storage Hardware Warning</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973882</eventFilters>
                <incidentAttrs>
        hostName=HwIssueWarn.hostName,hostIpAddr=HwIssueWarn.hostIpAddr,hwComponentName=HwIssueWarn.hwComponentName,hwComponentStatus = HwIssueWarn.hwComponentStatus
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STORAGE_HW_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,hwComponentName,hwComponentStatus,hwFailReason,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_34" entityVersion="1" xmlId="Rule$PH_Rule_Avail_34" ownerId="500150" lastModified="1350152326837" id="973784" custId="0" creationTime="1350152326836">
                <activatedTime>1350152326836</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a critical storage hardware alert.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973883" ownerId="500150" lastModified="1350152326836" id="973883" custId="0" creationTime="1350152326836">
                    <groupBy>hostName,hostIpAddr,hwComponentName,hwComponentStatus</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueCrit</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_HwProblem) AND eventSeverityCat = "HIGH" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Storage)</singleConstraint>
                </eventFilters>
                <name>Storage Hardware Critical</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973883</eventFilters>
                <incidentAttrs>
        hostName=HwIssueCrit.hostName,hostIpAddr=HwIssueCrit.hostIpAddr,hwComponentName=HwIssueCrit.hwComponentName,hwComponentStatus = HwIssueCrit.hwComponentStatus
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STORAGE_HW_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,hwComponentName,hwComponentStatus,hwFailReason,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Storage" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_35" entityVersion="1" xmlId="Rule$PH_Rule_Avail_35" ownerId="500150" lastModified="1350152326911" id="973785" custId="0" creationTime="1350152326911">
                <activatedTime>1350152326911</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a host has logged in but not registered</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973884" ownerId="500150" lastModified="1350152326911" id="973884" custId="0" creationTime="1350152326911">
                    <groupBy>srcName,srcIpAddr,srcWWN,destName,spPortName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>UnregHost</name>
                    <singleConstraint>eventType = "PH_RULE_CLARION_UNREG_HOST"</singleConstraint>
                </eventFilters>
                <name>Unregistered EMC Clariion Host</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973884</eventFilters>
                <incidentAttrs>
        srcName=UnregHost.srcName,srcIpAddr=UnregHost.srcIpAddr,srcWWN=UnregHost.srcWWN,destName=UnregHost.destName,spPortName=UnregHost.spPortName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STORAGE_CLARION_UNREG_HOST</incidentType>
                <triggerEventAttrList> phRecvTime,srcName,srcIpAddr,srcWWN,destName,spPortName,destIpAddr,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="System" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_36" entityVersion="1" xmlId="Rule$PH_Rule_Avail_36" ownerId="500150" lastModified="1350152326986" id="973786" custId="0" creationTime="1350152326985">
                <activatedTime>1350152326985</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that SNMP service is unavailable</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973885" ownerId="500150" lastModified="1350152326985" id="973885" custId="0" creationTime="1350152326985">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>SnmpDown</name>
                    <singleConstraint>eventType = "PH_JOB_STAT" AND jobName = "SNMP_PING_STATUS" AND (jobStatus = 1 OR jobStatus = 2) AND phEventCategory = 3</singleConstraint>
                </eventFilters>
                <name>SNMP Service Unavailable</name>
                <triggerWindow>240</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973885</eventFilters>
                <incidentAttrs>
        hostIpAddr = SnmpDown.hostIpAddr, hostName = SnmpDown.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SNMP_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,hostName,eventType,jobName,jobType,jobStatus,jobDetail,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="System" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_37" entityVersion="1" xmlId="Rule$PH_Rule_Avail_37" ownerId="500150" lastModified="1350152327064" id="973787" custId="0" creationTime="1350152327063">
                <activatedTime>1350152327063</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that WMI service is unavailable</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973887" ownerId="500150" lastModified="1350152327063" id="973887" custId="0" creationTime="1350152327063">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>WmiDown</name>
                    <singleConstraint>eventType = "PH_JOB_STAT" AND jobName = "WMI_PING_STATUS" AND (jobStatus = 1 OR jobStatus = 2) AND phEventCategory = 3</singleConstraint>
                </eventFilters>
                <name>WMI Service Unavailable</name>
                <triggerWindow>240</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973887</eventFilters>
                <incidentAttrs>
        hostIpAddr = WmiDown.hostIpAddr, hostName = WmiDown.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_WMI_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,hostName,eventType,jobName,jobType,jobStatus,jobDetail,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_38" entityVersion="1" xmlId="Rule$PH_Rule_Avail_38" ownerId="500150" lastModified="1350152327142" id="973788" custId="0" creationTime="1350152327141">
                <activatedTime>1350152327141</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects windows disk controller issues</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973889" ownerId="500150" lastModified="1350152327141" id="973889" custId="0" creationTime="1350152327141">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>WinDiskControl</name>
                    <singleConstraint>eventType IN ("Win-System-11","Win-System-51","Win-System-57") AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>Windows Disk controller problem</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973889</eventFilters>
                <incidentAttrs>
        reptDevIpAddr = WinDiskControl.reptDevIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_WIN_DISK_CONTROLLLER_PROBLEM</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,eventSource,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_39" entityVersion="1" xmlId="Rule$PH_Rule_Avail_39" ownerId="500150" lastModified="1350152327220" id="973789" custId="0" creationTime="1350152327219">
                <activatedTime>1350152327219</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a EIGRP neighbor is down</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973890" ownerId="500150" lastModified="1350152327219" id="973890" custId="0" creationTime="1350152327219">
                    <groupBy>reptDevIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>EIGRPDown</name>
                    <singleConstraint>eventType = "IOS-EIGRP-NBRCHANGE_DUAL-TO-DOWN"</singleConstraint>
                </eventFilters>
                <name>EIGRP Neighbor Down</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973890</eventFilters>
                <incidentAttrs>srcIpAddr = EIGRPDown.reptDevIpAddr,destIpAddr = EIGRPDown.destIpAddr</incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EIGRP_NBR_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_40" entityVersion="1" xmlId="Rule$PH_Rule_Avail_40" ownerId="500150" lastModified="1350152327298" id="973790" custId="0" creationTime="1350152327297">
                <activatedTime>1350152327297</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a critical network interface of a network device is staying down - that is didn't come up within 5 minutes of going down. An interface is critical if it appears in Critical Interface list in GUI</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973892" ownerId="500150" lastModified="1350152327297" id="973892" custId="0" creationTime="1350152327297">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>IntfDownNetDev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfShutdown) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = "Yes"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@973893" ownerId="500150" lastModified="1350152327297" id="973893" custId="0" creationTime="1350152327297">
                    <groupBy>hostIpAddr,intfName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>IntfUpNetDev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_NetIntfRestart) AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network) AND isHostIntfCritical = "Yes"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>NOT_FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>IntfDownNetDev.hostIpAddr = IntfUpNetDev.hostIpAddr, IntfDownNetDev.intfName = IntfUpNetDev.intfName 
       </globalConstraint>
                <name>Critical Network Device Interface Staying Down</name>
                <rawFOString>NOT_FOLLOWED_BY:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973892</eventFilters>
                <eventFilters>EventFilter@973893</eventFilters>
                <incidentAttrs>
        hostIpAddr = IntfDownNetDev.hostIpAddr,intfName = IntfDownNetDev.intfName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DOWN_INTF_NET_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,hostIpAddr,intfName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_41" entityVersion="1" xmlId="Rule$PH_Rule_Avail_41" ownerId="500150" lastModified="1350152327381" id="973791" custId="0" creationTime="1350152327380">
                <activatedTime>1350152327380</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects Riverbed system health degraded</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973896" ownerId="500150" lastModified="1350152327380" id="973896" custId="0" creationTime="1350152327380">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_STAT" AND systemStatus IN ("Degraded","Admission Control")</singleConstraint>
                </eventFilters>
                <name>Riverbed Steelhead System Health Degraded</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973896</eventFilters>
                <incidentAttrs>
        hostName=HwIssueWarn.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RVBD_SYS_HEALTH_WARN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,systemStatus,svcStatus,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_42" entityVersion="1" xmlId="Rule$PH_Rule_Avail_42" ownerId="500150" lastModified="1350152327461" id="973792" custId="0" creationTime="1350152327460">
                <activatedTime>1350152327460</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects Riverbed system health degraded</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973897" ownerId="500150" lastModified="1350152327460" id="973897" custId="0" creationTime="1350152327460">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_STAT" AND systemStatus = "Critical"</singleConstraint>
                </eventFilters>
                <name>Riverbed Steelhead System Health Critical</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973897</eventFilters>
                <incidentAttrs>
        hostName=HwIssueWarn.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RVBD_SYS_HEALTH_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,systemStatus,svcStatus,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_43" entityVersion="1" xmlId="Rule$PH_Rule_Avail_43" ownerId="500150" lastModified="1350152327540" id="973793" custId="0" creationTime="1350152327539">
                <activatedTime>1350152327539</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects Riverbed service health degraded</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973898" ownerId="500150" lastModified="1350152327539" id="973898" custId="0" creationTime="1350152327539">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>HwIssueWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_STAT" AND svcStatus = "Stopped"</singleConstraint>
                </eventFilters>
                <name>Riverbed Steelhead Service Health Critical</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973898</eventFilters>
                <incidentAttrs>
        hostName=HwIssueWarn.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RVBD_SVC_HEALTH_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,hwStatusCode,systemStatus,svcStatus,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Vuln_1" entityVersion="1" xmlId="Rule$PH_Rule_Vuln_1" ownerId="500150" lastModified="1350152328051" id="973794" custId="0" creationTime="1350152328051">
                <activatedTime>1350152328051</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a high severity vulnerability reported by a vulnerability scanner</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973899" ownerId="500150" lastModified="1350152328051" id="973899" custId="0" creationTime="1350152328051">
                    <groupBy>hostName,vulnName</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>ScannerHighSev</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_Vulnerability) AND reptVendor IN ("Qualys", "Nessus", "nCircle") AND eventSeverity &gt;= 8</singleConstraint>
                </eventFilters>
                <name>Scanner found severe vulnerability</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973899</eventFilters>
                <incidentAttrs>
        hostName = ScannerHighSev.hostName, vulnName = ScannerHighSev.vulnName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_SEV_SCANNER</incidentType>
                <triggerEventAttrList> scanEnd,reptVendor,hostName,osType,vulnName,eventSeverity,vulnType,vulnCVEId,vulnBugTraqID,vulnScore,vulnConseq,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Vuln_2" entityVersion="1" xmlId="Rule$PH_Rule_Vuln_2" ownerId="500150" lastModified="1350152328122" id="973795" custId="0" creationTime="1350152328122">
                <activatedTime>1350152328122</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that host anti-virus or content inspection devices found a virus but could not rremediate it</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973900" ownerId="500150" lastModified="1350152328122" id="973900" custId="0" creationTime="1350152328122">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>VirusFound</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_Worm_Remedy_Failed) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW)</singleConstraint>
                </eventFilters>
                <name>Virus found but not remediated</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973900</eventFilters>
                <incidentAttrs>
        hostIpAddr = VirusFound.hostIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VIRUS_NON_REMEDY</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,virusName,virusType,fileName,virusAction,virusQuarantStatus,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Vuln_3" entityVersion="1" xmlId="Rule$PH_Rule_Vuln_3" ownerId="500150" lastModified="1350152328192" id="973796" custId="0" creationTime="1350152328191">
                <activatedTime>1350152328192</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that host anti-virus or content inspection devices found a Spam/Malicious Mail Attachment but could not rremediate it. The sender is sending to 5 or more distinct receiver mail addresses</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973901" ownerId="500150" lastModified="1350152328192" id="973901" custId="0" creationTime="1350152328192">
                    <groupBy>hostIpAddr,senderMailAddr</groupBy>
                    <groupConstraint>COUNT(DISTINCT receiverMailAddr) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>AttachFound</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_MailMalware_Found)</singleConstraint>
                </eventFilters>
                <name>Spam/Malicious Mail Attachment found but not remediated</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973901</eventFilters>
                <incidentAttrs>
        srcIpAddr = AttachFound.hostIpAddr, senderMailAddr = AttachFound.senderMailAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_MAILATTACH_NON_REMEDY</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,srcIpAddr,senderMailAddr,receiverMailAddr,mailSubject,vendor,spamScore,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Vuln_4" entityVersion="1" xmlId="Rule$PH_Rule_Vuln_4" ownerId="500150" lastModified="1350152328262" id="973797" custId="0" creationTime="1350152328262">
                <activatedTime>1350152328262</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that host anti-virus or content inspection devices found a spyware but could not remediate it</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973902" ownerId="500150" lastModified="1350152328262" id="973902" custId="0" creationTime="1350152328262">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>SpywareFound</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_Spyware_Remedy_Failed) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW)</singleConstraint>
                </eventFilters>
                <name>Spyware found but not remediated</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973902</eventFilters>
                <incidentAttrs>
        hostIpAddr = SpywareFound.hostIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SPYWARE_NON_REMEDY</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,fileName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Other" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Vuln_5" entityVersion="1" xmlId="Rule$PH_Rule_Vuln_5" ownerId="500150" lastModified="1350152328333" id="973798" custId="0" creationTime="1350152328332">
                <activatedTime>1350152328332</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects potential virus outbreak - same virus found on three distinct computers/IP addresses</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973903" ownerId="500150" lastModified="1350152328332" id="973903" custId="0" creationTime="1350152328332">
                    <groupBy>virusName</groupBy>
                    <groupConstraint>COUNT(DISTINCT computer) &gt;= 3 OR COUNT(DISTINCT hostIpAddr) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>VirusOutbreak</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_Worm_Found) AND reptDevIpAddr IN (Group@PH_SYS_APP_SEC_MGMT,Group@PH_SYS_DEVICE_SEC_GW)</singleConstraint>
                </eventFilters>
                <name>Virus outbreak</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973903</eventFilters>
                <incidentAttrs>
        virusName = VirusOutbreak.virusName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_VIRUS_OUTBREAK</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,eventType,hostIpAddr,computer,user,virusName,virusType,fileName,virusAction,virusQuarantStatus,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_VoIP_1" entityVersion="1" xmlId="Rule$PH_Rule_VoIP_1" ownerId="500150" lastModified="1350152329059" id="973799" custId="0" creationTime="1350152329059">
                <activatedTime>1350152329059</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects degraded voip call quality (mos score between 2.2 and 3.5)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973904" ownerId="500150" lastModified="1350152329059" id="973904" custId="0" creationTime="1350152329059">
                    <groupBy>srcName,destName,ipSLAProto,codec</groupBy>
                    <groupConstraint>AVG(mosScore) &gt; 2.2 AND AVG(mosScore) &lt;= 3.5 AND COUNT (*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>MediumCallQuality</name>
                    <singleConstraint>eventType = "PH_DEV_MON_IPSLA_VOIP_MET"</singleConstraint>
                </eventFilters>
                <name>Degraded VoIP Call Quality</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973904</eventFilters>
                <incidentAttrs>
        srcName = MediumCallQuality.srcName, destName = MediumCallQuality.destName, ipSLAProto= MediumCallQuality.ipSLAProto, codec = MediumCallQuality.codec  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DEGRADED_VOIP_MOS</incidentType>
                <triggerEventAttrList> phRecvTime,srcIpAddr,srcName,destIpAddr,destName,ipSLAProto,codec,mosScore,icpifScore,avgDurationMSec,avgJitterMs,pktLost,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_VoIP_2" entityVersion="1" xmlId="Rule$PH_Rule_VoIP_2" ownerId="500150" lastModified="1350152329132" id="973950" custId="0" creationTime="1350152329132">
                <activatedTime>1350152329132</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects poor voip call quality (mos score less than 2.2)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973905" ownerId="500150" lastModified="1350152329132" id="973905" custId="0" creationTime="1350152329132">
                    <groupBy>srcName,destName,ipSLAProto,codec</groupBy>
                    <groupConstraint>AVG(mosScore) &lt;= 2.2 AND COUNT (*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>PoorCallQuality</name>
                    <singleConstraint>eventType = "PH_DEV_MON_IPSLA_VOIP_MET"</singleConstraint>
                </eventFilters>
                <name>Poor VoIP Call Quality</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973905</eventFilters>
                <incidentAttrs>
        srcName = PoorCallQuality.srcName, destName = PoorCallQuality.destName, ipSLAProto= PoorCallQuality.ipSLAProto, codec = PoorCallQuality.codec  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_POOR_VOIP_MOS</incidentType>
                <triggerEventAttrList> phRecvTime,srcIpAddr,srcName,destIpAddr,destName,ipSLAProto,codec,mosScore,icpifScore,avgDurationMSec,avgJitterMs,pktLost,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_1" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_1" ownerId="500150" lastModified="1350152330060" id="973951" custId="0" creationTime="1350152330059">
                <activatedTime>1350152330059</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects the free space of the file system containing the folder /data/eventdb used for storing events is lower than 20GB. Once the free space is lower than 10GB, the system will automatically purge old events until the free space is more than 20GB. If you do not want this automatical purge of old events, please backup old events to a remote location using nfs, cifs or sftp, otherwise, you can disable this rule.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973906" ownerId="500150" lastModified="1350152330059" id="973906" custId="0" creationTime="1350152330059">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOStorageLow</name>
                    <singleConstraint>eventType = "PH_SYSTEM_STORAGE_LOW"</singleConstraint>
                </eventFilters>
                <name>System Warning: Low Available Event Storage Capacity</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973906</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOStorageLow.reptDevIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCELOPS_LOW_STORAGE</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_2" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_2" ownerId="500150" lastModified="1350152330132" id="973952" custId="0" creationTime="1350152330132">
                <activatedTime>1350152330132</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the system is receiving events at a rate that is higher than the license limit. Events beyond the license limit would be dropped unless the license is upgraded.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973907" ownerId="500150" lastModified="1350152330132" id="973907" custId="0" creationTime="1350152330132">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOLicenseExpire</name>
                    <singleConstraint>eventType = "PH_SYSTEM_EVENT_RATE_EXCEED_LICENSE"</singleConstraint>
                </eventFilters>
                <name>System License Warning: High Event Rate</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973907</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOLicenseExpire.reptDevIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCELOPS_HIGH_EPS</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_3" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_3" ownerId="500150" lastModified="1350152330209" id="973953" custId="0" creationTime="1350152330209">
                <activatedTime>1350152330209</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the number of CMDB configuration items is close to the license limit - additonal configuration items would not be stored unless the license is upgraded.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973908" ownerId="500150" lastModified="1350152330209" id="973908" custId="0" creationTime="1350152330209">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 0</groupConstraint>
                    <index>0</index>
                    <name>AOHighCI</name>
                    <singleConstraint>eventType = "PH_AUDIT_CI_QUOTE_EXCEEDED"</singleConstraint>
                </eventFilters>
                <name>System License Warning: High Config Items</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973908</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOHighCI.reptDevIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCELOPS_HIGH_CI</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,customer,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_4" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_4" ownerId="500150" lastModified="1350152330280" id="973954" custId="0" creationTime="1350152330280">
                <activatedTime>1350152330280</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that collector is down.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973909" ownerId="500150" lastModified="1350152330280" id="973909" custId="0" creationTime="1350152330280">
                    <groupBy>customer,phCollectorName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOCollectorDown</name>
                    <singleConstraint>eventType = "PH_COLLECTOR_DOWN"</singleConstraint>
                </eventFilters>
                <name>System Collector Down</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973909</eventFilters>
                <incidentAttrs>
        customer = AOCollectorDown.customer, phCollectorName = AOCollectorDown.phCollectorName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_ACCELOPS_COLLECTOR_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,customer,phCollectorName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_8" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_8" ownerId="500150" lastModified="1350152330353" id="973955" custId="0" creationTime="1350152330353">
                <activatedTime>1350152330353</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the system discovered more devices than what license allows.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973911" ownerId="500150" lastModified="1350152330353" id="973911" custId="0" creationTime="1350152330353">
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOLicenseMaxDevice</name>
                    <singleConstraint>eventType = "PH_MAX_DEVICES_EXCEEDED"</singleConstraint>
                </eventFilters>
                <name>System License Warning: Max Number of Devices Exceeded License</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973911</eventFilters>
                <incidentAttrs></incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCELOPS_MAX_DEVICE_EXCEEDED</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_9" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_9" ownerId="500150" lastModified="1350152330423" id="973956" custId="0" creationTime="1350152330422">
                <activatedTime>1350152330422</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system worker is down.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973912" ownerId="500150" lastModified="1350152330422" id="973912" custId="0" creationTime="1350152330422">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOWorkerDown</name>
                    <singleConstraint>eventType = "PH_WORKER_DOWN"</singleConstraint>
                </eventFilters>
                <name>System Worker Down</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973912</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOWorkerDown.hostIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ACCELOPS_WORKER_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_10" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_10" ownerId="500150" lastModified="1350152330495" id="973957" custId="0" creationTime="1350152330495">
                <activatedTime>1350152330495</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system failed to archive event database files to offline storage</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973914" ownerId="500150" lastModified="1350152330495" id="973914" custId="0" creationTime="1350152330495">
                    <groupBy>phCustId</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOArchiveFailed</name>
                    <singleConstraint>eventType = "PH_SYSTEM_DISK_ARCHIVING_FAILED"</singleConstraint>
                </eventFilters>
                <name>System Archiving Failed</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973914</eventFilters>
                <incidentAttrs>
        phCustId = AOArchiveFailed.phCustId
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_ARCHIVING_FAILED</incidentType>
                <triggerEventAttrList> phRecvTime,phCustId,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_11" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_11" ownerId="500150" lastModified="1350152330567" id="973958" custId="0" creationTime="1350152330566">
                <activatedTime>1350152330566</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system failed to open archive directory. If the problem is not resolved soon, events from online event database will be purged</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973915" ownerId="500150" lastModified="1350152330566" id="973915" custId="0" creationTime="1350152330566">
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOArchiveUnavail</name>
                    <singleConstraint>eventType = "PH_UNABLE_ACCESS_DIR"</singleConstraint>
                </eventFilters>
                <name>System Archive Directory Unavailable</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973915</eventFilters>
                <incidentAttrs></incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_ARCHIVE_UNAVAIL</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_12" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_12" ownerId="500150" lastModified="1350152330637" id="973959" custId="0" creationTime="1350152330637">
                <activatedTime>1350152330637</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system archived event database files to offline storage</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973916" ownerId="500150" lastModified="1350152330637" id="973916" custId="0" creationTime="1350152330637">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(totBytes) &gt; 0</groupConstraint>
                    <index>0</index>
                    <name>AOArchive</name>
                    <singleConstraint>eventType = "PH_SYSTEM_DISK_ARCHIVING_FINISHED" AND totBytes &gt; 0</singleConstraint>
                </eventFilters>
                <name>System EventDB Archiving Completed</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973916</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOArchive.reptDevIpAddr,totBytes = AOArchive.AVG(totBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_EVENTDB_ARCHIVE</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_12B" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_12B" ownerId="500150" lastModified="1350152330709" id="973960" custId="0" creationTime="1350152330708">
                <activatedTime>1350152330708</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system purged event database files to offline storage</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973917" ownerId="500150" lastModified="1350152330708" id="973917" custId="0" creationTime="1350152330708">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(totBytes) &gt; 0</groupConstraint>
                    <index>0</index>
                    <name>AOPurge</name>
                    <singleConstraint>eventType = "PH_SYSTEM_DISK_PURGING_FINISHED" AND totBytes &gt; 0</singleConstraint>
                </eventFilters>
                <name>System EventDB Purge Completed</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973917</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOPurge.reptDevIpAddr,totBytes = AOPurge.AVG(totBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_EVENTDB_PURGE</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_13" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_13" ownerId="500150" lastModified="1350152330780" id="973961" custId="0" creationTime="1350152330779">
                <activatedTime>1350152330779</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system purged archive files since archive space is low. Archive policies may be violated.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973918" ownerId="500150" lastModified="1350152330779" id="973918" custId="0" creationTime="1350152330779">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(totBytes) &gt; 0</groupConstraint>
                    <index>0</index>
                    <name>AOArchivePurge</name>
                    <singleConstraint>eventType = "PH_SYSTEM_ARCHIVE_PURGING_LOW_SPACE_FINISHED" AND totBytes &gt; 0</singleConstraint>
                </eventFilters>
                <name>System Archive Purging Completed - Low Available Space</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973918</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOArchivePurge.reptDevIpAddr,totBytes = AOArchivePurge.AVG(totBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_ARCHIVE_PURGE_LOW_SPACE</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_14" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_14" ownerId="500150" lastModified="1350152330860" id="973962" custId="0" creationTime="1350152330859">
                <activatedTime>1350152330860</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system purged archive files based on archive policy</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973919" ownerId="500150" lastModified="1350152330859" id="973919" custId="0" creationTime="1350152330859">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(totBytes) &gt; 0</groupConstraint>
                    <index>0</index>
                    <name>AOArchivePurge</name>
                    <singleConstraint>eventType = "PH_SYSTEM_ARCHIVE_PURGING_POLICY_FINISHED" AND totBytes &gt; 0</singleConstraint>
                </eventFilters>
                <name>System Archive Purging Completed - Policy Driven</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973919</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOArchivePurge.reptDevIpAddr, totBytes = AOArchivePurge.AVG(totBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_ARCHIVE_PURGE_POLICY</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_15" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_15" ownerId="500150" lastModified="1350152330932" id="973963" custId="0" creationTime="1350152330931">
                <activatedTime>1350152330931</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system failed to purge archive files because of internal errors</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973920" ownerId="500150" lastModified="1350152330931" id="973920" custId="0" creationTime="1350152330931">
                    <groupBy>phCustId</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOArchivePurgeFailed</name>
                    <singleConstraint>eventType IN ("PH_SYSTEM_ARCHIVE_PURGING_POLICY_FAILED","PH_SYSTEM_ARCHIVE_PURGING_LOW_SPACE_FAILED")</singleConstraint>
                </eventFilters>
                <name>System Archive Purging Failed</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973920</eventFilters>
                <incidentAttrs>
        phCustId = AOArchivePurgeFailed.phCustId
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_ARCHIVE_PURGE_FAILED</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_16" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_16" ownerId="500150" lastModified="1350152331003" id="973964" custId="0" creationTime="1350152331003">
                <activatedTime>1350152331003</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a reporting device that reported events (logs etc) in the last hour did not report any events this hour. This does not include monitoring events (like CPU, Memory etc). This indicates that there is a problem in the network or at the reporting device.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973921" ownerId="500150" lastModified="1350152331003" id="973921" custId="0" creationTime="1350152331003">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AONoEvents</name>
                    <singleConstraint>eventType = "PH_SYSTEM_DEVICE_NO_EVENTS"</singleConstraint>
                </eventFilters>
                <name>No Events Reported In Last Hour</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973921</eventFilters>
                <incidentAttrs>
        srcIpAddr = AONoEvents.reptDevIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>true</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_DEVICE_NO_EVENTS</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_16B" entityVersion="0" xmlId="Rule$PH_Rule_Avail_PH_16B" ownerId="500150" lastModified="1350152331081" id="973965" custId="0" creationTime="1350152331081">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the system failed to monitor a performance monitoring metric</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973923" ownerId="500150" lastModified="1350152331081" id="973923" custId="0" creationTime="1350152331081">
                    <groupBy>hostName,hostIpAddr,jobName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOPerfMonErr</name>
                    <singleConstraint>eventType = "PH_JOB_STAT" AND (jobStatus = 1 OR jobStatus = 2) AND phEventCategory = 3</singleConstraint>
                </eventFilters>
                <name>Performance Monitoring Error</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973923</eventFilters>
                <incidentAttrs>
        hostIpAddr = AOPerfMonErr.hostIpAddr,hostName = AOPerfMonErr.hostName,jobName = AOPerfMonErr.jobName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_PERF_MON_ERROR</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,jobName,jobDesc,jobDetail,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_17" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_17" ownerId="500150" lastModified="1350152331155" id="973966" custId="0" creationTime="1350152331154">
                <activatedTime>1350152331155</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that low (less than 20GB) available archive space - purging is going to start soon</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973925" ownerId="500150" lastModified="1350152331155" id="973925" custId="0" creationTime="1350152331155">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AOArchiveLow</name>
                    <singleConstraint>eventType = "PH_SYSTEM_ARCHIVE_LOW"</singleConstraint>
                </eventFilters>
                <name>Low Available System Archive Space</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973925</eventFilters>
                <incidentAttrs>
          hostIpAddr = AOArchiveLow.reptDevIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_ARCHIVE_LOW_SPACE</incidentType>
                <triggerEventAttrList> phRecvTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_18" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_18" ownerId="500150" lastModified="1350152331227" id="973967" custId="0" creationTime="1350152331226">
                <activatedTime>1350152331226</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system has failed to take notification action on an incident</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973926" ownerId="500150" lastModified="1350152331226" id="973926" custId="0" creationTime="1350152331226">
                    <groupBy>phCustId,actionName,policyId,ruleName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AONotifyErr</name>
                    <singleConstraint>eventType = "PH_INCIDENT_ACTION_STATUS" AND actionResult = "Failed"</singleConstraint>
                </eventFilters>
                <name>Incident Notification Error</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973926</eventFilters>
                <incidentAttrs>
         phCustId = AONotifyErr.phCustId,
	 actionName = AONotifyErr.actionName,
	 policyId = AONotifyErr.policyId,
	 ruleName = AONotifyErr.ruleName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_INCIDENT_NOTIF_ERROR</incidentType>
                <triggerEventAttrList> phRecvTime,actionName,policyId,ruleName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_18B" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_18B" ownerId="500150" lastModified="1350152331299" id="973968" custId="0" creationTime="1350152331299">
                <activatedTime>1350152331299</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that system has failed to deliver a scheduled report</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973927" ownerId="500150" lastModified="1350152331299" id="973927" custId="0" creationTime="1350152331299">
                    <groupBy>phCustId,reportName,actionName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AONotifyErr</name>
                    <singleConstraint>eventType = "PH_REPORT_ACTION_STATUS" AND actionResult = "Failed"</singleConstraint>
                </eventFilters>
                <name>Scheduled Report Send Error</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973927</eventFilters>
                <incidentAttrs>
         phCustId = AONotifyErr.phCustId,
	 reportName = AONotifyErr.reportName,
	 actionName = AONotifyErr.actionName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_REPORT_NOTIF_ERROR</incidentType>
                <triggerEventAttrList> phRecvTime,reportName,actionName,actionTime,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_19" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_19" ownerId="500150" lastModified="1350152331371" id="973969" custId="0" creationTime="1350152331371">
                <activatedTime>1350152331371</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that Worker input event queue is very large (greater than 100MB). This indicates that the workers are falling behind in handling events and cannot keep pace with the rate at which workers are sending events. Consider ading more workers or adding resources to workers.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973928" ownerId="500150" lastModified="1350152331371" id="973928" custId="0" creationTime="1350152331371">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(totBytes) &gt; 104857600</groupConstraint>
                    <index>0</index>
                    <name>AOLargeEventQueue</name>
                    <singleConstraint>eventType = "PH_EVT_HANDLER_EVT_QUEUE_WARNING"</singleConstraint>
                </eventFilters>
                <name>Large Worker Input Event Queue</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973928</eventFilters>
                <incidentAttrs>
         hostName = AOLargeEventQueue.hostName,
	 totBytes = AOLargeEventQueue.AVG(totBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_LARGE_WORKER_EVENT_QUEUE</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_20" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_20" ownerId="500150" lastModified="1350152331446" id="973970" custId="0" creationTime="1350152331446">
                <activatedTime>1350152331446</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that Worker input SVN queue is very large (greater than 100MB). This indicates that the workers are falling behind in handling SVN files from collectors or from the parser modules. Check the SVN installation.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973929" ownerId="500150" lastModified="1350152331446" id="973929" custId="0" creationTime="1350152331446">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(totBytes) &gt; 104857600</groupConstraint>
                    <index>0</index>
                    <name>AOLargeSVNQueue</name>
                    <singleConstraint>eventType = "PH_EVT_HANDLER_SVN_QUEUE_WARNING"</singleConstraint>
                </eventFilters>
                <name>Large Worker Input SVN Queue</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973929</eventFilters>
                <incidentAttrs>
         hostName = AOLargeSVNQueue.hostName,
	 totBytes = AOLargeSVNQueue.AVG(totBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_LARGE_WORKER_SVN_QUEUE</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_21" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_21" ownerId="500150" lastModified="1350152331519" id="973971" custId="0" creationTime="1350152331518">
                <activatedTime>1350152331518</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that Supervisor JMS Request queue is very large</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973930" ownerId="500150" lastModified="1350152331518" id="973930" custId="0" creationTime="1350152331518">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(jmsQueueSize) &gt; AVG(jmsQueueThreshold)</groupConstraint>
                    <index>0</index>
                    <name>AOLargeJMSRequestQueue</name>
                    <singleConstraint>eventType = "PH_JMS_QUEUE_SIZE_WARNING" AND jmsQueueType = "request"</singleConstraint>
                </eventFilters>
                <name>Large Supervisor JMS Request Queue</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973930</eventFilters>
                <incidentAttrs>
         hostName = AOLargeJMSRequestQueue.hostName,
	 jmsQueueSize = AOLargeJMSRequestQueue.AVG(jmsQueueSize)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_LARGE_JMS_REQUEST_QUEUE</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,jmsQueueType,jmsQueueType,jmsQueueThreshold,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Internal" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Avail_PH_22" entityVersion="1" xmlId="Rule$PH_Rule_Avail_PH_22" ownerId="500150" lastModified="1350152331591" id="973972" custId="0" creationTime="1350152331591">
                <activatedTime>1350152331591</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that Supervisor JMS System queue is very large</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973931" ownerId="500150" lastModified="1350152331591" id="973931" custId="0" creationTime="1350152331591">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(jmsQueueSize) &gt; AVG(jmsQueueThreshold)</groupConstraint>
                    <index>0</index>
                    <name>AOLargeJMSSystemQueue</name>
                    <singleConstraint>eventType = "PH_JMS_QUEUE_SIZE_WARNING" AND jmsQueueType = "system"</singleConstraint>
                </eventFilters>
                <name>Large Supervisor JMS System Queue</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973931</eventFilters>
                <incidentAttrs>
         hostName = AOLargeJMSSystemQueue.hostName,
	 jmsQueueSize = AOLargeJMSSystemQueue.AVG(jmsQueueSize)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SYS_LARGE_JMS_SYSTEM_QUEUE</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,jmsQueueType,jmsQueueSize,jmsQueueThreshold,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_200" entityVersion="1" xmlId="Rule$PH_Rule_Flow_200" ownerId="500150" lastModified="1350152332066" id="973973" custId="0" creationTime="1350152332065">
                <activatedTime>1350152332066</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a host performing a port scan - this involves excessive half open TCP connections from the same source to many distinct ports on a host in a short period of time. The thresholds are at least 20 distinct ports in a 2 minute window</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973932" ownerId="500150" lastModified="1350152332066" id="973932" custId="0" creationTime="1350152332066">
                    <groupBy>srcIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpPort) &gt;= 20</groupConstraint>
                    <index>0</index>
                    <name>Filter1</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND srcDestTCPFlags = 2 AND ipProto = 6 AND srcIpPort &gt;= 1024 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy TCP Port Scan: Single Host</name>
                <triggerWindow>120</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973932</eventFilters>
                <incidentAttrs>
        srcIpAddr = Filter1.srcIpAddr, destIpAddr = Filter1.destIpAddr, incidentCount = Filter1.COUNT (DISTINCT destIpPort)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_TCP_PORT_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_201" entityVersion="1" xmlId="Rule$PH_Rule_Flow_201" ownerId="500150" lastModified="1350152332136" id="973974" custId="0" creationTime="1350152332136">
                <activatedTime>1350152332136</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a source is doing port scans on multiple hosts. The thresholds are port scans on at least 5 hosts in 15 minute window</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973933" ownerId="500150" lastModified="1350152332136" id="973933" custId="0" creationTime="1350152332136">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(DISTINCT destIpAddr) &gt; 30</groupConstraint>
                    <index>0</index>
                    <name>Filter1</name>
                    <singleConstraint>eventType IN ("PH_RULE_HEAVY_TCP_PORT_SCAN")</singleConstraint>
                </eventFilters>
                <name>Heavy TCP Port Scan: Multiple Hosts</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973933</eventFilters>
                <incidentAttrs>
        srcIpAddr = Filter1.srcIpAddr, incidentCount = Filter1.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_HEAVY_TCP_PORT_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_202" entityVersion="1" xmlId="Rule$PH_Rule_Flow_202" ownerId="500150" lastModified="1350152332205" id="973975" custId="0" creationTime="1350152332205">
                <activatedTime>1350152332205</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive UDP connections from the same source to many distinct ports on the same destination in a short period of time</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973934" ownerId="500150" lastModified="1350152332205" id="973934" custId="0" creationTime="1350152332205">
                    <groupBy>srcIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpPort) &gt;= 20</groupConstraint>
                    <index>0</index>
                    <name>Filter1</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 17 AND srcIpPort &gt;= 1024 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy UDP Port Scan: Single Host</name>
                <triggerWindow>120</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973934</eventFilters>
                <incidentAttrs>
        srcIpAddr = Filter1.srcIpAddr, destIpAddr = Filter1.destIpAddr, incidentCount = Filter1.COUNT (DISTINCT destIpPort)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_UDP_PORT_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_203" entityVersion="1" xmlId="Rule$PH_Rule_Flow_203" ownerId="500150" lastModified="1350152332275" id="973976" custId="0" creationTime="1350152332275">
                <activatedTime>1350152332275</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that a source is doing UDP port scans on multiple hosts. The thresholds are port scans on at least 5 hosts in 15 minute window</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973935" ownerId="500150" lastModified="1350152332275" id="973935" custId="0" creationTime="1350152332275">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(DISTINCT destIpAddr) &gt; 30</groupConstraint>
                    <index>0</index>
                    <name>Filter1</name>
                    <singleConstraint>eventType IN ("PH_RULE_HEAVY_UDP_PORT_SCAN")</singleConstraint>
                </eventFilters>
                <name>Heavy UDP Port Scan: Multiple Hosts</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973935</eventFilters>
                <incidentAttrs>
        srcIpAddr = Filter1.srcIpAddr, incidentCount = Filter1.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_REPEAT_HEAVY_UDP_PORT_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_204" entityVersion="1" xmlId="Rule$PH_Rule_Flow_204" ownerId="500150" lastModified="1350152332345" id="973977" custId="0" creationTime="1350152332345">
                <activatedTime>1350152332345</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects unusual ( more than 10 in 3 minutes) ICMP types, namely other than echo request/reply and destination unreachables</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973936" ownerId="500150" lastModified="1350152332345" id="973936" custId="0" creationTime="1350152332345">
                    <groupBy>srcIpAddr,icmpType</groupBy>
                    <groupConstraint>COUNT(*) &gt; 10</groupConstraint>
                    <index>0</index>
                    <name>UnusualIcmp</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 1 AND icmpType NOT IN (0,3,8)</singleConstraint>
                </eventFilters>
                <name>Unusual ICMP Traffic</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973936</eventFilters>
                <incidentAttrs>
        srcIpAddr = UnusualIcmp.srcIpAddr, icmpType = UnusualIcmp.icmpType, incidentCount = UnusualIcmp.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_UNUSUAL_ICMP</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,icmpType,icmpCode</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_205" entityVersion="1" xmlId="Rule$PH_Rule_Flow_205" ownerId="500150" lastModified="1350152332414" id="973978" custId="0" creationTime="1350152332414">
                <activatedTime>1350152332414</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects invalid TCP/UDP traffic with 0 port (more than 10 in 3 minutes)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973937" ownerId="500150" lastModified="1350152332414" id="973937" custId="0" creationTime="1350152332414">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt; 10</groupConstraint>
                    <index>0</index>
                    <name>InvalidTCPUDP</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 17 AND destIpPort = 0</singleConstraint>
                </eventFilters>
                <name>Invalid TCP/UDP Port Traffic</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973937</eventFilters>
                <incidentAttrs>
        srcIpAddr = InvalidTCPUDP.srcIpAddr, incidentCount = InvalidTCPUDP.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INVALID_TCP_UDP_PORT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,icmpType,icmpCode</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_206" entityVersion="1" xmlId="Rule$PH_Rule_Flow_206" ownerId="500150" lastModified="1350152332484" id="973979" custId="0" creationTime="1350152332484">
                <activatedTime>1350152332484</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects 100 or more flows in 5 minutes, with invalid TCP flag combinations (NULL,FIN, SYN-FIN, SYN-FIN-PUSH, SYN-FIN-RESET, SYN-FIN-RESET-PUSH,SYN-FIN-RESET-PUSH-ACK-URG) - may indcate scanning and probing activity from the sender</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973938" ownerId="500150" lastModified="1350152332484" id="973938" custId="0" creationTime="1350152332484">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>InvalidTCPFlag</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 6 AND srcDestTCPFlags IN (1,3,7,11,15,31,63)</singleConstraint>
                </eventFilters>
                <name>Invalid TCP Flags - Medium Intensity</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973938</eventFilters>
                <incidentAttrs>
        srcIpAddr = InvalidTCPFlag.srcIpAddr,incidentCount = InvalidTCPFlag.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INVALID_TCP_FLAG_MEDIUM</incidentType>
                <triggerEventAttrList> phRecvTime,srcIpAddr,destIpAddr,srcIpPort,ipProto,destIpPort,srcDestTCPFlags</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_207" entityVersion="1" xmlId="Rule$PH_Rule_Flow_207" ownerId="500150" lastModified="1350152332554" id="973980" custId="0" creationTime="1350152332554">
                <activatedTime>1350152332554</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects 500 or more flows in 5 minutes, with invalid TCP flag combinations (FIN, SYN-FIN, SYN-FIN-PUSH, SYN-FIN-RESET, SYN-FIN-RESET-PUSH,SYN-FIN-RESET-PUSH-ACK-URG) - may indcate scanning and probing activity from the sender</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973939" ownerId="500150" lastModified="1350152332554" id="973939" custId="0" creationTime="1350152332554">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 500</groupConstraint>
                    <index>0</index>
                    <name>InvalidTCPFlag</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 6 AND srcDestTCPFlags IN (1,3,7,11,15,31,63)</singleConstraint>
                </eventFilters>
                <name>Invalid TCP Flags - High Intensity</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973939</eventFilters>
                <incidentAttrs>
        srcIpAddr = InvalidTCPFlag.srcIpAddr,incidentCount = InvalidTCPFlag.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INVALID_TCP_FLAG_HIGH</incidentType>
                <triggerEventAttrList> phRecvTime,srcIpAddr,destIpAddr,srcIpPort,ipProto,destIpPort,srcDestTCPFlags</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_208" entityVersion="1" xmlId="Rule$PH_Rule_Flow_208" ownerId="500150" lastModified="1350152332629" id="973981" custId="0" creationTime="1350152332629">
                <activatedTime>1350152332629</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive (&gt; 5000 in 5 minutes) ICMP traffic from the same source</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973940" ownerId="500150" lastModified="1350152332629" id="973940" custId="0" creationTime="1350152332629">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt; 5000</groupConstraint>
                    <index>0</index>
                    <name>ExcessIcmp</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 1 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Excessive ICMP Traffic From Same Source</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973940</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessIcmp.srcIpAddr, incidentCount = ExcessIcmp.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESSIVE_ICMP</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,icmpType,icmpCode</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_209" entityVersion="1" xmlId="Rule$PH_Rule_Flow_209" ownerId="500150" lastModified="1350152332700" id="973982" custId="0" creationTime="1350152332699">
                <activatedTime>1350152332699</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a large outbound transfer (larger than 5MB in 10 minutes) from an internal host to an external destination</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973941" ownerId="500150" lastModified="1350152332699" id="973941" custId="0" creationTime="1350152332699">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>SUM(sentBytes) &gt;= 5242880</groupConstraint>
                    <index>0</index>
                    <name>LargeXfer</name>
                    <singleConstraint>srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)</singleConstraint>
                </eventFilters>
                <name>Large Outbound Transfer</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973941</eventFilters>
                <incidentAttrs>
        srcIpAddr = LargeXfer.srcIpAddr, sentBytes = LargeXfer.SUM(sentBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_LARGE_OUTBOUND_XFER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,sentBytes,recvBytes,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_210" entityVersion="1" xmlId="Rule$PH_Rule_Flow_210" ownerId="500150" lastModified="1350152332771" id="973983" custId="0" creationTime="1350152332770">
                <activatedTime>1350152332770</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects outbound permitted traffic to bogon networks. These are IP address spaces not yet allocated by IANA and may indicate that the source host is compromised. Note that these addresses change frequently.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973942" ownerId="500150" lastModified="1350152332770" id="973942" custId="0" creationTime="1350152332770">
                    <groupBy>srcIpAddr, destIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>BogonTraffic</name>
                    <singleConstraint>srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_BOGON_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN (Group@PH_SYS_EVENT_PermitTraffic)</singleConstraint>
                </eventFilters>
                <name>Traffic to bogon networks</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973942</eventFilters>
                <incidentAttrs>
        srcIpAddr = BogonTraffic.srcIpAddr, destIpAddr = BogonTraffic.destIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_BOGON_TRAFFIC</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,sentBytes,recvBytes,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_211" entityVersion="1" xmlId="Rule$PH_Rule_Flow_211" ownerId="500150" lastModified="1350152332842" id="973984" custId="0" creationTime="1350152332842">
                <activatedTime>1350152332842</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a large outbound transfer (larger than 2MB in 10 minutes) from an internal host to an external destination that is outside my country. The rule is written for United States and may need to be tuned for other countries.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973943" ownerId="500150" lastModified="1350152332842" id="973943" custId="0" creationTime="1350152332842">
                    <groupBy>srcIpAddr, destIpAddr</groupBy>
                    <groupConstraint>SUM(sentBytes) &gt;= 2097152</groupConstraint>
                    <index>0</index>
                    <name>LargeXfer</name>
                    <singleConstraint>srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic) and destGeoCountry != "United States"</singleConstraint>
                </eventFilters>
                <name>Large Outbound Transfer To Outside My Country</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973943</eventFilters>
                <incidentAttrs>
        srcIpAddr = LargeXfer.srcIpAddr, destIpAddr = LargeXfer.destIpAddr, sentBytes = LargeXfer.SUM(sentBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_LARGE_OUTBOUND_XFER_OUTSIDE_COUNTRY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,sentBytes,recvBytes,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_212" entityVersion="1" xmlId="Rule$PH_Rule_Flow_212" ownerId="500150" lastModified="1350152332913" id="973985" custId="0" creationTime="1350152332913">
                <activatedTime>1350152332913</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a large inbound transfer (larger than 2MB in 10 minutes) from an external destination that is outside my country. The rule is written for United States and may need to be tuned for other countries.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973944" ownerId="500150" lastModified="1350152332913" id="973944" custId="0" creationTime="1350152332913">
                    <groupBy>srcIpAddr, destIpAddr</groupBy>
                    <groupConstraint>SUM(sentBytes) &gt;= 2097152</groupConstraint>
                    <index>0</index>
                    <name>LargeXfer</name>
                    <singleConstraint>srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL) AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic) AND srcGeoCountry != "United States"</singleConstraint>
                </eventFilters>
                <name>Large Inbound Transfer From Outside My Country</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973944</eventFilters>
                <incidentAttrs>
        srcIpAddr = LargeXfer.srcIpAddr, destIpAddr = LargeXfer.destIpAddr, sentBytes = LargeXfer.SUM(sentBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_LARGE_INBOUND_XFER_OUTSIDE_COUNTRY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,sentBytes,recvBytes,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_8" entityVersion="1" xmlId="Rule$PH_Rule_Perf_8" ownerId="500150" lastModified="1350152333072" id="973986" custId="0" creationTime="1350152333072">
                <activatedTime>1350152333072</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high CPU usage by a server application on the basis of 3 consecutive measurements in a 15 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973945" ownerId="500150" lastModified="1350152333072" id="973945" custId="0" creationTime="1350152333072">
                    <groupBy>hostIpAddr, appName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt;= 85 AND COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>HighProcessCPU</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_RESOURCE_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>High Process CPU: Server</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973945</eventFilters>
                <incidentAttrs>
        hostIpAddr = HighProcessCPU.hostIpAddr, appName = HighProcessCPU.appName, cpuUtil = HighProcessCPU.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_CPU_APPL_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,appName,cpuUtil,memUtil,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_9" entityVersion="1" xmlId="Rule$PH_Rule_Perf_9" ownerId="500150" lastModified="1350152333144" id="973987" custId="0" creationTime="1350152333143">
                <activatedTime>1350152333143</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high memory usage by a server application on the basis of 3 consecutive measurements in a 15 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973946" ownerId="500150" lastModified="1350152333143" id="973946" custId="0" creationTime="1350152333143">
                    <groupBy>hostIpAddr, appName</groupBy>
                    <groupConstraint>AVG(memUtil) &gt;= 80 AND COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>HighProcessMemory</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_RESOURCE_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server)</singleConstraint>
                </eventFilters>
                <name>High Process Memory: Server</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973946</eventFilters>
                <incidentAttrs>
        hostIpAddr = HighProcessMemory.hostIpAddr, appName = HighProcessMemory.appName, memUtil = HighProcessMemory.AVG(memUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_MEM_APPL_SERVER</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,appName,cpuUtil,memUtil,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_10" entityVersion="1" xmlId="Rule$PH_Rule_Perf_10" ownerId="500150" lastModified="1350152333216" id="973988" custId="0" creationTime="1350152333215">
                <activatedTime>1350152333215</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects the process count at a server to be twice the average</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973947" ownerId="500150" lastModified="1350152333215" id="973947" custId="0" creationTime="1350152333215">
                    <groupBy>hostIpAddr</groupBy>
                    <groupConstraint>PH_FUNC_DIFF_STAT_AVG_1(AVG(procCount), 2.0) &gt;= 0 AND COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>ExcessProcessCount</name>
                    <singleConstraint>eventType = "PH_DEV_MON_SYS_PROC_COUNT"</singleConstraint>
                </eventFilters>
                <name>Server Process Count Anomaly</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973947</eventFilters>
                <incidentAttrs>
        hostIpAddr = ExcessProcessCount.hostIpAddr, procCount = ExcessProcessCount.AVG(procCount)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STAT_HIGH_PROC_COUNT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,procCount,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_21" entityVersion="0" xmlId="Rule$PH_Rule_Perf_21" ownerId="500150" lastModified="1350152333285" id="973989" custId="0" creationTime="1350152333285">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a network device is critical and needs immediate attention based average CPU, memory and interface utilization and interface errors - at least one of the measured attributes has crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973948" ownerId="500150" lastModified="1350152333285" id="973948" custId="0" creationTime="1350152333285">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <index>0</index>
                    <name>NetHealthCrit</name>
                    <singleConstraint>eventType IN ("PH_RULE_NET_CPU_CRIT","PH_RULE_NET_MEM_CRIT", "PH_RULE_NET_INTF_UTIL_CRIT","PH_RULE_NET_INTF_ERR_CRIT") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Health: Critical</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973948</eventFilters>
                <incidentAttrs>
        hostIpAddr = NetHealthCrit.hostIpAddr,hostName = NetHealthCrit.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_NET_DEV_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,hostIpAddr,hostName, eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_22" entityVersion="0" xmlId="Rule$PH_Rule_Perf_22" ownerId="500150" lastModified="1350152333355" id="973990" custId="0" creationTime="1350152333355">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a windows server is critical and needs immediate attention based average CPU, memory, disk and interface utilization and interface errors - at least one of the measured attributes has crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@973949" ownerId="500150" lastModified="1350152333355" id="973949" custId="0" creationTime="1350152333355">
                    <groupBy>hostIpAddr, hostName</groupBy>
                    <index>0</index>
                    <name>WinHealthCrit</name>
                    <singleConstraint>eventType IN ("PH_RULE_SERVER_CPU_CRIT","PH_RULE_SERVER_MEM_CRIT","PH_RULE_SERVER_DISK_SPACE_CRIT", "PH_RULE_SERVER_INTF_UTIL_CRIT","PH_RULE_SERVER_INTF_ERR_CRIT") AND hostIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)</singleConstraint>
                </eventFilters>
                <name>Windows Server Health: Critical</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@973949</eventFilters>
                <incidentAttrs>
        hostIpAddr = WinHealthCrit.hostIpAddr, hostName = WinHealthCrit.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_WIN_SERVER_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_24" entityVersion="0" xmlId="Rule$PH_Rule_Perf_24" ownerId="500150" lastModified="1350152333424" id="973991" custId="0" creationTime="1350152333424">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a unix server is critical and needs immediate attention based average CPU, memory, disk and interface utilization and interface errors - at least one of the measured attributes has crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974050" ownerId="500150" lastModified="1350152333424" id="974050" custId="0" creationTime="1350152333424">
                    <groupBy>hostIpAddr, hostName</groupBy>
                    <index>0</index>
                    <name>UnixHealthCrit</name>
                    <singleConstraint>eventType IN ("PH_RULE_SERVER_CPU_CRIT","PH_RULE_SERVER_MEM_CRIT","PH_RULE_SERVER_DISK_SPACE_CRIT", "PH_RULE_SERVER_INTF_UTIL_CRIT","PH_RULE_SERVER_INTF_ERR_CRIT") AND hostIpAddr IN (Group@PH_SYS_DEVICE_UNIX_SERVER)</singleConstraint>
                </eventFilters>
                <name>Unix Server Health: Critical</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974050</eventFilters>
                <incidentAttrs>
        hostIpAddr = UnixHealthCrit.hostIpAddr, hostName = UnixHealthCrit.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_UNIX_SERVER_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,cpuUtil,memUtil,diskUtil,freeDiskMB,diskIOUtil,intfName,inIntfUtil,outIntfUtil,inIntfPktErrPct,outIntfPktErrPct,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_28" entityVersion="0" xmlId="Rule$PH_Rule_Perf_28" ownerId="500150" lastModified="1350152333494" id="973992" custId="0" creationTime="1350152333494">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a network device need to be watched carefully based average CPU, memory and interface utilization and interface errors- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974051" ownerId="500150" lastModified="1350152333494" id="974051" custId="0" creationTime="1350152333494">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <index>0</index>
                    <name>NetHealthWarn</name>
                    <singleConstraint>eventType IN ("PH_RULE_NET_CPU_WARN","PH_RULE_NET_MEM_WARN", "PH_RULE_NET_INTF_UTIL_WARN","PH_RULE_NET_INTF_ERR_WARN") AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>Network Device Health: Warning</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974051</eventFilters>
                <incidentAttrs>
        hostIpAddr = NetHealthWarn.hostIpAddr, hostName = NetHealthWarn.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_NET_DEV_WATCH</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_29" entityVersion="0" xmlId="Rule$PH_Rule_Perf_29" ownerId="500150" lastModified="1350152333564" id="973993" custId="0" creationTime="1350152333564">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a windows server need to be watched carefully based average CPU, memory, disk and interface utilization and interface errors- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974052" ownerId="500150" lastModified="1350152333564" id="974052" custId="0" creationTime="1350152333564">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <index>0</index>
                    <name>WinHealthWarn</name>
                    <singleConstraint>eventType IN ("PH_RULE_SERVER_CPU_WARN","PH_RULE_SERVER_MEM_WARN","PH_RULE_SERVER_DISK_SPACE_WARN", "PH_RULE_SERVER_INTF_UTIL_WARN","PH_RULE_SERVER_INTF_ERR_WARN") AND hostIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)</singleConstraint>
                </eventFilters>
                <name>Windows Server Health: Warning</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974052</eventFilters>
                <incidentAttrs>
        hostIpAddr = WinHealthWarn.hostIpAddr, hostName = WinHealthWarn.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_WIN_SERVER_WATCH</incidentType>
                <phEventCategory>1</phEventCategory>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,cpuUtil,memUtil,diskUtil,diskIOUtil,intfName,inIntfUtil,outIntfUtil,inIntfPktErrPct,outIntfPktErrPct,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Server" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_30" entityVersion="0" xmlId="Rule$PH_Rule_Perf_30" ownerId="500150" lastModified="1350152333634" id="973994" custId="0" creationTime="1350152333634">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a unix server need to be watched carefully based average CPU, memory, disk and interface utilization and interface errors- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974053" ownerId="500150" lastModified="1350152333635" id="974053" custId="0" creationTime="1350152333635">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <index>0</index>
                    <name>UnixHealthWarn</name>
                    <singleConstraint>eventType IN ("PH_RULE_SERVER_CPU_WARN","PH_RULE_SERVER_MEM_WARN","PH_RULE_SERVER_DISK_SPACE_WARN", "PH_RULE_SERVER_INTF_UTIL_WARN","PH_RULE_SERVER_INTF_ERR_WARN") AND hostIpAddr IN (Group@PH_SYS_DEVICE_UNIX_SERVER)</singleConstraint>
                </eventFilters>
                <name>Unix Server Health: Warning</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974053</eventFilters>
                <incidentAttrs>
        hostIpAddr = UnixHealthWarn.hostIpAddr, hostName = UnixHealthWarn.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_UNIX_SERVER_WATCH</incidentType>
                <phEventCategory>1</phEventCategory>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName, rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_31" entityVersion="1" xmlId="Rule$PH_Rule_Perf_31" ownerId="500150" lastModified="1350152333706" id="973995" custId="0" creationTime="1350152333705">
                <activatedTime>1350152333705</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high CPU usage by an application on the basis of 3 consecutive measurements in a 15 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974054" ownerId="500150" lastModified="1350152333705" id="974054" custId="0" creationTime="1350152333705">
                    <groupBy>hostIpAddr, appName</groupBy>
                    <groupConstraint>AVG(cpuUtil) &gt;= 85 AND COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>NetProcCPUHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_RESOURCE_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>High Process CPU: Network Device</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974054</eventFilters>
                <incidentAttrs>
        hostIpAddr = NetProcCPUHigh.hostIpAddr, appName = NetProcCPUHigh.appName, cpuUtil = NetProcCPUHigh.AVG(cpuUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_CPU_APPL_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,appName,cpuUtil,memUtil,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_32" entityVersion="1" xmlId="Rule$PH_Rule_Perf_32" ownerId="500150" lastModified="1350152333779" id="973996" custId="0" creationTime="1350152333779">
                <activatedTime>1350152333779</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high memory usage by an application on the basis of 3 consecutive measurements in a 15 minute period</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974055" ownerId="500150" lastModified="1350152333779" id="974055" custId="0" creationTime="1350152333779">
                    <groupBy>hostIpAddr, appName</groupBy>
                    <groupConstraint>AVG(memUtil) &gt;= 80 AND COUNT(*) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>NetProcMemHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_RESOURCE_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Network)</singleConstraint>
                </eventFilters>
                <name>High Process Memory: Network Device</name>
                <triggerWindow>900</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974055</eventFilters>
                <incidentAttrs>
        hostIpAddr = NetProcMemHigh.hostIpAddr, appName = NetProcMemHigh.appName, memUtil = NetProcMemHigh.AVG(memUtil)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HIGH_MEM_APPL_NET_DEV</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,appName,cpuUtil,memUtil,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_43" entityVersion="0" xmlId="Rule$PH_Rule_Perf_43" ownerId="500150" lastModified="1350152333851" id="973997" custId="0" creationTime="1350152333851">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a virtual machine need to be watched carefully based on specific VM metrics such as CPU ready percent, memory swapping rates and disk I/O activity- at least one of the measured attributes has crossed the specified LOW threshold but has not yet crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974056" ownerId="500150" lastModified="1350152333851" id="974056" custId="0" creationTime="1350152333851">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName</groupBy>
                    <index>0</index>
                    <name>VMHealthWarn</name>
                    <singleConstraint>eventType IN ("PH_RULE_VM_CPU_WARN", "PH_RULE_VM_MEM_WARN", "PH_RULE_VM_DISKIO_WARN")</singleConstraint>
                </eventFilters>
                <name>Virtual Machine Health: Warning</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974056</eventFilters>
                <incidentAttrs>
        hostIpAddr = VMHealthWarn.hostIpAddr,hostName = VMHealthWarn.hostName,phyMachIpAddr = VMHealthWarn.phyMachIpAddr,phyMachName = VMHealthWarn.phyMachName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_VM_WATCH</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_44" entityVersion="0" xmlId="Rule$PH_Rule_Perf_44" ownerId="500150" lastModified="1350152333921" id="973998" custId="0" creationTime="1350152333921">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of a virtual machine is critical based on specific VM metrics such as CPU ready percent, memory swapping rates and disk I/O activity- at least one of the measured attributes has crossed the specified HIGH threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974057" ownerId="500150" lastModified="1350152333921" id="974057" custId="0" creationTime="1350152333921">
                    <groupBy>hostName,hostIpAddr,phyMachIpAddr,phyMachName</groupBy>
                    <index>0</index>
                    <name>VMHealthCrit</name>
                    <singleConstraint>eventType IN ("PH_RULE_VM_CPU_CRIT", "PH_RULE_VM_MEM_CRIT", "PH_RULE_VM_DISKIO_CRIT")</singleConstraint>
                </eventFilters>
                <name>Virtual Machine Health: Critical</name>
                <triggerWindow>540</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974057</eventFilters>
                <incidentAttrs>
        hostIpAddr = VMHealthCrit.hostIpAddr,hostName = VMHealthCrit.hostName,phyMachIpAddr = VMHealthCrit.phyMachIpAddr,phyMachName = VMHealthCrit.phyMachName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_VM_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostName,hostIpAddr,phyMachIpAddr,phyMachName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_47" entityVersion="0" xmlId="Rule$PH_Rule_Perf_47" ownerId="500150" lastModified="1350152333992" id="973999" custId="0" creationTime="1350152333992">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of an ESX server is to be watched carefully since either the performance of one of the component VMs has entered a watched state or the ESX server itself is showing high resource utilization at the aggregate level.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974058" ownerId="500150" lastModified="1350152333992" id="974058" custId="0" creationTime="1350152333992">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <index>0</index>
                    <name>VMHealthWatch</name>
                    <singleConstraint>eventType IN ("PH_RULE_ESX_CPU_WARN","PH_RULE_ESX_MEM_WARN","PH_RULE_ESX_DISKIO_WARN", "PH_RULE_ESX_INTF_WARN")</singleConstraint>
                </eventFilters>
                <name>ESX Server Health: Warning</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974058</eventFilters>
                <incidentAttrs>
        hostIpAddr = VMHealthWatch.hostIpAddr, hostName = VMHealthWatch.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_ESX_WATCH</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Virtualization" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_48" entityVersion="0" xmlId="Rule$PH_Rule_Perf_48" ownerId="500150" lastModified="1350152334061" id="974100" custId="0" creationTime="1350152334061">
                <active>false</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the health of an ESX server is critical since either the performance of one of the component VMs is in critical state or the ESX server itself is showing critical resource utilization at the aggregate level.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974059" ownerId="500150" lastModified="1350152334061" id="974059" custId="0" creationTime="1350152334061">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <index>0</index>
                    <name>VMHealthWatch</name>
                    <singleConstraint>eventType IN ("PH_RULE_ESX_CPU_CRIT","PH_RULE_ESX_MEM_CRIT","PH_RULE_ESX_DISKIO_CRIT", "PH_RULE_ESX_INTF_CRIT")</singleConstraint>
                </eventFilters>
                <name>ESX Server Health: Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974059</eventFilters>
                <incidentAttrs>
        hostName = VMHealthWatch.hostName,hostIpAddr = VMHealthWatch.hostIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEALTH_ESX_CRITICAL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Stat_2" entityVersion="1" xmlId="Rule$PH_Rule_Stat_2" ownerId="500150" lastModified="1350152336085" id="974101" custId="0" creationTime="1350152336085">
                <activatedTime>1350152336085</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects traffic anomaly from a source to a fixed port. This means that the traffic pattern from the source on the destination port is statistically anomalous in the following sense: (a) the number of flows from the source on the given port is more than twice the hourly average flow count, (b) total bytes exchanged by the source on the given port is more than twice the hourly average (c) more than 500 flows (with different 5 tuples) over a 10 minute window from the source on the port</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974060" ownerId="500150" lastModified="1350152336085" id="974060" custId="0" creationTime="1350152336085">
                    <groupBy>srcIpAddr,destIpPort, ipProto</groupBy>
                    <groupConstraint>PH_FUNC_DIFF_STAT_AVG_1(SUM(totFlows), 2.0) &gt;= 0 AND PH_FUNC_DIFF_STAT_AVG_1(SUM(totBytes), 2.0) &gt;= 0 AND SUM(totFlows) &gt;= 600</groupConstraint>
                    <index>0</index>
                    <name>StatHighFlowFromSrc</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND (ipProto = 17 OR ipProto = 6) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Traffic Anomaly From Host On Fixed Port</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974060</eventFilters>
                <incidentAttrs>
        srcIpAddr = StatHighFlowFromSrc.srcIpAddr,destIpPort = StatHighFlowFromSrc.destIpPort,totFlows = StatHighFlowFromSrc.SUM(totFlows)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STAT_HIGH_TRAFFIC_FROM_SRC_FIXED_PORT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Stat_3" entityVersion="1" xmlId="Rule$PH_Rule_Stat_3" ownerId="500150" lastModified="1350152336155" id="974102" custId="0" creationTime="1350152336155">
                <activatedTime>1350152336155</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects traffic anomaly to a destination on a fixed port. This means that the traffic pattern to the destination on the given port is statistically anomalous in the following sense: (a) the number of flows to the destination on the given port is more than twice the hourly average flow count, (b) total bytes exchanged by the destination on the given port is more than twice the hourly average (c) more than 500 flows (with different 5 tuples) over a 10 minute window to the destination on the port</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974061" ownerId="500150" lastModified="1350152336155" id="974061" custId="0" creationTime="1350152336155">
                    <groupBy>destIpAddr,destIpPort,ipProto</groupBy>
                    <groupConstraint>PH_FUNC_DIFF_STAT_AVG_1(SUM(totFlows), 2.0) &gt;= 0 AND PH_FUNC_DIFF_STAT_AVG_1(SUM(totBytes), 2.0) &gt;= 0 AND SUM(totFlows) &gt;= 2000</groupConstraint>
                    <index>0</index>
                    <name>StatHighFlowToDest</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND (ipProto = 17 OR ipProto = 6) AND destIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Traffic Anomaly To Host On Fixed Port</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974061</eventFilters>
                <incidentAttrs>
        destIpAddr = StatHighFlowToDest.destIpAddr,destIpPort = StatHighFlowToDest.destIpPort,totFlows = StatHighFlowToDest.SUM(totFlows)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STAT_HIGH_TRAFFIC_TO_DEST_FIXED_PORT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Stat_4" entityVersion="1" xmlId="Rule$PH_Rule_Stat_4" ownerId="500150" lastModified="1350152336225" id="974103" custId="0" creationTime="1350152336225">
                <activatedTime>1350152336225</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects traffic anomaly between a source and a destination on a fixed port. This means that the traffic pattern between the source and the destination on the given port is statistically anomalous in the following sense: (a) the number of flows between the source and the destination on the given port is more than twice the hourly average flow count, (b) total bytes exchanged between the source and the destination on the given port is more than twice the hourly average (c) more than 500 flows (with different 5 tuples) over a 10 minute window between the source and the destination on the port</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974062" ownerId="500150" lastModified="1350152336225" id="974062" custId="0" creationTime="1350152336225">
                    <groupBy>srcIpAddr,destIpAddr,destIpPort,ipProto</groupBy>
                    <groupConstraint>PH_FUNC_DIFF_STAT_AVG_1(SUM(totFlows), 2.0) &gt;= 0 AND PH_FUNC_DIFF_STAT_AVG_1(SUM(totBytes), 2.0) &gt;= 0 AND SUM(totFlows) &gt;= 600</groupConstraint>
                    <index>0</index>
                    <name>StatHighFlowSrcDestPair</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND (ipProto = 17 OR ipProto = 6) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS) AND destIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Traffic Anomaly Between Two Hosts On Fixed Port</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974062</eventFilters>
                <incidentAttrs>
        srcIpAddr = StatHighFlowSrcDestPair.srcIpAddr,destIpAddr = StatHighFlowSrcDestPair.destIpAddr,destIpPort = StatHighFlowSrcDestPair.destIpPort, totFlows = StatHighFlowSrcDestPair.SUM(totFlows)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_STAT_HIGH_TRAFFIC_SRC_DEST_FIXED_PORT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_1" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_1" ownerId="500150" lastModified="1350152337094" id="974104" custId="0" creationTime="1350152337094">
                <activatedTime>1350152337094</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Network IPS detects P2P traffic</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974063" ownerId="500150" lastModified="1350152337094" id="974063" custId="0" creationTime="1350152337094">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>P2P</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND  eventType IN (Group@PH_SYS_EVENT_P2PTraffic)</singleConstraint>
                </eventFilters>
                <name>P2P traffic detected</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974063</eventFilters>
                <incidentAttrs>
        srcIpAddr = P2P.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_P2P_TRAFFIC</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_2" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_2" ownerId="500150" lastModified="1350152337165" id="974105" custId="0" creationTime="1350152337164">
                <activatedTime>1350152337164</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Network IPS detected P2P traffic and the source IP is also sending/receiving  excessive traffic exceeding 5MB over a 10 minute window</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974064" ownerId="500150" lastModified="1350152337164" id="974064" custId="0" creationTime="1350152337164">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>P2P</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND  eventType IN (Group@PH_SYS_EVENT_P2PTraffic)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974065" ownerId="500150" lastModified="1350152337164" id="974065" custId="0" creationTime="1350152337164">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>SUM(totBytes) &gt;= 5242880</groupConstraint>
                    <index>1</index>
                    <name>ExcessiveBytes</name>
                    <singleConstraint>eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>AND</type>
                </filterOperators>
                <globalConstraint>P2P.srcIpAddr = ExcessiveBytes.srcIpAddr </globalConstraint>
                <name>P2P traffic using up high network bandwidth</name>
                <rawFOString>AND:0</rawFOString>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974064</eventFilters>
                <eventFilters>EventFilter@974065</eventFilters>
                <incidentAttrs>
        srcIpAddr = P2P.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_P2P_TRAFFIC_HIGH_BW</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,totBytes,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_3" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_3" ownerId="500150" lastModified="1350152337235" id="974106" custId="0" creationTime="1350152337235">
                <activatedTime>1350152337235</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Network IPS detects Tunneled traffic</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974066" ownerId="500150" lastModified="1350152337235" id="974066" custId="0" creationTime="1350152337235">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Tunnel</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND  eventType IN (Group@PH_SYS_EVENT_TunnelledTraffic)</singleConstraint>
                </eventFilters>
                <name>Tunneled traffic detected</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974066</eventFilters>
                <incidentAttrs>
        srcIpAddr = Tunnel.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_TUNNEL_TRAFFIC</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_4" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_4" ownerId="500150" lastModified="1350152337304" id="974107" custId="0" creationTime="1350152337304">
                <activatedTime>1350152337304</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Network IPS or Security Gateway or Firewall detects inappropriate website access</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974067" ownerId="500150" lastModified="1350152337304" id="974067" custId="0" creationTime="1350152337304">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>WebViolation</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_WebsiteCategoryViolation)</singleConstraint>
                </eventFilters>
                <name>Inappropriate Website access detected</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974067</eventFilters>
                <incidentAttrs>
        srcIpAddr = WebViolation.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INAPPROPRIATE_WEB_TRAFFIC</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_5" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_5" ownerId="500150" lastModified="1350152337376" id="974108" custId="0" creationTime="1350152337376">
                <activatedTime>1350152337376</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Network IPS detects IRC traffic</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974068" ownerId="500150" lastModified="1350152337376" id="974068" custId="0" creationTime="1350152337376">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>IRC</name>
                    <singleConstraint>(reptDevIpAddr IN (Group@PH_SYS_DEVICE_NETWORK_IPS) OR (reptDevIpAddr IN (Group@PH_SYS_APP_NETWORK_IPS) AND eventType CONTAIN "Snort-")) AND  eventType IN (Group@PH_SYS_EVENT_IRCTraffic)</singleConstraint>
                </eventFilters>
                <name>IRC traffic detected</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974068</eventFilters>
                <incidentAttrs>
        srcIpAddr = IRC.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_IRC_TRAFFIC</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,destIpPort,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_6" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_6" ownerId="500150" lastModified="1350152337446" id="974109" custId="0" creationTime="1350152337446">
                <activatedTime>1350152337446</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects inbound usage of protocols that use clear text passwords e.g. FTP, Telnet, POP</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974069" ownerId="500150" lastModified="1350152337446" id="974069" custId="0" creationTime="1350152337446">
                    <groupBy>srcIpAddr,destIpAddr,ipProto,destIpPort</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Cleartext</name>
                    <singleConstraint>srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpPort IN  (21,109,109,110,143) AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)</singleConstraint>
                </eventFilters>
                <name>Inbound cleartext password usage detected</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974069</eventFilters>
                <incidentAttrs>
        srcIpAddr = Cleartext.srcIpAddr,destIpAddr = Cleartext.destIpAddr,ipProto = Cleartext.ipProto,destIpPort = Cleartext.destIpPort
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CLEARTEXT_PWD_INBOUND</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,destIpPort,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_7" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_7" ownerId="500150" lastModified="1350152337516" id="974110" custId="0" creationTime="1350152337516">
                <activatedTime>1350152337516</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects outbound usage of protocols that use clear text passwords e.g. FTP, Telnet, POP</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974070" ownerId="500150" lastModified="1350152337516" id="974070" custId="0" creationTime="1350152337516">
                    <groupBy>srcIpAddr,destIpAddr,ipProto,destIpPort</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Cleartext</name>
                    <singleConstraint>srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpPort IN  (21,109,109,110,143) AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)</singleConstraint>
                </eventFilters>
                <name>Outbound cleartext password usage detected</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974070</eventFilters>
                <incidentAttrs>
        srcIpAddr = Cleartext.srcIpAddr,destIpAddr = Cleartext.destIpAddr,ipProto = Cleartext.ipProto,destIpPort = Cleartext.destIpPort
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_CLEARTEXT_PWD_OUTBOUND</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,destIpPort,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_8" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_8" ownerId="500150" lastModified="1350152337587" id="974111" custId="0" creationTime="1350152337587">
                <activatedTime>1350152337587</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects remote desktop from the Internet, which is defined as anything outside the Internal network. Please make sure that the Internal network definition is correct to avoid false positives. Remote desktop is detected from a windows log or from a flow to the RDP port</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974071" ownerId="500150" lastModified="1350152337587" id="974071" custId="0" creationTime="1350152337587">
                    <groupBy>srcIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>RDP</name>
                    <singleConstraint>srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND ((destIpAddr IN (Group@PH_SYS_DEVICE_WINDOWS_SERVER)  AND winLogonType = 10 AND eventType IN (Group@PH_SYS_EVENT_HostLogonFailure,Group@PH_SYS_EVENT_HostLogonSuccess)) OR (destIpPort = 3389 AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)))</singleConstraint>
                </eventFilters>
                <name>Remote Desktop from Internet</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974071</eventFilters>
                <incidentAttrs>
        srcIpAddr = RDP.srcIpAddr,destIpAddr = RDP.destIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INBOUND_REMOTE_DESKTOP</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,devIpAddr,winLogonType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_PolicyViolation_9" entityVersion="1" xmlId="Rule$PH_Rule_PolicyViolation_9" ownerId="500150" lastModified="1350152337658" id="974112" custId="0" creationTime="1350152337658">
                <activatedTime>1350152337658</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects remote desktop from the Internet, which is defined as anything outside the Internal network. Please make sure that the Internal network definition is correct to avoid false positives</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974072" ownerId="500150" lastModified="1350152337658" id="974072" custId="0" creationTime="1350152337658">
                    <groupBy>srcIpAddr,destIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>VNC</name>
                    <singleConstraint>srcIpAddr NOT IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET) AND destIpPort &gt;= 5800 AND destIpPort &lt;= 5820 AND destIpPort &gt;= 5900 AND destIpPort &lt;= 5920 AND destIpPort &gt;= 6000 AND destIpPort &lt;= 6020) AND eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)</singleConstraint>
                </eventFilters>
                <name>VNC from Internet</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974072</eventFilters>
                <incidentAttrs>
        srcIpAddr = VNC.srcIpAddr,destIpAddr = VNC.destIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_INBOUND_VNC</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,destIpAddr,destIpPort,eventType,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_1" entityVersion="1" xmlId="Rule$PH_Rule_Environ_1" ownerId="500150" lastModified="1350152338104" id="974113" custId="0" creationTime="1350152338104">
                <activatedTime>1350152338104</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that key UPS operational etrics are outside of normal operational range</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974073" ownerId="500150" lastModified="1350152338104" id="974073" custId="0" creationTime="1350152338104">
                    <groupBy>hostIpAddr, hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND ( AVG(upsAdvOutputFreq) &lt;= 55 OR AVG(upsAdvOutputFreq) &gt;= 65 OR AVG(upsAdvOutputVoltage) &lt; 110 OR AVG(upsAdvOutputVoltage) &gt; 125 OR AVG(upsAdvOutputLoad) &gt;= 50)</groupConstraint>
                    <index>0</index>
                    <name>LowBattery1</name>
                    <singleConstraint>eventType = "PH_DEV_MON_UPS_METRIC" AND upsAdvOutputFreq IS NOT NULL AND upsAdvOutputVoltage IS NOT NULL</singleConstraint>
                </eventFilters>
                <name>UPS Battery Metrics Critical</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974073</eventFilters>
                <incidentAttrs>
	hostIpAddr = LowBattery1.hostIpAddr,
        hostName = LowBattery1.hostName, 
	upsAdvOutputFreq = LowBattery1.AVG(upsAdvOutputFreq),
	upsAdvOutputVoltage = LowBattery1.AVG(upsAdvOutputVoltage),
	upsAdvOutputLoad = LowBattery1.AVG(upsAdvOutputLoad)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_UPS_BATTERY_METRIC_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, upsRemainBatteryChargePct,upsBatteryStatus,upsReplaceBatteryIndicator,upsTimeOnBattery,upsBasicOutputStatus,upsAdvOutputLoad,upsAdvOutputVoltage,upsAdvOutputFreq </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_2" entityVersion="1" xmlId="Rule$PH_Rule_Environ_2" ownerId="500150" lastModified="1350152338176" id="974114" custId="0" creationTime="1350152338176">
                <activatedTime>1350152338176</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that key UPS battery status are reflecting critical state</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974074" ownerId="500150" lastModified="1350152338176" id="974074" custId="0" creationTime="1350152338176">
                    <groupBy>hostIpAddr, hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND ( AVG(upsBatteryStatus) &gt; 2 OR AVG(upsRemainBatteryChargePct) &lt; 50 OR  AVG(upsTimeOnBattery) &gt;= 120 OR AVG(upsBasicOutputStatus) &gt; 2 OR AVG(upsReplaceBatteryIndicator) &gt; 1)</groupConstraint>
                    <index>0</index>
                    <name>LowBattery2</name>
                    <singleConstraint>eventType = "PH_DEV_MON_UPS_METRIC" AND (upsBatteryStatus = 3 OR upsBatteryStatus = 4 OR upsRemainBatteryChargePct &lt; 50 OR upsTimeOnBattery &gt;= 120 OR upsBasicOutputStatus != 2 OR upsReplaceBatteryIndicator = 2)</singleConstraint>
                </eventFilters>
                <name>UPS Battery Status Critical</name>
                <triggerWindow>120</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974074</eventFilters>
                <incidentAttrs>
	hostIpAddr = LowBattery2.hostIpAddr,
        hostName = LowBattery2.hostName,
	upsTimeOnBattery = LowBattery2.AVG(upsTimeOnBattery),
	upsBatteryStatus =  LowBattery2.AVG(upsBatteryStatus), 
	upsRemainBatteryChargePct = LowBattery2.AVG(upsRemainBatteryChargePct), 
	upsReplaceBatteryIndicator = LowBattery2.AVG(upsReplaceBatteryIndicator),
	upsBasicOutputStatus = LowBattery2.AVG(upsBasicOutputStatus)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_UPS_BATTERY_STAT_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, upsRemainBatteryChargePct,upsBatteryStatus,upsReplaceBatteryIndicator,upsTimeOnBattery,upsBasicOutputStatus,upsAdvOutputLoad,upsAdvOutputVoltage,upsAdvOutputFreq </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_3" entityVersion="1" xmlId="Rule$PH_Rule_Environ_3" ownerId="500150" lastModified="1350152338247" id="974115" custId="0" creationTime="1350152338247">
                <activatedTime>1350152338247</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that HVAC temperature is less than 5 degree Fahrenheit from upper threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974075" ownerId="500150" lastModified="1350152338247" id="974075" custId="0" creationTime="1350152338247">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(envTempOffHighDegF) &lt; 5</groupConstraint>
                    <index>0</index>
                    <name>HVAC_Hot</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HVAC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>HVAC temp high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974075</eventFilters>
                <incidentAttrs>
	hostIpAddr = HVAC_Hot.hostIpAddr,
        hostName = HVAC_Hot.hostName,
	envTempOffHighDegF = HVAC_Hot.AVG(envTempOffHighDegF)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HVAC_TOO_HOT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, envTempDegF,envTempHighThreshDegF,envTempLowThreshDegF,envTempOffHighDegF,envTempOffLowDegF </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_4" entityVersion="1" xmlId="Rule$PH_Rule_Environ_4" ownerId="500150" lastModified="1350152338319" id="974116" custId="0" creationTime="1350152338318">
                <activatedTime>1350152338318</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that HVAC temperature is less than 5 degree Fahrenheit from the lower threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974076" ownerId="500150" lastModified="1350152338318" id="974076" custId="0" creationTime="1350152338318">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(envTempOffLowDegF) &lt; 5</groupConstraint>
                    <index>0</index>
                    <name>HVAC_Cold</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HVAC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>HVAC temp low</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974076</eventFilters>
                <incidentAttrs>
	hostIpAddr = HVAC_Cold.hostIpAddr,
        hostName = HVAC_Cold.hostName,
	envTempOffLowDegF = HVAC_Cold.AVG(envTempOffLowDegF)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HVAC_TOO_COLD</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, envTempDegF,envTempHighThreshDegF,envTempLowThreshDegF,envHumidityRel,envHumidityRelHighThresh,envHumidityRelLowThresh </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_5" entityVersion="1" xmlId="Rule$PH_Rule_Environ_5" ownerId="500150" lastModified="1350152338390" id="974117" custId="0" creationTime="1350152338389">
                <activatedTime>1350152338389</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that HVAC relative humidity is less than 5 units from upper threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974077" ownerId="500150" lastModified="1350152338389" id="974077" custId="0" creationTime="1350152338389">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(envHumidityOffHigh) &lt; 5</groupConstraint>
                    <index>0</index>
                    <name>HVAC_Humid</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HVAC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>HVAC humidity high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974077</eventFilters>
                <incidentAttrs>
	hostIpAddr = HVAC_Humid.hostIpAddr,
        hostName = HVAC_Humid.hostName,
	envHumidityOffHigh = HVAC_Humid.AVG(envHumidityOffHigh)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HVAC_TOO_HUMID</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, envTempDegF,envTempHighThreshDegF,envTempLowThreshDegF,envHumidityRel,envHumidityRelHighThresh,envHumidityRelLowThresh </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_6" entityVersion="1" xmlId="Rule$PH_Rule_Environ_6" ownerId="500150" lastModified="1350152338461" id="974118" custId="0" creationTime="1350152338461">
                <activatedTime>1350152338461</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that HVAC relative humidity is less than 5 units from lower threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974078" ownerId="500150" lastModified="1350152338461" id="974078" custId="0" creationTime="1350152338461">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(envHumidityOffLow) &lt; 5</groupConstraint>
                    <index>0</index>
                    <name>HVAC_Humid</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HVAC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>HVAC humidity low</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974078</eventFilters>
                <incidentAttrs>
	hostIpAddr = HVAC_Humid.hostIpAddr,
        hostName = HVAC_Humid.hostName,
	envHumidityOffLow = HVAC_Humid.AVG(envHumidityOffLow)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HVAC_TOO_DRY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, envTempDegF,envTempHighThreshDegF,envTempLowThreshDegF,envHumidityRel,envHumidityRelHighThresh,envHumidityRelLowThresh </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_7" entityVersion="1" xmlId="Rule$PH_Rule_Environ_7" ownerId="500150" lastModified="1350152338534" id="974119" custId="0" creationTime="1350152338533">
                <activatedTime>1350152338534</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that Voltage total harmonic distortion is more than 0.15 pct</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974079" ownerId="500150" lastModified="1350152338534" id="974079" custId="0" creationTime="1350152338534">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND (AVG(outputVxTHD) &gt;= 15 OR AVG(outputVyTHD) &gt; 15 OR AVG(outputVzTHD) &gt;= 15)</groupConstraint>
                    <index>0</index>
                    <name>FPC_VHD_high</name>
                    <singleConstraint>eventType = "PH_DEV_MON_FPC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>FPC Voltage THD high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974079</eventFilters>
                <incidentAttrs>
	hostIpAddr = FPC_VHD_high.hostIpAddr,
        hostName = FPC_VHD_high.hostName,
	outputVxTHD = FPC_VHD_high.AVG(outputVxTHD),
	outputVyTHD = FPC_VHD_high.AVG(outputVyTHD),
	outputVzTHD = FPC_VHD_high.AVG(outputVzTHD)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_FPC_VHD_HIGH</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName,outputVoltageXNVolts,outputVoltageYNVolts,outputVoltageZNVolts,outputVxTHD,outputVyTHD,outputVzTHD </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_8" entityVersion="1" xmlId="Rule$PH_Rule_Environ_8" ownerId="500150" lastModified="1350152338605" id="974120" custId="0" creationTime="1350152338605">
                <activatedTime>1350152338605</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that current total harmonic distortion is more than 0.15 pct</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974080" ownerId="500150" lastModified="1350152338605" id="974080" custId="0" creationTime="1350152338605">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND (AVG(outputLxTHD) &gt;= 5 OR AVG(outputLyTHD) &gt; 5 OR AVG(outputLzTHD) &gt;= 5)</groupConstraint>
                    <index>0</index>
                    <name>FPC_CHD_high</name>
                    <singleConstraint>eventType = "PH_DEV_MON_FPC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>FPC Current THD high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974080</eventFilters>
                <incidentAttrs>
	hostIpAddr = FPC_CHD_high.hostIpAddr,
        hostName = FPC_CHD_high.hostName,
	outputLxTHD = FPC_CHD_high.AVG(outputLxTHD),
	outputLyTHD = FPC_CHD_high.AVG(outputLyTHD),
	outputLzTHD = FPC_CHD_high.AVG(outputLzTHD)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_FPC_CHD_HIGH</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, outputCurrentXAmps,outputCurrentYAmps,outputCurrentZAmps,outputLxTHD,outputLyTHD,outputLzTHD </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_9" entityVersion="1" xmlId="Rule$PH_Rule_Environ_9" ownerId="500150" lastModified="1350152338679" id="974121" custId="0" creationTime="1350152338679">
                <activatedTime>1350152338679</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that ground current is more than 0.12 amps</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974081" ownerId="500150" lastModified="1350152338679" id="974081" custId="0" creationTime="1350152338679">
                    <groupBy>hostName,hostIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(groundCurrentAmps) &gt;= .12</groupConstraint>
                    <index>0</index>
                    <name>FPC_GC_high</name>
                    <singleConstraint>eventType = "PH_DEV_MON_FPC_LIEBERT_METRIC"</singleConstraint>
                </eventFilters>
                <name>FPC ground current high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974081</eventFilters>
                <incidentAttrs>
	hostIpAddr = FPC_GC_high.hostIpAddr,
        hostName = FPC_GC_high.hostName,
	groundCurrentAmps = FPC_GC_high.AVG(groundCurrentAmps)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_FPC_GROUND_CURR_HIGH</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, neutralCurrentAmps,groundCurrentAmps </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_10" entityVersion="1" xmlId="Rule$PH_Rule_Environ_10" ownerId="500150" lastModified="1350152338752" id="974122" custId="0" creationTime="1350152338752">
                <activatedTime>1350152338752</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that netbotz door sensor values went from Close to Open</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974082" ownerId="500150" lastModified="1350152338752" id="974082" custId="0" creationTime="1350152338752">
                    <groupBy>hostIpAddr,hostName,envSensorId,envSensorLabel,envSensorEnclosureId</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>DoorClosed</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HW_DOOR_SWITCH" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND doorSwitchSensorVal = "Closed"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974083" ownerId="500150" lastModified="1350152338752" id="974083" custId="0" creationTime="1350152338752">
                    <groupBy>hostIpAddr,hostName,envSensorId,envSensorLabel,envSensorEnclosureId</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>DoorOpen</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HW_DOOR_SWITCH" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND doorSwitchSensorVal = "Open"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>DoorClosed.hostIpAddr = DoorOpen.hostIpAddr, 
                     DoorClosed.envSensorId = DoorOpen.envSensorId,
		     DoorClosed.envSensorLabel = DoorOpen.envSensorLabel,
		     DoorClosed.envSensorEnclosureId = DoorOpen.envSensorEnclosureId
       </globalConstraint>
                <name>NetBotz module door open</name>
                <rawFOString>FOLLOWED_BY:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974082</eventFilters>
                <eventFilters>EventFilter@974083</eventFilters>
                <incidentAttrs>
        hostIpAddr = DoorClosed.hostIpAddr,
	hostName = DoorClosed.hostName,
	envSensorId = DoorClosed.envSensorId,
	envSensorLabel = DoorClosed.envSensorLabel,
	envSensorEnclosureId  = DoorClosed.envSensorEnclosureId 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETB_DOOR_OPEN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,envSensorId,envSensorLabel,envSensorEnclosureId,devPort,doorSwitchSensorVal </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Environmental" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Environ_11" entityVersion="1" xmlId="Rule$PH_Rule_Environ_11" ownerId="500150" lastModified="1350152338828" id="974123" custId="0" creationTime="1350152338827">
                <activatedTime>1350152338827</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects camera motion from NetBotz camera motion</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974085" ownerId="500150" lastModified="1350152338827" id="974085" custId="0" creationTime="1350152338827">
                    <groupBy>hostIpAddr,hostName,envSensorId,envSensorLabel,envSensorEnclosureId</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>CameraNoMotion</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HW_CAMERA_MOTION" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND cameraMotionSensorVal = "No Motion"</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974086" ownerId="500150" lastModified="1350152338827" id="974086" custId="0" creationTime="1350152338827">
                    <groupBy>hostIpAddr,hostName,envSensorId,envSensorLabel,envSensorEnclosureId</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>1</index>
                    <name>CameraMotion</name>
                    <singleConstraint>eventType = "PH_DEV_MON_HW_CAMERA_MOTION" AND hostIpAddr IN (Group@PH_SYS_DEVICE_ENV_GEN) AND cameraMotionSensorVal = "Motion Detected"</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>FOLLOWED_BY</type>
                </filterOperators>
                <globalConstraint>CameraNoMotion.hostIpAddr = CameraMotion.hostIpAddr, 
                     CameraNoMotion.envSensorId = CameraMotion.envSensorId,
		     CameraNoMotion.envSensorLabel = CameraMotion.envSensorLabel,
		     CameraNoMotion.envSensorEnclosureId = CameraMotion.envSensorEnclosureId
       </globalConstraint>
                <name>NetBotz camera motion detected</name>
                <rawFOString>FOLLOWED_BY:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974085</eventFilters>
                <eventFilters>EventFilter@974086</eventFilters>
                <incidentAttrs>
        hostIpAddr = CameraNoMotion.hostIpAddr,
	hostName = CameraNoMotion.hostName,
	envSensorId = CameraNoMotion.envSensorId,
	envSensorLabel = CameraNoMotion.envSensorLabel,
	envSensorEnclosureId  = CameraNoMotion.envSensorEnclosureId 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_NETB_CAMERA_MOTION</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,hostIpAddr,envSensorId,envSensorLabel,envSensorEnclosureId,devPort,cameraMotionSensorVal </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Web_Server_1" entityVersion="1" xmlId="Rule$PH_Rule_Web_Server_1" ownerId="500150" lastModified="1350152339113" id="974124" custId="0" creationTime="1350152339113">
                <activatedTime>1350152339113</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple HTTP client side errors from the same IP - might indicate an attack . Thresholds are 5 errors from the samesrc IP within a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974088" ownerId="500150" lastModified="1350152339113" id="974088" custId="0" creationTime="1350152339113">
                    <groupBy>reptDevIpAddr,srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessHTTPClientErr</name>
                    <singleConstraint>eventType IN ("IIS-Web-Forbidden-Access-Denied","IIS-Web-Bad-Request","IIS-Web-Length-Reqd-Access-Denied","Apache-Web-Forbidden-Access-Denied","Apache-Web-Bad-Request","Apache-Web-Length-Reqd-Access-Denied","Squid-Web-Forbidden-Access-Denied","Squid-Web-Bad-Request","Squid-Web-Length-Reqd-Access-Denied")</singleConstraint>
                </eventFilters>
                <name>Excessive HTTP Client Side Errors</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974088</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessHTTPClientErr.srcIpAddr, destIpAddr = ExcessHTTPClientErr.reptDevIpAddr,incidentCount = ExcessHTTPClientErr.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_HTTP_CLIENT_ERR</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,user,httpMethod,uriStem,eventType,httpStatusCode,httpSubStatusCode,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Web_Server_2" entityVersion="1" xmlId="Rule$PH_Rule_Web_Server_2" ownerId="500150" lastModified="1350152339183" id="974125" custId="0" creationTime="1350152339183">
                <activatedTime>1350152339183</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects multiple FTP client side errors from the same IP - might indicate an attack from the source IP</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974089" ownerId="500150" lastModified="1350152339183" id="974089" custId="0" creationTime="1350152339183">
                    <groupBy>reptDevIpAddr,srcIpAddr,user</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>ExcessFTPClientErr</name>
                    <singleConstraint>eventType IN ("IIS-FTP-Command-Not-Implemented","IIS-FTP-File-Not-Found","IIS-FTP-Illegal-File")</singleConstraint>
                </eventFilters>
                <name>Excessive FTP Client Side Errors</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974089</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessFTPClientErr.srcIpAddr, destIpAddr = ExcessFTPClientErr.reptDevIpAddr,user = ExcessFTPClientErr.user, incidentCount = ExcessFTPClientErr.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_FTP_CLIENT_ERR</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,user,httpMethod,uriStem,httpStatusCode,httpSubStatusCode,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Web_Server_3" entityVersion="1" xmlId="Rule$PH_Rule_Web_Server_3" ownerId="500150" lastModified="1350152339253" id="974126" custId="0" creationTime="1350152339253">
                <activatedTime>1350152339253</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects an external IP posting an executable site to a web server</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974090" ownerId="500150" lastModified="1350152339253" id="974090" custId="0" creationTime="1350152339253">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>ExecFilePost</name>
                    <singleConstraint>httpMethod IN ("POST","PUT") AND eventType IN (Group@PH_SYS_EVENT_WebTraffic) AND (uriStem CONTAIN ".cgi" OR uriStem CONTAIN ".asp" OR uriStem CONTAIN ".aspx" OR uriStem CONTAIN ".jar" OR uriStem CONTAIN ".php" OR uriStem CONTAIN ".exe" OR uriStem CONTAIN ".com" OR uriStem CONTAIN ".cmd" OR uriStem CONTAIN ".sh" OR uriStem CONTAIN ".bat")</singleConstraint>
                </eventFilters>
                <name>Executable file posting from external source</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974090</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExecFilePost.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXECUTABLE_FILE_POST</incidentType>
                <triggerEventAttrList> phRecvTime,reptDevIpAddr,srcIpAddr,httpMethod,uriStem,httpStatusCode,httpSubStatusCode,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_RV_1" entityVersion="1" xmlId="Rule$PH_Rule_RV_1" ownerId="500150" lastModified="1350152340124" id="974127" custId="0" creationTime="1350152340124">
                <activatedTime>1350152340124</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the Radvision gateway is down. Cleared by the up event</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974091" ownerId="500150" lastModified="1350152340124" id="974091" custId="0" creationTime="1350152340124">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Down</name>
                    <singleConstraint>eventType = "RV-powerDown"</singleConstraint>
                </eventFilters>
                <name>Radvision Gateway Down</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974091</eventFilters>
                <incidentAttrs>
        hostIpAddr = Down.reptDevIpAddr  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RV_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,message </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_RV_2" entityVersion="1" xmlId="Rule$PH_Rule_RV_2" ownerId="500150" lastModified="1350152340198" id="974128" custId="0" creationTime="1350152340198">
                <activatedTime>1350152340198</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that loss of Radvision gateway ISDN link.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974093" ownerId="500150" lastModified="1350152340198" id="974093" custId="0" creationTime="1350152340198">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Down</name>
                    <singleConstraint>eventType = "RV-lossIsdn" AND eventAction = 0</singleConstraint>
                </eventFilters>
                <name>Radvision ISDN Loss</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974093</eventFilters>
                <incidentAttrs>
        hostIpAddr = Down.reptDevIpAddr  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RV_ISDN_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,message </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_RV_3" entityVersion="1" xmlId="Rule$PH_Rule_RV_3" ownerId="500150" lastModified="1350152340269" id="974129" custId="0" creationTime="1350152340269">
                <activatedTime>1350152340269</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that loss of Radvision gateway Ethernet link.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974095" ownerId="500150" lastModified="1350152340269" id="974095" custId="0" creationTime="1350152340269">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Down</name>
                    <singleConstraint>eventType = "RV-lossEthernet" AND eventAction = 0</singleConstraint>
                </eventFilters>
                <name>Radvision Ethernet Loss</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974095</eventFilters>
                <incidentAttrs>
        hostIpAddr = Down.reptDevIpAddr  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RV_ETHERNET_DOWN</incidentType>
                <triggerEventAttrList> phRecvTime,message </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_RV_4" entityVersion="1" xmlId="Rule$PH_Rule_RV_4" ownerId="500150" lastModified="1350152340341" id="974130" custId="0" creationTime="1350152340341">
                <activatedTime>1350152340341</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects call setup problems with peer gateways</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974097" ownerId="500150" lastModified="1350152340341" id="974097" custId="0" creationTime="1350152340341">
                    <groupBy>reptDevIpAddr,eventType</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Down</name>
                    <singleConstraint>eventType IN ("RV-peerCallRejected","RV-peerCallRejectedCapacity","RV-peerCallRejectedByAll","RV-peerCallFailedNoPeers", "RV-peerCallRejectedNonPeer","RV-maxHighLevelResMeter")</singleConstraint>
                </eventFilters>
                <name>Radvision call setup issues</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974097</eventFilters>
                <incidentAttrs>
        hostIpAddr = Down.reptDevIpAddr, compEventType = Down.eventType  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RV_CALL_PROBLEMS</incidentType>
                <triggerEventAttrList> phRecvTime,message </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_RV_5" entityVersion="1" xmlId="Rule$PH_Rule_RV_5" ownerId="500150" lastModified="1350152340412" id="974131" custId="0" creationTime="1350152340412">
                <activatedTime>1350152340412</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a card removed from/inserted into chassis under power, or when the gateway enters maintenance mode</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974098" ownerId="500150" lastModified="1350152340412" id="974098" custId="0" creationTime="1350152340412">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Down</name>
                    <singleConstraint>eventType = "RV-cardExtractHotSwap" AND eventAction = 0</singleConstraint>
                </eventFilters>
                <name>Radvision Hardware Removed/Swapped</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974098</eventFilters>
                <incidentAttrs>
        hostIpAddr = Down.reptDevIpAddr  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RV_HW_REMOVE</incidentType>
                <triggerEventAttrList> phRecvTime,message </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_RV_6" entityVersion="1" xmlId="Rule$PH_Rule_RV_6" ownerId="500150" lastModified="1350152340485" id="974132" custId="0" creationTime="1350152340484">
                <activatedTime>1350152340485</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects Corrupt or empty video packets present in the gateway</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974200" ownerId="500150" lastModified="1350152340484" id="974200" custId="0" creationTime="1350152340484">
                    <groupBy>reptDevIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>Down</name>
                    <singleConstraint>eventType = "RV-badVideo" AND eventAction = 0</singleConstraint>
                </eventFilters>
                <name>Radvision Corrupt video packets</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974200</eventFilters>
                <incidentAttrs>
        hostIpAddr = Down.reptDevIpAddr  
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_RV_CORRUPT_VIDEO</incidentType>
                <triggerEventAttrList> phRecvTime,message </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Perf_IIS_1" entityVersion="1" xmlId="Rule$PH_Rule_Perf_IIS_1" ownerId="500150" lastModified="1350152341133" id="974133" custId="0" creationTime="1350152341133">
                <activatedTime>1350152341133</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that IIS is using at least 1.9 GB of virtual memory and is fast approaching the 2 GB limit.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974202" ownerId="500150" lastModified="1350152341133" id="974202" custId="0" creationTime="1350152341133">
                    <groupBy>hostIpAddr,hostName</groupBy>
                    <groupConstraint>AVG(virtMemKBytes) &gt;= 1900000  AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>IISVMWarn</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PROC_RESOURCE_UTIL" AND appName = "Microsoft IIS"</singleConstraint>
                </eventFilters>
                <name>IIS Virtual Memory Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974202</eventFilters>
                <fireInternalIncident>false</fireInternalIncident>
                <incidentAttrs>
        hostIpAddr = IISVMWarn.hostIpAddr, hostName = IISVMWarn.hostName, virtMemKBytes = IISVMWarn.AVG(virtMemKBytes)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_APP_IIS_VM_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,hostIpAddr,hostName,swProcName, appName, memUtil,cpuUtil, realMemPeakKBytes,virtMemKBytes,peakVirtMemKBytes,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_1" entityVersion="1" xmlId="Rule$PH_Rule_DB_1" ownerId="500150" lastModified="1350152342131" id="974134" custId="0" creationTime="1350152342131">
                <activatedTime>1350152342131</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that average buffer cache hit ratio is less than 90 for 2 successive readings</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974204" ownerId="500150" lastModified="1350152342131" id="974204" custId="0" creationTime="1350152342131">
                    <groupBy>hostName,instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbBufferCacheHitRatio) &lt; 90</groupConstraint>
                    <index>0</index>
                    <name>CacheHitLow</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_SYS"</singleConstraint>
                </eventFilters>
                <name>SQL Server Low Buffer Cache Hit Ratio</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974204</eventFilters>
                <incidentAttrs>
        hostName = CacheHitLow.hostName,
	instanceName = CacheHitLow.instanceName,
	dbBufferCacheHitRatio = CacheHitLow.AVG(dbBufferCacheHitRatio)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_LOW_BUFF_CACHE_HIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbBufferCacheHitRatio,dbLogCacheHitRatio,dbPageReadsPerSec,dbPageWritesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_2" entityVersion="1" xmlId="Rule$PH_Rule_DB_2" ownerId="500150" lastModified="1350152342205" id="974135" custId="0" creationTime="1350152342205">
                <activatedTime>1350152342205</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that log buffer cache hit ratio is less than 90 for 2 successive readings</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974205" ownerId="500150" lastModified="1350152342205" id="974205" custId="0" creationTime="1350152342205">
                    <groupBy>hostName,instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbLogCacheHitRatio) &lt; 90</groupConstraint>
                    <index>0</index>
                    <name>CacheHitLow</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_SYS"</singleConstraint>
                </eventFilters>
                <name>SQL Server Low Log Cache Hit Ratio</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974205</eventFilters>
                <incidentAttrs>
        hostName = CacheHitLow.hostName,
	instanceName = CacheHitLow.instanceName, 
	dbLogCacheHitRatio = CacheHitLow.AVG(dbLogCacheHitRatio)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_LOW_LOG_CACHE_HIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbLogCacheHitRatio,dbBufferCacheHitRatio,dbPageReadsPerSec,dbPageWritesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_3" entityVersion="1" xmlId="Rule$PH_Rule_DB_3" ownerId="500150" lastModified="1350152342276" id="974136" custId="0" creationTime="1350152342276">
                <activatedTime>1350152342276</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive SQL Server deadlocks ( larger 2/sec over 2 succesive readings)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974206" ownerId="500150" lastModified="1350152342276" id="974206" custId="0" creationTime="1350152342276">
                    <groupBy>hostName,instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbDeadLocksPerSec) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>ExcessDeadlock</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_SYS"</singleConstraint>
                </eventFilters>
                <name>SQL Server Excessive Deadlock</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974206</eventFilters>
                <incidentAttrs>
        hostName = ExcessDeadlock.hostName,
	instanceName = ExcessDeadlock.instanceName, 
	dbDeadLocksPerSec = ExcessDeadlock.AVG(dbDeadLocksPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_EXCESS_DEADLOCK</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbDeadLocksPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_4" entityVersion="1" xmlId="Rule$PH_Rule_DB_4" ownerId="500150" lastModified="1350152342347" id="974137" custId="0" creationTime="1350152342347">
                <activatedTime>1350152342347</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive SQL Server page read/write ( larger than 90 over 2 succesive readings)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974207" ownerId="500150" lastModified="1350152342347" id="974207" custId="0" creationTime="1350152342347">
                    <groupBy>hostName,instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND (AVG(dbPageReadsPerSec) &gt;= 90 OR AVG(dbPageWritesPerSec) &gt;= 90)</groupConstraint>
                    <index>0</index>
                    <name>ExcessPageRW</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_SYS"</singleConstraint>
                </eventFilters>
                <name>SQL Server Excessive Page Read/Write</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974207</eventFilters>
                <incidentAttrs>
        hostName = ExcessPageRW.hostName,
	instanceName = ExcessPageRW.instanceName, 
	dbPageReadsPerSec = ExcessPageRW.AVG(dbPageReadsPerSec),
	dbPageWritesPerSec = ExcessPageRW.AVG(dbPageWritesPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_EXCESS_PAGE_RW</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbPageReadsPerSec,dbPageWritesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_5" entityVersion="1" xmlId="Rule$PH_Rule_DB_5" ownerId="500150" lastModified="1350152342419" id="974138" custId="0" creationTime="1350152342418">
                <activatedTime>1350152342419</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects low free pages in SQL Server buffer pool (less than 640 over 2 succesive readings)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974208" ownerId="500150" lastModified="1350152342419" id="974208" custId="0" creationTime="1350152342419">
                    <groupBy>hostName,instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbPagesFreeInBufferPool) &lt; 640</groupConstraint>
                    <index>0</index>
                    <name>LowBuffPoolPage</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_SYS"</singleConstraint>
                </eventFilters>
                <name>SQL Server Low Free Pages in Buffer Pool</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974208</eventFilters>
                <incidentAttrs>
        hostName = LowBuffPoolPage.hostName,
	instanceName = LowBuffPoolPage.instanceName, 
	dbPagesFreeInBufferPool = LowBuffPoolPage.AVG(dbPagesFreeInBufferPool)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_LOW_BP_PAGES</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbPagesFreeInBufferPool,dbPagesInBufferPool,dbPageReadsPerSec,dbPageWritesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_6" entityVersion="1" xmlId="Rule$PH_Rule_DB_6" ownerId="500150" lastModified="1350152342491" id="974139" custId="0" creationTime="1350152342490">
                <activatedTime>1350152342490</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a particular process/user blocked for more than 2 sec</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974209" ownerId="500150" lastModified="1350152342490" id="974209" custId="0" creationTime="1350152342490">
                    <groupBy>hostName,instanceName,blockingLoginUser,blockingCommand,blockingDbName,blockedLoginUser,blockedCommand,blockedProcessName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(blockedDuration) &gt; 2000</groupConstraint>
                    <index>0</index>
                    <name>ExcessBlock</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_BLOCKBY_INFO"</singleConstraint>
                </eventFilters>
                <name>SQL Server Excessive Blocking</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974209</eventFilters>
                <incidentAttrs>
        hostName = ExcessBlock.hostName,
	instanceName =  ExcessBlock.instanceName,
	blockingLoginUser = ExcessBlock.blockingLoginUser,
	blockingCommand = ExcessBlock.blockingCommand,
	blockedLoginUser = ExcessBlock.blockedLoginUser,
	blockedCommand = ExcessBlock.blockedCommand,
	blockedDuration = ExcessBlock.AVG(blockedDuration)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_EXCESS_BLOCK</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,blockingLoginUser,blockingCommand,blockingDbName,blockingSpId,blockedLoginUser,blockedCommand,blockedProcessName,blockedSpId,blockedDuration</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_7" entityVersion="1" xmlId="Rule$PH_Rule_DB_7" ownerId="500150" lastModified="1350152342563" id="974140" custId="0" creationTime="1350152342562">
                <activatedTime>1350152342562</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that database server disk I/O latency has reached a critical level (greater  than 50 msec) based on 2 successive readings in a 10 minute interval</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974210" ownerId="500150" lastModified="1350152342562" id="974210" custId="0" creationTime="1350152342562">
                    <groupBy>hostIpAddr,hostName,diskName</groupBy>
                    <groupConstraint>(AVG(devDiskRdLatency) &gt;= 20 OR AVG(devDiskWrLatency) &gt;= 20) AND COUNT(*) &gt;= 2</groupConstraint>
                    <index>0</index>
                    <name>ServDiskLatencyCrit</name>
                    <singleConstraint>eventType = "PH_DEV_MON_DISK_IO_UTIL" AND hostIpAddr IN (Group@PH_SYS_DEVICE_Server) AND diskName NOT IN ("/boot") AND hostIpAddr IN (Group@PH_SYS_APP_DATABASE_SERVER)</singleConstraint>
                </eventFilters>
                <name>Database Server Disk Latency Critical</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974210</eventFilters>
                <incidentAttrs>
        hostIpAddr = ServDiskLatencyCrit.hostIpAddr, hostName = ServDiskLatencyCrit.hostName, diskName = ServDiskLatencyCrit.diskName,devDiskRdLatency = ServDiskLatencyCrit.AVG(devDiskRdLatency), devDiskWrLatency = ServDiskLatencyCrit.AVG(devDiskWrLatency)
      </incidentAttrs>
                <incidentFireFreq>21600</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DB_SERVER_DISK_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,reptDevIpAddr,hostIpAddr,hostName,diskName,devDiskRdLatency,devDiskWrLatency,diskQLen,diskIOUtil,diskReadReqPerSec,diskWriteReqPerSec,diskReadKBytesPerSec,diskWriteKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_8" entityVersion="1" xmlId="Rule$PH_Rule_DB_8" ownerId="500150" lastModified="1350152342635" id="974141" custId="0" creationTime="1350152342634">
                <activatedTime>1350152342634</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive full scan (greater than 1000 per second)</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974211" ownerId="500150" lastModified="1350152342634" id="974211" custId="0" creationTime="1350152342634">
                    <groupBy>hostName, instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbFullScansPerSec) &gt; 1000</groupConstraint>
                    <index>0</index>
                    <name>ExcessScan</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_MSSQL_SYS"</singleConstraint>
                </eventFilters>
                <name>SQL Server Excessive Full Scan</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974211</eventFilters>
                <incidentAttrs>
        hostName = ExcessScan.hostName,
	instanceName = ExcessScan.instanceName, 
	dbFullScansPerSec = ExcessScan.AVG(dbFullScansPerSec)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_SQL_SRV_EXCESS_FULL_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbFullScansPerSec,dbPageReadsPerSec,dbPageWritesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_9" entityVersion="1" xmlId="Rule$PH_Rule_DB_9" ownerId="500150" lastModified="1350152342709" id="974142" custId="0" creationTime="1350152342708">
                <activatedTime>1350152342708</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that the Oracle database listener status is CLOSED. The database may not be accepting connections.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974212" ownerId="500150" lastModified="1350152342708" id="974212" custId="0" creationTime="1350152342708">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>ListenerClosed</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB" AND listenerStatus = "CLOSED"</singleConstraint>
                </eventFilters>
                <name>Oracle DB listener CLOSED</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974212</eventFilters>
                <incidentAttrs>
        hostName = ListenerClosed.hostName
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORACLE_DB_LISTENER_CLOSED</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,listenerStatus</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_10" entityVersion="1" xmlId="Rule$PH_Rule_DB_10" ownerId="500150" lastModified="1350152342780" id="974143" custId="0" creationTime="1350152342780">
                <activatedTime>1350152342780</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high SYSTEM tablespace usage</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974213" ownerId="500150" lastModified="1350152342780" id="974213" custId="0" creationTime="1350152342780">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(tablespaceUsage) &gt; 80</groupConstraint>
                    <index>0</index>
                    <name>HighSystemTS</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB_TABLESPACE" AND tablespaceName = "SYSTEM"</singleConstraint>
                </eventFilters>
                <name>High Oracle System Table Space Usage</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974213</eventFilters>
                <incidentAttrs>
        hostName = HighSystemTS.hostName,
	tablespaceUsage = HighSystemTS.AVG(tablespaceUsage)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_SYSTEM_TABLESPACE_HIGH</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,tablespaceName, tablespaceUsage, tablespaceFreeSpace</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_11" entityVersion="1" xmlId="Rule$PH_Rule_DB_11" ownerId="500150" lastModified="1350152342853" id="974144" custId="0" creationTime="1350152342852">
                <activatedTime>1350152342852</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects high non-SYSTEM tablespace usage</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974214" ownerId="500150" lastModified="1350152342852" id="974214" custId="0" creationTime="1350152342852">
                    <groupBy>hostName,tablespaceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(tablespaceUsage) &gt; 95</groupConstraint>
                    <index>0</index>
                    <name>HighSystemTS</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB_TABLESPACE" AND tablespaceName != "SYSTEM"</singleConstraint>
                </eventFilters>
                <name>High Oracle Non-System Table Space Usage</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974214</eventFilters>
                <incidentAttrs>
        hostName = HighSystemTS.hostName,
	tablespaceName = HighSystemTS.tablespaceName,
	tablespaceUsage = HighSystemTS.AVG(tablespaceUsage)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_NONSYS_TABLESPACE_HIGH</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,tablespaceName, tablespaceUsage, tablespaceFreeSpace</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_12" entityVersion="1" xmlId="Rule$PH_Rule_DB_12" ownerId="500150" lastModified="1350152342926" id="974145" custId="0" creationTime="1350152342925">
                <activatedTime>1350152342925</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that Oracle database has not been backed up for more than 1 day</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974215" ownerId="500150" lastModified="1350152342925" id="974215" custId="0" creationTime="1350152342925">
                    <groupBy>hostName,instanceName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1 AND AVG(timeSinceLastBackup) &gt; 86400</groupConstraint>
                    <index>0</index>
                    <name>NoBackup</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB"</singleConstraint>
                </eventFilters>
                <name>Oracle Database not backed up for 1 day</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974215</eventFilters>
                <incidentAttrs>
        hostName = NoBackup.hostName,
	instanceName = NoBackup.instanceName,
	timeSinceLastBackup = NoBackup.AVG(timeSinceLastBackup);
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_NO_BACKUP</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,instanceName,lastBackupDate,timeSinceLastBackup</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_13" entityVersion="1" xmlId="Rule$PH_Rule_DB_13" ownerId="500150" lastModified="1350152342999" id="974146" custId="0" creationTime="1350152342998">
                <activatedTime>1350152342998</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that average buffer cache hit ratio is less than 90 for 2 successive readings</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974216" ownerId="500150" lastModified="1350152342998" id="974216" custId="0" creationTime="1350152342998">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbBufferCacheHitRatio) &lt; 90</groupConstraint>
                    <index>0</index>
                    <name>CacheHitLow</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB"</singleConstraint>
                </eventFilters>
                <name>Oracle DB Low Buffer Cache Hit Ratio</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974216</eventFilters>
                <incidentAttrs>
        hostName = CacheHitLow.hostName, 
	dbBufferCacheHitRatio = CacheHitLow.AVG(dbBufferCacheHitRatio)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_LOW_BUFF_CACHE_HIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbBufferCacheHitRatio,dbPhysicalReadsPerSec,dbPhysicalWritesPerSec,dbRequestsPerSec,dbIOKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_14" entityVersion="1" xmlId="Rule$PH_Rule_DB_14" ownerId="500150" lastModified="1350152343071" id="974147" custId="0" creationTime="1350152343071">
                <activatedTime>1350152343071</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that average library cache hit ratio is less than 90 for 2 successive readings</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974217" ownerId="500150" lastModified="1350152343071" id="974217" custId="0" creationTime="1350152343071">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbLibraryCacheHitRatio) &lt; 90</groupConstraint>
                    <index>0</index>
                    <name>CacheHitLow</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB"</singleConstraint>
                </eventFilters>
                <name>Oracle DB Low Library Cache Hit Ratio</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974217</eventFilters>
                <incidentAttrs>
        hostName = CacheHitLow.hostName, 
	dbLibraryCacheHitRatio = CacheHitLow.AVG(dbLibraryCacheHitRatio)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_LOW_LIB_CACHE_HIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbLibraryCacheHitRatio,dbBufferCacheHitRatio,dbPhysicalReadsPerSec,dbPhysicalWritesPerSec,dbRequestsPerSec,dbIOKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_15" entityVersion="1" xmlId="Rule$PH_Rule_DB_15" ownerId="500150" lastModified="1350152343146" id="974148" custId="0" creationTime="1350152343145">
                <activatedTime>1350152343146</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that average row cache hit ratio is less than 90 for 2 successive readings</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974218" ownerId="500150" lastModified="1350152343146" id="974218" custId="0" creationTime="1350152343146">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbRowCacheHitRatio) &lt; 90</groupConstraint>
                    <index>0</index>
                    <name>CacheHitLow</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB"</singleConstraint>
                </eventFilters>
                <name>Oracle DB Low Row Cache Hit Ratio</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974218</eventFilters>
                <incidentAttrs>
        hostName = CacheHitLow.hostName, 
	dbRowCacheHitRatio = CacheHitLow.AVG(dbRowCacheHitRatio)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_LOW_ROW_CACHE_HIT</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbRowCacheHitRatio,dbBufferCacheHitRatio,dbPhysicalReadsPerSec,dbPhysicalWritesPerSec,dbRequestsPerSec,dbIOKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_16" entityVersion="1" xmlId="Rule$PH_Rule_DB_16" ownerId="500150" lastModified="1350152343220" id="974149" custId="0" creationTime="1350152343219">
                <activatedTime>1350152343219</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that average memory sorts ratio is less than 90 for 2 successive readings</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974219" ownerId="500150" lastModified="1350152343219" id="974219" custId="0" creationTime="1350152343219">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(dbMemorySortsRatio) &lt; 90</groupConstraint>
                    <index>0</index>
                    <name>MemSortRatioLow</name>
                    <singleConstraint>eventType = "PH_DEV_MON_PERF_ORADB"</singleConstraint>
                </eventFilters>
                <name>Oracle DB Low Row Memory Sorts Ratio</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974219</eventFilters>
                <incidentAttrs>
        hostName = MemSortRatioLow.hostName, 
	dbMemorySortsRatio = MemSortRatioLow.AVG(dbMemorySortsRatio)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_LOW_MEMSORT_RATIO</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,dbMemorySortsRatio,dbBufferCacheHitRatio,dbPhysicalReadsPerSec,dbPhysicalWritesPerSec,dbRequestsPerSec,dbIOKBytesPerSec</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_DB_17" entityVersion="1" xmlId="Rule$PH_Rule_DB_17" ownerId="500150" lastModified="1350152343293" id="974300" custId="0" creationTime="1350152343293">
                <activatedTime>1350152343293</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects Oracle database alert log errors</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974220" ownerId="500150" lastModified="1350152343293" id="974220" custId="0" creationTime="1350152343293">
                    <groupBy>hostName,eventType</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 1</groupConstraint>
                    <index>0</index>
                    <name>AlertLog</name>
                    <singleConstraint>eventType CONTAIN "ORADB-ORA"</singleConstraint>
                </eventFilters>
                <name>Oracle DB Alert Log Error</name>
                <triggerWindow>600</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974220</eventFilters>
                <incidentAttrs>
        hostName = AlertLog.hostName, 
	compEventType = AlertLog.eventType
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_ORADB_ALERT_LOG_ERROR</incidentType>
                <triggerEventAttrList> phRecvTime,hostName,eventType,rawEventMsg</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Mail_1" entityVersion="1" xmlId="Rule$PH_Rule_Mail_1" ownerId="500150" lastModified="1350152344153" id="974301" custId="0" creationTime="1350152344153">
                <activatedTime>1350152344153</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that one or more of SMTP Server queues have crossed critical threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974221" ownerId="500150" lastModified="1350152344153" id="974221" custId="0" creationTime="1350152344153">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND (AVG(exchCatQueue) &gt;= 10 OR AVG(exchSMTPLocalQueue) &gt;= 1000 OR AVG(exchSMTPRemoteQueue) &gt; 1000)</groupConstraint>
                    <index>0</index>
                    <name>QueueHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_APP_MSEXCH_SMTP_MET"</singleConstraint>
                </eventFilters>
                <name>Exchange Server SMTP Queue high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974221</eventFilters>
                <incidentAttrs>
        hostName = QueueHigh.hostName, 
	exchCatQueue = QueueHigh.AVG(exchCatQueue),
	exchSMTPLocalQueue = QueueHigh.AVG(exchSMTPLocalQueue),
	exchSMTPRemoteQueue = QueueHigh.AVG(exchSMTPRemoteQueue)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCH_SMTP_QUEUE_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, exchCatQueue,exchSMTPLocalQueue,exchSMTPRemoteQueue,exchSMTPInConn,exchSMTPOutConn,exchSMTPRetries,exchSMTPLocalRetryQueue,exchSMTPRemoteRetryQueue</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Mail_2" entityVersion="1" xmlId="Rule$PH_Rule_Mail_2" ownerId="500150" lastModified="1350152344226" id="974302" custId="0" creationTime="1350152344225">
                <activatedTime>1350152344226</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects that one or more of Exchange mailbox store queues have crossed critical threshold</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974222" ownerId="500150" lastModified="1350152344226" id="974222" custId="0" creationTime="1350152344226">
                    <groupBy>hostName,exchMboxName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND (AVG(exchMboxSendQueue) &gt;= 500 OR AVG(exchMboxRecvQueue) &gt;= 500)</groupConstraint>
                    <index>0</index>
                    <name>QueueHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_APP_MSEXCH_MBOX_MET"</singleConstraint>
                </eventFilters>
                <name>Exchange Server Mailbox Queue high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974222</eventFilters>
                <incidentAttrs>
        hostName = QueueHigh.hostName, 
	exchMboxName = QueueHigh.exchMboxName,
	exchMboxSendQueue = QueueHigh.AVG(exchMboxSendQueue),
	exchMboxRecvQueue = QueueHigh.AVG(exchMboxRecvQueue)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCH_MBOX_QUEUE_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, exchMboxName,exchMboxSendQueue,exchMboxRecvQueue,exchMboxSentMsg,exchMboxSubmitMsg,exchMboxDelivMsg,exchMboxActiveUserCount,exchMboxPeakUserCount</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Mail_3" entityVersion="1" xmlId="Rule$PH_Rule_Mail_3" ownerId="500150" lastModified="1350152344297" id="974303" custId="0" creationTime="1350152344297">
                <activatedTime>1350152344297</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a spike in exchange server RPC requests</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974223" ownerId="500150" lastModified="1350152344297" id="974223" custId="0" creationTime="1350152344297">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(exchRPCReq) &gt;= 30</groupConstraint>
                    <index>0</index>
                    <name>RPCHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_APP_MSEXCH_MET"</singleConstraint>
                </eventFilters>
                <name>Exchange Server RPC request high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974223</eventFilters>
                <incidentAttrs>
        hostName = RPCHigh.hostName, 
	exchRPCReq = RPCHigh.AVG(exchRPCReq)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCH_RPC_REQ_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, exchRPCReq,exchRPCAvgLatency,exchRPCOpsPerSec,exchRPCReqPeak,exchUserCount,exchActiveUserCount,exchPeakUserCount,exchActiveConnCount,exchMaxConn</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Mail_4" entityVersion="1" xmlId="Rule$PH_Rule_Mail_4" ownerId="500150" lastModified="1350152344369" id="974304" custId="0" creationTime="1350152344369">
                <activatedTime>1350152344369</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive exchange server RPC request latency</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974224" ownerId="500150" lastModified="1350152344369" id="974224" custId="0" creationTime="1350152344369">
                    <groupBy>hostName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 2 AND AVG(exchRPCAvgLatency) &gt;= 50</groupConstraint>
                    <index>0</index>
                    <name>RPCLatencyHigh</name>
                    <singleConstraint>eventType = "PH_DEV_MON_APP_MSEXCH_MET"</singleConstraint>
                </eventFilters>
                <name>Exchange Server RPC latency high</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974224</eventFilters>
                <incidentAttrs>
        hostName = RPCLatencyHigh.hostName, 
	exchRPCAvgLatency = RPCLatencyHigh.AVG(exchRPCAvgLatency)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCH_RPC_LATENCY_CRIT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType, hostName, exchRPCReq,exchRPCAvgLatency,exchRPCOpsPerSec,exchRPCReqPeak,exchUserCount,exchActiveUserCount,exchPeakUserCount,exchActiveConnCount,exchMaxConn</triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_1" entityVersion="1" xmlId="Rule$PH_Rule_Flow_1" ownerId="500150" lastModified="1350152345164" id="974305" custId="0" creationTime="1350152345164">
                <activatedTime>1350152345164</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive half-open TCP sessions from the same source to many distinct destinations in a short period of time. The threshold is 200 flows within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blacklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974225" ownerId="500150" lastModified="1350152345164" id="974225" custId="0" creationTime="1350152345164">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 200</groupConstraint>
                    <index>0</index>
                    <name>HostScanTCP</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND srcDestTCPFlags = 2 AND ipProto = 6 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy TCP Host Scan</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974225</eventFilters>
                <incidentAttrs>
        srcIpAddr = HostScanTCP.srcIpAddr, incidentCount = HostScanTCP.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_TCP_HOST_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_2" entityVersion="1" xmlId="Rule$PH_Rule_Flow_2" ownerId="500150" lastModified="1350152345235" id="974306" custId="0" creationTime="1350152345235">
                <activatedTime>1350152345235</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive half-open TCP sessions from the same source to many distinct destinations and on the same destination port in a short period of time. The threshold is 200 flows within 3 minutes. A fixed destination port may indicate that the scanning host is attempting to find hosts on a well known port (with a vulnerability). Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blacklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974226" ownerId="500150" lastModified="1350152345235" id="974226" custId="0" creationTime="1350152345235">
                    <groupBy>srcIpAddr, destIpPort</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>HostScanFixedTCPPort</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND srcDestTCPFlags = 2 AND ipProto = 6 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy TCP Host Scan On Fixed Port</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974226</eventFilters>
                <incidentAttrs>
        srcIpAddr = HostScanFixedTCPPort.srcIpAddr, destIpPort = HostScanFixedTCPPort.destIpPort, incidentCount = HostScanFixedTCPPort.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_TCP_HOST_SCAN_FIXED_PORT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_3" entityVersion="1" xmlId="Rule$PH_Rule_Flow_3" ownerId="500150" lastModified="1350152345304" id="974307" custId="0" creationTime="1350152345304">
                <activatedTime>1350152345304</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive number of UDP connections from the same source to many distinct destinations in a short period of time. The threshold is 200 flows within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blacklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974227" ownerId="500150" lastModified="1350152345304" id="974227" custId="0" creationTime="1350152345304">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 200</groupConstraint>
                    <index>0</index>
                    <name>HostScanUDP</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 17 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy UDP Host Scan</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974227</eventFilters>
                <incidentAttrs>
        srcIpAddr = HostScanUDP.srcIpAddr, incidentCount = HostScanUDP.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_UDP_HOST_SCAN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_4" entityVersion="1" xmlId="Rule$PH_Rule_Flow_4" ownerId="500150" lastModified="1350152345375" id="974308" custId="0" creationTime="1350152345374">
                <activatedTime>1350152345375</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive number of UDP connections from the same source to many distinct destinations and on the same destination port in a short period of time. The threshold is 200 flows within 3 minutes. A fixed destination port may indicate that the scanning host is attempting to find hosts on a well known port (with a vulnerability). Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blacklisted. P2P clients also exhibit this behavior when they attempt to establish connections to (non-existent) peers.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974228" ownerId="500150" lastModified="1350152345375" id="974228" custId="0" creationTime="1350152345375">
                    <groupBy>srcIpAddr, destIpPort</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>HostScanFixedUDPPort</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 17 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy UDP Host Scan On Fixed Port</name>
                <triggerWindow>120</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974228</eventFilters>
                <incidentAttrs>
        srcIpAddr = HostScanFixedUDPPort.srcIpAddr, destIpPort = HostScanFixedUDPPort.destIpPort, incidentCount = HostScanFixedUDPPort.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_UDP_HOST_SCAN_FIXED_PORT</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_5" entityVersion="1" xmlId="Rule$PH_Rule_Flow_5" ownerId="500150" lastModified="1350152345445" id="974309" custId="0" creationTime="1350152345445">
                <activatedTime>1350152345445</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive number of ICMP echo request packets from the same source to many distinct destinations in a short period of time. Nachi worm exploited pings to spread. The threshold is 50 pings within 3 minutes. Scanning may be a precursor to exploits. However, network management and mapping tools often scan the network for discovery purposes and authorized scanners need to be blacklisted.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974229" ownerId="500150" lastModified="1350152345445" id="974229" custId="0" creationTime="1350152345445">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 50</groupConstraint>
                    <index>0</index>
                    <name>PingSweep</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND ipProto = 1 AND icmpType = 8 AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS)</singleConstraint>
                </eventFilters>
                <name>Heavy ICMP Ping sweep</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974229</eventFilters>
                <incidentAttrs>
        srcIpAddr = PingSweep.srcIpAddr, incidentCount = PingSweep.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_HEAVY_ICMP_PING_SWEEP</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,icmpType,icmpCode,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_6" entityVersion="1" xmlId="Rule$PH_Rule_Flow_6" ownerId="500150" lastModified="1350152345515" id="974310" custId="0" creationTime="1350152345515">
                <activatedTime>1350152345515</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive number of half-open TCP connections from many distinct sources to the same destination host and on the same port in a short period of time. This may indicate that the destination server is under some sort of attack.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974230" ownerId="500150" lastModified="1350152345515" id="974230" custId="0" creationTime="1350152345515">
                    <groupBy>destIpAddr, destIpPort</groupBy>
                    <groupConstraint>COUNT (DISTINCT srcIpAddr) &gt;= 200</groupConstraint>
                    <index>0</index>
                    <name>DDOS_TCP</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND srcDestTCPFlags = 2 AND ipProto = 6</singleConstraint>
                </eventFilters>
                <name>TCP DDOS Attack</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974230</eventFilters>
                <incidentAttrs>
        destIpAddr = DDOS_TCP.destIpAddr, destIpPort = DDOS_TCP.destIpPort, incidentCount = DDOS_TCP.COUNT (DISTINCT srcIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_TCP_DDOS_ATTACK</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_8" entityVersion="1" xmlId="Rule$PH_Rule_Flow_8" ownerId="500150" lastModified="1350152345584" id="974311" custId="0" creationTime="1350152345584">
                <activatedTime>1350152345584</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive denies from the same source to many distinct destinations on the same port in a short period of time. The intent could be malicious or some sort of misconfiguration.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974231" ownerId="500150" lastModified="1350152345584" id="974231" custId="0" creationTime="1350152345584">
                    <groupBy>srcIpAddr, destIpPort</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>ExcessDenySameSrc</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DenyTraffic)</singleConstraint>
                </eventFilters>
                <name>Excessive Denied Connections From Same Src</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974231</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessDenySameSrc.srcIpAddr, destIpPort = ExcessDenySameSrc.destIpPort, incidentCount = ExcessDenySameSrc.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_DENY_SRC</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_9" entityVersion="1" xmlId="Rule$PH_Rule_Flow_9" ownerId="500150" lastModified="1350152345654" id="974312" custId="0" creationTime="1350152345654">
                <activatedTime>1350152345654</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects excessive denies from many distinct sources to the same destination on the same destination port</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974232" ownerId="500150" lastModified="1350152345654" id="974232" custId="0" creationTime="1350152345654">
                    <groupBy>destIpAddr, destIpPort</groupBy>
                    <groupConstraint>COUNT (DISTINCT srcIpAddr) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>ExcessDenySameDest</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DenyTraffic)</singleConstraint>
                </eventFilters>
                <name>Excessive Denied Connections To Same Destination</name>
                <triggerWindow>180</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974232</eventFilters>
                <incidentAttrs>
        destIpAddr = ExcessDenySameDest.destIpAddr, destIpPort = ExcessDenySameDest.destIpPort, incidentCount = ExcessDenySameDest.COUNT (DISTINCT srcIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_DENY_DEST</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_10" entityVersion="1" xmlId="Rule$PH_Rule_Flow_10" ownerId="500150" lastModified="1350152345726" id="974313" custId="0" creationTime="1350152345726">
                <activatedTime>1350152345726</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects large (&gt; 200 bytes/pkt) ICMP echo request and response packets - this is unusual since ICMP packets carry minimal information and are small in size. THis may indicate that some other traffic is being carried over ICMP protocol.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974233" ownerId="500150" lastModified="1350152345726" id="974233" custId="0" creationTime="1350152345726">
                    <groupBy>srcIpAddr, destIpAddr</groupBy>
                    <groupConstraint>SUM(sentPkts) &gt; 0 AND SUM(sentBytes)/SUM(sentPkts) &gt;= 200</groupConstraint>
                    <index>0</index>
                    <name>LargeICMPEchoReq</name>
                    <singleConstraint>eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic) AND ipProto = 1 AND icmpType = 8</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974234" ownerId="500150" lastModified="1350152345726" id="974234" custId="0" creationTime="1350152345726">
                    <groupBy>srcIpAddr, destIpAddr</groupBy>
                    <groupConstraint>SUM(sentPkts) &gt; 0 AND SUM(sentBytes)/SUM(sentPkts) &gt;= 200</groupConstraint>
                    <index>1</index>
                    <name>LargeICMPEchoResp</name>
                    <singleConstraint>eventType IN ("IOS-NETFLOW-BI", Group@PH_SYS_EVENT_PermitTraffic)  AND ipProto = 1 AND icmpType = 0</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>AND</type>
                </filterOperators>
                <globalConstraint>LargeICMPEchoReq.srcIpAddr = LargeICMPEchoResp.destIpAddr, LargeICMPEchoReq.destIpAddr = LargeICMPEchoResp.srcIpAddr </globalConstraint>
                <name>Unusually Large ICMP Echo Packets</name>
                <rawFOString>AND:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974233</eventFilters>
                <eventFilters>EventFilter@974234</eventFilters>
                <incidentAttrs>
        srcIpAddr = LargeICMPEchoReq.srcIpAddr, destIpAddr = LargeICMPEchoReq.destIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_LARGE_ICMP_ECHO</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,icmpType,icmpCode,sentPkts,recvPkts,sentBytes,recvBytes,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_11" entityVersion="1" xmlId="Rule$PH_Rule_Flow_11" ownerId="500150" lastModified="1350152345797" id="974314" custId="0" creationTime="1350152345797">
                <activatedTime>1350152345797</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a scenario where a host, that is itself not an authorized mail gateway, is unsuccessfully trying to send excessive emails to unauthorized mail gateways. Authorized mail gateways are represented by the "Mail Gateway" group. Such requests would be typically denied because, either the firewall would block SMTP from end hosts and/or mail gateways only receive mail from other authorized mail gateways. This behavior may indicate malware running on an end host that is trying to send spam or privileged information to its own set of mail servers (which may be compromised).</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974235" ownerId="500150" lastModified="1350152345797" id="974235" custId="0" creationTime="1350152345797">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>EndUserMailToUnauthMailGw</name>
                    <singleConstraint>destIpPort = 25 AND destIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW, Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974236" ownerId="500150" lastModified="1350152345797" id="974236" custId="0" creationTime="1350152345797">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 30</groupConstraint>
                    <index>1</index>
                    <name>ExcessDeniedMail</name>
                    <singleConstraint>eventType IN (Group@PH_SYS_EVENT_DenyTraffic) AND destIpPort = 25 AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974237" ownerId="500150" lastModified="1350152345797" id="974237" custId="0" creationTime="1350152345797">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 30</groupConstraint>
                    <index>2</index>
                    <name>ExcessPermitMail</name>
                    <singleConstraint>eventType = "IOS-NETFLOW-BI" AND srcDestTCPFlags = 2 AND ipProto = 6 AND destIpPort = 25 AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>1</rank>
                    <type>AND</type>
                </filterOperators>
                <filterOperators>
                    <rank>0</rank>
                    <type>OR</type>
                </filterOperators>
                <globalConstraint> EndUserMailToUnauthMailGw.srcIpAddr = ExcessDeniedMail.srcIpAddr AND ExcessDeniedMail.srcIpAddr = ExcessPermitMail.srcIpAddr</globalConstraint>
                <name>Excessive Denied End User Mail To Unauthorized Mail Gateways</name>
                <rawFOString>AND:1,OR:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974235</eventFilters>
                <eventFilters>EventFilter@974236</eventFilters>
                <eventFilters>EventFilter@974237</eventFilters>
                <incidentAttrs>
        srcIpAddr = EndUserMailToUnauthMailGw.srcIpAddr
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_DENY_MAIL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Network" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_12" entityVersion="1" xmlId="Rule$PH_Rule_Flow_12" ownerId="500150" lastModified="1350152345869" id="974315" custId="0" creationTime="1350152345869">
                <activatedTime>1350152345869</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a scenario where a host, that is itself not a DNS server, is trying to send DNS requests to unauthorized DNS servers. Authorized DNS servers are represented by the "DNS Server" group. In a typical scenario, end hosts always send DNS requests to authrozed DNS servers which in turn communicate to other DNS servers - so this behavior may indicate malware running on the end host.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974238" ownerId="500150" lastModified="1350152345869" id="974238" custId="0" creationTime="1350152345869">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destIpAddr) &gt;= 10</groupConstraint>
                    <index>0</index>
                    <name>UnauthDNS</name>
                    <singleConstraint>destIpPort = 53 AND destIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER,Group@PH_SYS_APP_ACCELOPS) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <name>End User DNS Queries to Unauthorized DNS Servers</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974238</eventFilters>
                <incidentAttrs>
        srcIpAddr = UnauthDNS.srcIpAddr, incidentCount = UnauthDNS.COUNT (DISTINCT destIpAddr)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_UNAUTH_DNS_QUERY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_13" entityVersion="1" xmlId="Rule$PH_Rule_Flow_13" ownerId="500150" lastModified="1350152345941" id="974316" custId="0" creationTime="1350152345940">
                <activatedTime>1350152345941</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a scenario where a host, that is itself not an DNS server, is sending excessive DNS requests. Authorized DNS servers are represented by the "DNS Server" group. In a typical scenario, the frequency of end host DNS requests is not high unless, there is a script running - this might indicate the presence of malware on the end host.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974239" ownerId="500150" lastModified="1350152345941" id="974239" custId="0" creationTime="1350152345941">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 500</groupConstraint>
                    <index>0</index>
                    <name>ExcessiveDNSFromFlow</name>
                    <singleConstraint>destIpPort = 53 AND srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND reptDevIpAddr IN (Group@PH_SYS_DEVICE_FIREWALL,Group@PH_SYS_DEVICE_ROUTER_SWITCH) AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <eventFilters entityVersion="0" xmlId="EventFilter@974240" ownerId="500150" lastModified="1350152345941" id="974240" custId="0" creationTime="1350152345941">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destName) &gt;= 200</groupConstraint>
                    <index>1</index>
                    <name>ExcessiveDNSFromServer</name>
                    <singleConstraint>srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND reptDevIpAddr IN (Group@PH_SYS_APP_DNS_SERVER) AND (eventType CONTAIN "BIND_DNS" OR eventType CONTAIN "MS_DNS") AND srcIpAddr NOT IN (Group@PH_SYS_APP_ACCELOPS) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <filterOperators>
                    <rank>0</rank>
                    <type>OR</type>
                </filterOperators>
                <globalConstraint>ExcessiveDNSFromFlow.srcIpAddr = ExcessiveDNSFromServer.srcIpAddr</globalConstraint>
                <name>Excessive End User DNS Queries</name>
                <rawFOString>OR:0</rawFOString>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974239</eventFilters>
                <eventFilters>EventFilter@974240</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessiveDNSFromFlow.srcIpAddr, srcIpAddr = ExcessiveDNSFromServer.srcIpAddr, incidentCount = ExcessiveDNSFromFlow.COUNT(*), incidentCount = ExcessiveDNSFromServer.COUNT(DISTINCT destName)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_DNS_QUERY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,destName,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_14" entityVersion="1" xmlId="Rule$PH_Rule_Flow_14" ownerId="500150" lastModified="1350152346014" id="974317" custId="0" creationTime="1350152346014">
                <activatedTime>1350152346014</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a scenario where a host, has a very high frequency of denied DNS traffic.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974241" ownerId="500150" lastModified="1350152346014" id="974241" custId="0" creationTime="1350152346014">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>DeniedDNS</name>
                    <singleConstraint>destIpPort = 53 AND eventType IN (Group@PH_SYS_EVENT_DenyTraffic)</singleConstraint>
                </eventFilters>
                <name>Excessive Denied DNS Queries</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974241</eventFilters>
                <incidentAttrs>
        srcIpAddr = DeniedDNS.srcIpAddr, incidentCount = DeniedDNS.COUNT (*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_DENY_DNS_QUERY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_15" entityVersion="1" xmlId="Rule$PH_Rule_Flow_15" ownerId="500150" lastModified="1350152346086" id="974318" custId="0" creationTime="1350152346085">
                <activatedTime>1350152346085</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects bad domain name queries which indicate malware infected end hosts.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974242" ownerId="500150" lastModified="1350152346085" id="974242" custId="0" creationTime="1350152346085">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT destName) &gt;= 5</groupConstraint>
                    <index>0</index>
                    <name>MalwareDNS</name>
                    <singleConstraint>eventType IN ("BIND_DNS_A_Query","MS_DNS_A_Query","MS_DNS_A_Success","MS_DNS_A_Fail") AND destName IN (Group@PH_SYS_ROOT_MalwareSite)</singleConstraint>
                </eventFilters>
                <name>Excessive Malware Domain Name Queries</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974242</eventFilters>
                <incidentAttrs>
        srcIpAddr = MalwareDNS.srcIpAddr, incidentCount =  MalwareDNS.COUNT(DISTINCT destName)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_BAD_DOMAIN_DNS_QUERY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destName,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_16" entityVersion="1" xmlId="Rule$PH_Rule_Flow_16" ownerId="500150" lastModified="1350152346158" id="974319" custId="0" creationTime="1350152346158">
                <activatedTime>1350152346158</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects an end host meeting at least 3 requirements for suspicious use of DNS requests - this indicates that a bot is likely running on the end host</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974243" ownerId="500150" lastModified="1350152346158" id="974243" custId="0" creationTime="1350152346158">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT (DISTINCT eventType) &gt;= 3</groupConstraint>
                    <index>0</index>
                    <name>BotnetSymptom</name>
                    <singleConstraint>eventType IN ("PH_RULE_UNAUTH_DNS_QUERY","PH_RULE_EXCESS_DNS_QUERY","PH_RULE_EXCESS_DENY_DNS_QUERY","PH_RULE_BAD_DOMAIN_DNS_QUERY", "PH_RULE_UNCOMMON_DNS_QUERY")</singleConstraint>
                </eventFilters>
                <name>Suspicious Botnet like End host DNS Behavior</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974243</eventFilters>
                <incidentAttrs>
        srcIpAddr = BotnetSymptom.srcIpAddr 
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_BOTNET_LIKELY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_17" entityVersion="1" xmlId="Rule$PH_Rule_Flow_17" ownerId="500150" lastModified="1350152346230" id="974320" custId="0" creationTime="1350152346230">
                <activatedTime>1350152346230</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects the same host that is not a DNS server, doing an excessive amount of uncommon domain name queries - this indicates the host is likely infected with malware. An end host typically needs to perform only A and PTR queries; any other query inidicates the likely presence of malware.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974244" ownerId="500150" lastModified="1350152346230" id="974244" custId="0" creationTime="1350152346230">
                    <groupBy>srcIpAddr,eventType</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 50</groupConstraint>
                    <index>0</index>
                    <name>UncommonDNS</name>
                    <singleConstraint>srcIpAddr NOT IN (Group@PH_SYS_APP_DNS_SERVER) AND eventType NOT IN ("BIND_DNS_A_Query", "BIND_DNS_PTR_Query", "MS_DNS_A_Query","MS_DNS_PTR_Query", "MS_DNS_A_Success", "MS_DNS_A_Fail", "MS_DNS_PTR_Success", "MS_DNS_PTR_Success", "MS_DNS_PTR_Fail") AND (eventType CONTAIN "BIND_DNS" OR eventType CONTAIN "MS_DNS")</singleConstraint>
                </eventFilters>
                <name>Excessive Uncommon DNS Queries</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974244</eventFilters>
                <incidentAttrs>
        srcIpAddr = UncommonDNS.srcIpAddr, incidentCount =UncommonDNS.COUNT (*)   
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_UNCOMMON_DNS_QUERY</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destName,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_18" entityVersion="1" xmlId="Rule$PH_Rule_Flow_18" ownerId="500150" lastModified="1350152346302" id="974321" custId="0" creationTime="1350152346302">
                <activatedTime>1350152346302</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects an usually high frequency of DNS name resolution queries from the same host to the same domain name in a short period of time. This is not expected behavior since, in a typical scenario, the domain name resolution is cached at the end point. Repeated queries indicates that a special DNS client is likely running at the end host that is trying to make use of fast flux techniques to get back many infected hosts behind a crafted domain name.</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974245" ownerId="500150" lastModified="1350152346302" id="974245" custId="0" creationTime="1350152346302">
                    <groupBy>srcIpAddr, destName</groupBy>
                    <groupConstraint>COUNT (*) &gt;= 100</groupConstraint>
                    <index>0</index>
                    <name>ExcessRepeatDNS</name>
                    <singleConstraint>eventType IN ("BIND_DNS_A_Query","MS_DNS_A_Query","MS_DNS_A_Success","MS_DNS_A_Fail")</singleConstraint>
                </eventFilters>
                <name>Excessive Repeated DNS Queries To Same Domain</name>
                <triggerWindow>300</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974245</eventFilters>
                <incidentAttrs>
        srcIpAddr = ExcessRepeatDNS.srcIpAddr, destName =ExcessRepeatDNS.destName, incidentCount = ExcessRepeatDNS.COUNT (*)   
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_DNS_QUERY_SAME_DOMAIN</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destName,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
            <rule phIncidentCategory="Application" dataCreationType="SYSTEM" dataChangeType="SYSTEM" naturalId="PH_Rule_Flow_19" entityVersion="1" xmlId="Rule$PH_Rule_Flow_19" ownerId="500150" lastModified="1350152346374" id="974322" custId="0" creationTime="1350152346373">
                <activatedTime>1350152346373</activatedTime>
                <active>true</active>
                <custInclusive>true</custInclusive>
                <description>Detects a scenario where a host, that is itself not an authorized mail gateway, is sending excessive emails (more than 20 emails in 2 minutes). This behavior may indicate malware running on an end host that is trying to send spam or privileged information to its own set of mail servers (which may be compromised).</description>
                <eventFilters entityVersion="0" xmlId="EventFilter@974246" ownerId="500150" lastModified="1350152346373" id="974246" custId="0" creationTime="1350152346373">
                    <groupBy>srcIpAddr</groupBy>
                    <groupConstraint>COUNT(*) &gt;= 20</groupConstraint>
                    <index>0</index>
                    <name>EndUserExcessMail</name>
                    <singleConstraint>destIpPort = 25 AND srcIpAddr NOT IN (Group@PH_SYS_DEVICE_SEC_GW,Group@PH_SYS_APP_MAIL_SERVER) AND srcIpAddr IN (Group@PH_SYS_NETWORK_ENTERPRISE_INTERNAL_NET)</singleConstraint>
                </eventFilters>
                <name>Excessive End User Mail</name>
                <triggerWindow>120</triggerWindow>
                <advanced>true</advanced>
                <eventFilters>EventFilter@974246</eventFilters>
                <incidentAttrs>
        srcIpAddr = EndUserExcessMail.srcIpAddr,incidentCount = EndUserExcessMail.COUNT(*)
      </incidentAttrs>
                <incidentFireFreq>86400</incidentFireFreq>
                <incidentFired>false</incidentFired>
                <incidentType>EventType$PH_RULE_EXCESS_END_USER_MAIL</incidentType>
                <triggerEventAttrList> phRecvTime,eventType,srcIpAddr,destIpAddr,ipProto,srcIpPort,destIpPort,srcDestTCPFlags,reptDevIpAddr,rawEventMsg </triggerEventAttrList>
            </rule>
        </rules>
    </result>
</response>
